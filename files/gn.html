<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>gn</title>

    <!-- Add Material Icons stylesheet -->
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />

    <!-- <link rel="icon" type="image/x-icon" href="/favicon.ico" /> -->
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <!-- React and Material-UI CDN links -->
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@mui/material@5.14.11/umd/material-ui.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/react-swipeable-views@0.14.0/dist/index.umd.js"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <!-- Add Leaflet CSS -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css"
    />

    <!-- Add Moment.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>


    <!-- <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> -->

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>

    <style>
      body {
        font-family: "Roboto", sans-serif;
        padding: 2px;
        margin: 2px;
        /* background-color: #f5f5f5; */
        background-color: #fff;

        overflow-x: hidden;
      }

      .container {
        max-width: 100%; /* Ensure the container does not exceed the viewport width */
      }
      .carousel {
        position: relative;
        height: 300px;
        overflow: hidden;
        background-color: #fff;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      .ad-content {
        position: absolute;
        bottom: 20px;
        left: 20px;
        color: white;
      }

      /* Common styles for all notifications */
      .notification {
        margin: 10px 0;
        padding: 15px;
        font-size: 16px;
        border-radius: 5px;
        display: flex;
        align-items: left;
        justify-content: left;
        font-family: Arial, sans-serif;
      }
      .notification:hover {
        margin: 11px 0;
        padding: 15px;
        font-size: 16px;
        border-radius: 6px;
        color: Gold;
        background-color: #03a9f4; /* Light background on hover */
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); /* Subtle shadow effect */
        transition: background-color 0.3s ease, box-shadow 0.3s ease; /* Smooth transition */
      }

      /* Success notification */
      .success {
        background-color: #4caf50;
        color: white;
      }

      .success .icon {
        margin-right: 10px;
      }

      /* Error notification */
      .error {
        background-color: #f44336;
        color: white;
      }

      .error .icon {
        margin-right: 10px;
      }

      /* Warning notification */
      .warning {
        background-color: #ff9800;
        color: white;
      }

      .warning .icon {
        margin-right: 10px;
      }

      /* General notification */
      .general {
        background-color: #03a9f4;
        color: white;
      }

      .general .icon {
        margin-right: 10px;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect } = React;
      const {
        AppBar,
        Box,
        Button,
        Card,
        CardContent,
        CardMedia,
        Container,
        Grid,
        IconButton,
        Menu,
        MenuItem,
        Paper,
        Toolbar,
        Typography,
        useTheme,
        ThemeProvider,
        createTheme,
        MobileStepper,
        Dialog,
        DialogTitle,
        DialogContent,
        DialogActions,
        Table,
        TableBody,
        TableCell,
        TableHead,
        TableRow,
        Chip,
        Tabs,
        Tab,
        TextField,
        TableContainer,
        FormControl,
        InputLabel,
        Select,
        Stepper,
        Step,
        StepLabel,
        FormHelperText,
        Autocomplete,
        Avatar,
        Drawer,
        List,
        Link,
        Stack,
        Slider,
        ListItem,
        ListItemIcon,
        ListItemText,
        Divider,
        Tooltip,
        Breadcrumbs,
      } = MaterialUI;

      // const { PieChart } = window["@mui/x-charts"];

      const themes = {
        orange: {
          name: "orange",
          appBarColor: "orange",
          drawerColor: "orange",
          textColor: "orange",
        },
        light: {
          name: "light",
          appBarColor: "#3f51b5",
          drawerColor: "#3f51b5",
          textColor: "#000",
        },
        dark: {
          name: "dark",
          appBarColor: "#000",
          drawerColor: "#333",
          textColor: "#000",
        },
        blue: {
          name: "blue",
          // appBarColor: "#2196f3",
          appBarColor: "#03a9f4",
          drawerColor: "#03a9f4",
          textColor: "#000",
          // textColor: "blue",
        },
        green: {
          name: "green",
          // appBarColor: "#4caf50",
          appBarColor: "green",
          drawerColor: "green",
          // textColor: "#000",
          textColor: "green",
        },
        red: {
          name: "red",
          appBarColor: "red",
          drawerColor: "red",
          textColor: "red",
        },
      };

      // Achievements Section
      const achievements = [
        {
          title: "Founder",
          date: "July 2019",
          description: "Pitta. Rajaiah",
          icon: "stars",
        },
        {
          title: "Co - Founder",
          date: "July 2019",
          description: "Dhanraj Kalluri",
          icon: "sports_score",
        },
        {
          title: "SLV Tech Solutions",
          date: "August 2023",
          description: "Steping into Successful route",
          icon: "emoji_events",
        },
        {
          title: "Skill Development",
          date: "May 2022",
          description:
            "Conducting Programs to bring financial awaireness in Public",
          icon: "school",
        },

        {
          title: "View More Achievements",
          date: "",
          description: "Click to see all our achievements and accolades",
          icon: "add_circle",
          isViewMore: true,
        },
      ];

      const allLoans = [
        {
          loanId: "GNL01297",
          fullName: "Raju", // as per PAN or aadhar
          careOf: "ramulu",
          address: "kazipet hanamkonda",
          mobile: "kyk",
          email: "kdgkj",
          pincode: "506122",
          maritalStatus: "married",
          gender: "male",
          customerLanguage: "english",

          loanRequiredAmonut: 150000,
          activeMonthlyEmisOfCustomer: 10000,
          applyDate: "2025-01-25T15:30:00",

          userId: "GNC123",
          branchCode: "GNB015",
          refferedBY: "GNS0142",
          approvedBy: "GNM0378",
          verified: true,
          disbursed: false,
          elegibilityAmount: 200000,
          rateOfInterest: 11.25,
          status: "Completed",
          notes: "NA",
          bankAccountNumber: "",
          ifscCode: "",
          work: {
            typeOfEmployment: "private",
            companyName: "",
            companyAddress: "",
            companyPincode: "",
            monthlySalary: 50000,
            modeOfSalary: "Bank",
            totalExperienceInMOnths: 48,
          },
          docs: {
            aadhar: "",
            pan: "",
            cBill: "",
            paySlips: "",
            bankStatements: "",
            other: "",
            photo: "",
            sign: "",
          },

          loanDetails: {
            startDate: "2025-01-25T15:30:00",
            endDate: "",
            amount: 100000,
            rateOfInterest: 11.25,
            emis: 18,
            completed: false,
          },
          payDetails: [
            {
              month: "2025-01-10",
              emi: "6500",
              paid: true,
            },
            {
              month: "2025-02-10",
              emi: "6500",
              paid: true,
            },
            {
              month: "2025-03-10",
              emi: "6500",
              paid: false,
            },
            {
              month: "2025-04-10",
              emi: "6500",
              paid: false,
            },
            {
              month: "2025-04-10",
              emi: "6500",
              paid: false,
            },
          ],
        },
        {
          loanId: "GNL01297",
          fullName: "Raju2", // as per PAN or aadhar
          careOf: "ramulu",
          address: "kazipet hanamkonda",
          pincode: "506122",
          maritalStatus: "married",
          gender: "male",
          customerLanguage: "english",

          loanRequiredAmonut: 150000,
          activeMonthlyEmisOfCustomer: 10000,
          applyDate: "2025-01-25T15:30:00",

          userId: "GNC123",
          branchCode: "GNB015",
          refferedBY: "GNS0142",
          approvedBy: "GNM0378",
          verified: true,
          disbursed: false,
          elegibilityAmount: 200000,
          rateOfInterest: 11.25,
          status: "verification",
          notes: "NA",
          bankAccountNumber: "",
          ifscCode: "",
          work: {
            typeOfEmployment: "private",
            companyName: "",
            companyAddress: "",
            companyPincode: "",
            monthlySalary: 50000,
            modeOfSalary: "Bank",
            totalExperienceInMOnths: 48,
          },
          docs: {
            aadhar: "",
            pan: "",
            cBill: "",
            paySlips: "",
            bankStatements: "",
            other: "",
            photo: "",
            sign: "",
          },

          loanDetails: {
            startDate: "2025-01-25T15:30:00",
            endDate: "",
            amount: 100000,
            rateOfInterest: 11.25,
            emis: 18,
            completed: false,
          },
          payDetails: [
            {
              month: "2025-01-10",
              emi: "6500",
              paid: true,
            },
            {
              month: "2025-02-10",
              emi: "6500",
              paid: true,
            },
            {
              month: "2025-03-10",
              emi: "6500",
              paid: false,
            },
            {
              month: "2025-04-10",
              emi: "6500",
              paid: false,
            },
            {
              month: "2025-04-10",
              emi: "6500",
              paid: false,
            },
          ],
        },
        {
          loanId: "GNL01297",
          fullName: "Raju3", // as per PAN or aadhar
          careOf: "ramulu",
          address: "kazipet hanamkonda",
          pincode: "506122",
          maritalStatus: "married",
          gender: "male",
          customerLanguage: "english",

          loanRequiredAmonut: 150000,
          activeMonthlyEmisOfCustomer: 10000,
          applyDate: "2025-01-25T15:30:00",

          userId: "GNC123",
          branchCode: "GNB015",
          refferedBY: "GNS0142",
          approvedBy: "GNM0378",
          verified: true,
          disbursed: false,
          elegibilityAmount: 200000,
          rateOfInterest: 11.25,
          status: "verification",
          notes: "NA",
          bankAccountNumber: "",
          ifscCode: "",
          work: {
            typeOfEmployment: "private",
            companyName: "",
            companyAddress: "",
            companyPincode: "",
            monthlySalary: 50000,
            modeOfSalary: "Bank",
            totalExperienceInMOnths: 48,
          },
          docs: {
            aadhar: "",
            pan: "",
            cBill: "",
            paySlips: "",
            bankStatements: "",
            other: "",
            photo: "",
            sign: "",
          },

          loanDetails: {
            startDate: "2025-01-25T15:30:00",
            endDate: "",
            amount: 100000,
            rateOfInterest: 11.25,
            emis: 18,
            completed: false,
          },
          payDetails: [
            {
              month: "2025-01-10",
              emi: "6500",
              paid: true,
            },
            {
              month: "2025-02-10",
              emi: "6500",
              paid: true,
            },
            {
              month: "2025-03-10",
              emi: "6500",
              paid: false,
            },
            {
              month: "2025-04-10",
              emi: "6500",
              paid: false,
            },
            {
              month: "2025-04-10",
              emi: "6500",
              paid: false,
            },
          ],
        },
      ];
      const customers = [
        {
          fullName: "Raju",
          id: "GNC01",
          role: "customer",
          mobile: "9176610001",
          email: "sakinala.rajugnc01@gnc.com",
          otp: "123456",
          loginExpiration: "",
          password: "123456789",
          address: "",

          theme: "",
          active: true,
          joinDate: "",
          branchCode: "GNB01",
          refferedBY: "GNS00124",
          gender: "Male",
          careOf: "",
        },
        {
          fullName: "Raju2",
          id: "GNC02",
          role: "customer",
          mobile: "9176610002",
          email: "sakinala.rajugnc02@gna.com",
          otp: "123456",
          loginExpiration: "",
          password: "123456789",
          address: "",
          gender: "Male",

          theme: "",
          active: true,
          joinDate: "",
          branchCode: "GNB01",
          refferedBY: "GNS00124",

          careOf: "",
        },
      ];
      const users = [
        {
          fullName: "Raju",
          id: "GNS01",
          role: "Sales",
          mobile: "9676610001",
          email: "sakinala.raju01@gns.com",
          otp: "123456",
          loginExpiration: "",
          password: "123456789",
          address: "",
          roleId: 0,
          theme: "",
          active: true,
          joinDate: "",
          branchCode: "GNB01",
          gender: "Male",
          careOf: "",
        },
        {
          fullName: "Ram",
          id: "GNS02",
          role: "Sales",
          mobile: "9676610002",
          email: "ram02@gns.com",
          otp: "123456",
          loginExpiration: "",
          password: "123456789",
          address: "",
          roleId: 0,
          theme: "",
          active: true,
          joinDate: "",
          branchCode: "GNB01",
          gender: "Male",
          careOf: "",
        },
        {
          fullName: "shyam",
          id: "GNS03",
          role: "sales",
          mobile: "9676610003",
          email: "shyam03@gns.com",
          otp: "123456",
          loginExpiration: "",
          password: "123456789",
          address: "",
          roleId: 0,
          theme: "",
          active: true,
          joinDate: "",
          branchCode: "GNB01",
          gender: "Male",
          careOf: "",
        },
        {
          fullName: "Arjun",
          id: "GNA01",
          role: "admin",
          mobile: "9676610004",
          email: "arjun01@gna.com",
          otp: "123456",
          loginExpiration: "",
          password: "123456789",
          address: "",
          roleId: 0,
          theme: "",
          active: true,
          joinDate: "",
          branchCode: "GNB01",
          gender: "Male",
          careOf: "",
        },
        {
          fullName: "Chendu",
          id: "GNS04",
          role: "Sales",
          mobile: "9676610005",
          email: "chendu04@gns.com",
          otp: "123456",
          loginExpiration: "",
          password: "123456789",
          address: "",
          roleId: 0,
          theme: "",
          active: true,
          joinDate: "",
          branchCode: "GNB01",
          gender: "Male",
          careOf: "",
        },
        {
          fullName: "Abhishek",
          id: "GNA02",
          role: "admin",
          mobile: "9676610006",
          email: "abhishek01@gna.com",
          otp: "123456",
          loginExpiration: "",
          password: "123456789",
          address: "",
          roleId: 0,
          theme: "",
          active: true,
          joinDate: "",
          branchCode: "GNB01",
          gender: "Male",
          careOf: "",
        },
        {
          fullName: "Sridhar",
          id: "GNS05",
          role: "Sales",
          mobile: "9676610007",
          email: "sakinala.raju05@gns.com",
          otp: "123456",
          loginExpiration: "",
          password: "123456789",
          address: "",
          roleId: 0,
          theme: "",
          active: true,
          joinDate: "",
          branchCode: "GNB01",
          gender: "Male",
          careOf: "",
        },
      ];

      const roles = ["admin", "cluster", "manager", "sales", "partner"];

      // let baseURL = "http://localhost:1954";
      let baseURL = "https://zphs-school.vercel.app";

      const Management = () => {
        const [checked, setChecked] = useState(false);
        const [submitted, setSubmitted] = useState(true);
        const [familyMembers, setFamilyMembers] = useState(0);
        const [listData, setListData] = useState([]);
        const [showList, setShowList] = useState(true);
        const [loading, setLoading] = useState(false);
        const [selectedStudent, setSelectedStudent] = React.useState(null);
        // const [newUserModal, setNewUserModal] = React.useState(false);
        const [openStudentDetailsModal, setOpenStudentDetailsModal] =
          React.useState(false);

        const [user, setUser] = useState({
          fullName: "",
          gender: "",
          father: "",
          email: "",
          phone: "",
          profession: "",
          branch: "",
          role: "",
        });

        const [errors, setErrors] = useState({});

        const validateField = (name, value) => {
          const newErrors = { ...errors };

          switch (name) {
            case "userId":
              if (!value) newErrors.userId = "user ID is required.";
              else delete newErrors.userId;
              break;

            case "fullName":
              if (!value) newErrors.fullName = "Name is required.";
              else delete newErrors.fullName;
              break;
            case "email":
              if (!value) {
                newErrors.email = "Email is required.";
              } else if (!/\S+@\S+\.\S+/.test(value)) {
                newErrors.email = "Email is invalid.";
              } else {
                delete newErrors.email;
              }
              break;

            default:
              break;
          }

          setErrors(newErrors);
        };

        const handleChange = (event) => {
          const { name, value } = event.target;
          setUser({
            ...user,
            [name]: value,
          });

          validateField(name, value); // validate each field on change
        };

        const handleSubmit = (event) => {
          event.preventDefault();
          console.log("user", user);
          console.log("errors", errors);
          try {
            if (
              Object.keys(errors).length === 0
              // &&
              // Object.values(user).every((val) => val !== "")
            ) {
              axios
                .post(`${baseURL}/add-new-gn-user`, {
                  fullName: user.fullName,
                  userId: "GNC" + user.phone,
                  role: user.role,
                  mobile: user.phone,
                  email: user.email,
                  otp: "123456",
                  loginExpiration: "",
                  password: user.password,
                  address: user.address,
                  roleId: 0,
                  theme: "",
                  active: true,
                  joinDate: "",
                  branchCode: user?.branchCode,
                  gender: user.gender,
                  careOf: user.father,
                })

                .then((res) => {
                  // alert(res.data.message);
                  if (res.data.message != "Same details enrolled") {
                    setShowList(true);
                    fetchListDate();
                  }
                })
                .catch((error) => {
                  // setShowList(true);
                  // setShowList(false);
                  // alert("catch", error);
                  alert(error.message);
                  console.log("Error occurred:", error);
                });

              setShowList(true);
            } else {
              alert("some fileds missing");
            }
          } catch (err) {
            console.log("err", err);
          }
          // Final validation before submission
        };

        const [branches, setBranches] = useState([]);

        const fetchBranches = () => {
          fetch(`${baseURL}/get-all-branches`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            credentials: "include",
            body: JSON.stringify({}),
          })
            .then((response) => response.json()) // Parse the JSON
            .then((data) => {
              setBranches(data);
            })
            .catch((error) => {
              console.error("Error loading JSON:", error);
              setBranches([]);
            });
        };

        useEffect(() => {
          setLoading(true);
          try {
            fetch(`${baseURL}/get-gn-users`, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              credentials: "include",
              body: JSON.stringify({}),
            })
              .then((response) => response.json()) // Parse the JSON
              .then((data) => {
                setListData(data.data);
                setLoading(false);
              })
              .catch((error) => {
                console.error("Error loading JSON:", error);
                setLoading(false);
              });
          } catch (er) {
            setLoading(false);
            console.log("er", er);
            alert("catch");
          }
        }, []);
        const fetchListDate = () => {
          try {
            fetch(`${baseURL}/get-gn-users`, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              credentials: "include",
              body: JSON.stringify({}),
            })
              .then((response) => response.json()) // Parse the JSON
              .then((data) => {
                setListData(data.data);
                setLoading(false);
              })
              .catch((error) => {
                console.error("Error loading JSON:", error);
                setLoading(false);
              });
          } catch (er) {
            console.log("er", er);
            alert("catch");
          }
        };

        const [searchFilter, setSearchFilter] = React.useState("");

        const [roleFilter, setRoleFilter] = React.useState("");

        const getFilteredlist = () => {
          console.log("listData", listData);
          return listData.filter((user) => {
            return (
              user?.role.toLowerCase().includes(roleFilter.toLowerCase()) &&
              user?.fullName.toLowerCase().includes(searchFilter.toLowerCase())
            );
          });
        };

        const clearStudentFilters = () => {
          setSearchFilter("");
          setRoleFilter("");
        };

        return (
          <div
            style={{
              overflowX: "scroll",
            }}
          >
            {loading ? (
              <div className="loader-container">
                <div className="loader"></div>
              </div>
            ) : showList ? (
              <div className="form-container">
                <Box sx={{ p: 0, m: 0, width: "100%" }} className="box">
                  <Box
                    sx={{
                      display: "flex",
                      justifyContent: "space-between",
                      alignItems: "center",
                      // mb: 3,
                    }}
                  >
                    <Typography
                      variant="h5"
                      gutterBottom
                      sx={{ fontWeight: "bold", fontSize: "1.25rem" }} // Reduced font size
                    >
                      Users
                    </Typography>
                  </Box>
                  <Box
                    sx={{
                      display: "flex",
                      justifyContent: "space-between",
                      alignItems: "center",
                      // mb: 3,
                    }}
                  >
                    <Typography
                      variant="h5"
                      gutterBottom
                      sx={{ fontWeight: "bold", fontSize: "1rem" }} // Reduced font size
                    >
                      filtered :{" "}
                      {getFilteredlist().reduce((acc, el) => acc + 1, 0)} /{" "}
                      {getFilteredlist().length}
                    </Typography>
                    <Button
                      onClick={() => {
                        alert("Contact administrator");
                        setShowList(false);
                        fetchBranches();
                      }}
                      variant="contained"
                      color="primary"
                      // href="https://zphs-school.vercel.app/enroll-form"
                      // href="https://sakinalaraju100.github.io/zphs-school/public/addStudentForm.html"
                    >
                      New User
                    </Button>
                  </Box>

                  {/* New user Button */}
                  <Box sx={{ mb: 3, textAlign: "right" }}></Box>

                  {/* Filters Section */}

                  <Box sx={{ mb: 3 }}>
                    <Box
                      sx={{
                        display: "flex",
                        flexDirection: "row",
                        gap: 2,
                        flexWrap: "wrap",
                        mb: 2,
                      }}
                    >
                      <Box sx={{ flexGrow: 1, minWidth: "200px" }}>
                        <Typography
                          variant="subtitle2"
                          gutterBottom
                          sx={{ fontSize: "0.875rem" }}
                        ></Typography>
                        <Box
                          sx={{
                            display: "flex",
                            alignItems: "center",
                            bgcolor: "grey.100",
                            borderRadius: 1,
                            px: 2,
                          }}
                        >
                          <span
                            className="material-icons"
                            sx={{ color: "grey.500" }}
                          >
                            school
                          </span>
                          <select
                            value={roleFilter}
                            onChange={(e) => {
                              // console.log("roleFilter", e.target.value);
                              setRoleFilter(e.target.value);
                              setSearchFilter("");
                              getFilteredlist();
                            }}
                            style={{
                              border: "none",
                              outline: "none",
                              padding: "8px",
                              backgroundColor: "transparent",
                              width: "100%",
                            }}
                          >
                            <option value="">All</option>
                            {roles.map((role, ri) => (
                              <option key={ri + role} value={role}>
                                {role}
                              </option>
                            ))}
                          </select>
                        </Box>
                      </Box>
                      <Box sx={{ flexGrow: 1, minWidth: "200px" }}>
                        <Typography
                          variant="subtitle2"
                          gutterBottom
                          sx={{ fontSize: "0.875rem" }}
                        ></Typography>
                        <Box
                          sx={{
                            display: "flex",
                            alignItems: "center",
                            bgcolor: "grey.100",
                            borderRadius: 1,
                            px: 2,
                          }}
                        >
                          <span
                            className="material-icons"
                            sx={{ color: "grey.500" }}
                          >
                            search
                          </span>
                          <input
                            type="text"
                            // value={searchFilter}
                            // onChange={(e) => setSearchFilter(e.target.value)}
                            value={searchFilter}
                            onChange={(e) => {
                              setSearchFilter(e.target.value);
                              getFilteredlist();
                              // if (e.target.value.length > 2) {
                              //   // setSearchFilter(e.target.value);
                              // } else {
                              //   setSearchFilter("");
                              // }
                            }}
                            placeholder="Filter by name, role, gender, mobile or branch..."
                            style={{
                              border: "none",
                              outline: "none",
                              padding: "8px",
                              backgroundColor: "transparent",
                              width: "100%",
                            }}
                          />
                          {searchFilter && (
                            <IconButton
                              onClick={() => {
                                setSearchFilter("");
                              }}
                              sx={{ ml: 1 }}
                            >
                              <span
                                className="material-icons"
                                style={{ color: "grey.500" }}
                              >
                                clear
                              </span>
                            </IconButton>
                          )}
                        </Box>
                      </Box>
                    </Box>
                  </Box>

                  <Box sx={{ width: "100%", overflowX: "auto" }}>
                    <TableContainer sx={{ minWidth: "250px" }}>
                      <Table sx={{}}>
                        <TableHead>
                          <TableRow sx={{ bgcolor: "primary.main" }}>
                            <TableCell
                              sx={{
                                color: "white",
                                fontWeight: "bold",
                                backgroundColor: "primary.main",
                                position: "sticky",
                                left: 0,
                                zIndex: 1,
                              }}
                            >
                              Code
                            </TableCell>

                            <TableCell
                              sx={{ color: "white", fontWeight: "bold" }}
                            >
                              Full Name
                            </TableCell>

                            <TableCell
                              sx={{ color: "white", fontWeight: "bold" }}
                            >
                              Role
                            </TableCell>

                            <TableCell
                              sx={{ color: "white", fontWeight: "bold" }}
                            >
                              Branch code
                            </TableCell>

                            <TableCell
                              sx={{ color: "white", fontWeight: "bold" }}
                            >
                              Mobile
                            </TableCell>
                            <TableCell
                              sx={{ color: "white", fontWeight: "bold" }}
                            >
                              email
                            </TableCell>
                            <TableCell
                              sx={{ color: "white", fontWeight: "bold" }}
                            >
                              address
                            </TableCell>
                          </TableRow>
                        </TableHead>
                        <TableBody>
                          {getFilteredlist().map((user, ind) => (
                            <TableRow
                              key={ind}
                              onClick={() => {
                                setSelectedStudent(user);
                                setOpenStudentDetailsModal(true);
                                // setChecked(user?.enrolled);
                                // setFamilyMembers(user?.familyMembers);
                              }}
                              sx={{
                                "&:nth-of-type(odd)": { bgcolor: "grey.50" },
                                "&:hover": { bgcolor: "grey.100" },
                              }}
                            >
                              <TableCell
                                sx={{
                                  color: "white",
                                  fontWeight: "bold",
                                  position: "sticky",
                                  left: 0,
                                  backgroundColor: user?.enrolled
                                    ? "lightblue"
                                    : "lightgreen",
                                  zIndex: 1,
                                }}
                              >
                                {user?.userId ?? "-"}
                              </TableCell>
                              <TableCell>{user?.fullName ?? "-"}</TableCell>
                              {/* <TableCell>{user?.father}</TableCell> */}
                              <TableCell>{user?.role ?? "-"}</TableCell>
                              <TableCell>{user?.branchCode ?? "-"}</TableCell>
                              <TableCell>{user?.mobile ?? "-"}</TableCell>
                              <TableCell>{user?.email ?? "-"}</TableCell>
                              <TableCell>{user?.address ?? "-"}</TableCell>
                            </TableRow>
                          ))}
                        </TableBody>
                      </Table>
                    </TableContainer>
                  </Box>

                  <Box sx={{ mt: 3, textAlign: "center" }}>
                    <Typography
                      variant="body2"
                      color="text.secondary"
                      sx={{ fontSize: "0.875rem" }}
                      onClick={() => {
                        setShowList(false);
                      }}
                    >
                      For any updates, please contact the administration.
                    </Typography>
                  </Box>
                </Box>
              </div>
            ) : (
              <Box
                sx={{
                  maxWidth: "500px",
                  margin: "auto",
                  padding: "20px",
                  backgroundColor: "#fff",
                  borderRadius: "8px",
                  boxShadow: 2,
                }}
              >
                <Typography variant="h5" textAlign="center" mb={2}>
                  New User Form
                </Typography>
                <form onSubmit={handleSubmit}>
                  {/* Role Selection */}
                  <FormControl fullWidth margin="normal">
                    <InputLabel>Role</InputLabel>
                    <Select
                      label="Role"
                      name="role"
                      value={user.role}
                      onChange={handleChange}
                    >
                      {roles.map((role, index) => (
                        <MenuItem key={index} value={role}>
                          {role}
                        </MenuItem>
                      ))}
                    </Select>
                    <FormHelperText error={Boolean(errors.role)}>
                      {errors.role}
                    </FormHelperText>
                  </FormControl>

                  {/* Full Name */}
                  <TextField
                    label="Full Name"
                    name="fullName"
                    value={user.fullName}
                    onChange={handleChange}
                    fullWidth
                    margin="normal"
                    error={Boolean(errors.fullName)}
                    helperText={errors.fullName}
                  />

                  {/* Care Of Person */}
                  <TextField
                    label="Care Of Person"
                    name="father"
                    value={user.father}
                    onChange={handleChange}
                    fullWidth
                    margin="normal"
                    error={Boolean(errors.father)}
                    helperText={errors.father}
                  />

                  {/* Gender Selection */}
                  <FormControl fullWidth margin="normal">
                    <InputLabel>Gender</InputLabel>
                    <Select
                      label="Gender"
                      name="gender"
                      value={user.gender}
                      onChange={handleChange}
                    >
                      <MenuItem value="Male">Male</MenuItem>
                      <MenuItem value="Female">Female</MenuItem>
                    </Select>
                  </FormControl>

                  {/* Email */}
                  <TextField
                    label="Email"
                    name="email"
                    type="email"
                    value={user.email}
                    onChange={handleChange}
                    fullWidth
                    margin="normal"
                    error={Boolean(errors.email)}
                    helperText={errors.email}
                  />

                  {/* Phone */}
                  <TextField
                    label="Phone"
                    name="phone"
                    value={user.phone}
                    onChange={handleChange}
                    fullWidth
                    margin="normal"
                    error={Boolean(errors.phone)}
                    helperText={errors.phone}
                  />

                  {/* password */}
                  <TextField
                    label="Password"
                    name="password"
                    value={user.password}
                    onChange={handleChange}
                    fullWidth
                    margin="normal"
                    error={Boolean(errors.password)}
                    helperText={errors.password}
                  />

                  {/* Branch Selection */}
                  <FormControl fullWidth margin="normal">
                    <InputLabel>Branch</InputLabel>
                    <Select
                      label="Branch"
                      name="branchCode"
                      value={user.branchCode}
                      onChange={handleChange}
                    >
                      {branches.map((branch) => (
                        <MenuItem
                          key={branch?.branchCode}
                          value={branch?.branchCode}
                        >
                          {branch?.name}
                        </MenuItem>
                      ))}
                    </Select>
                  </FormControl>

                  {/* Buttons */}
                  <Box
                    sx={{
                      display: "flex",
                      flexDirection: { xs: "column", sm: "row" },
                      gap: 2,
                      mt: 3,
                    }}
                  >
                    <Button
                      onClick={() => setShowList(true)}
                      variant="outlined"
                      color="secondary"
                      fullWidth
                    >
                      Back
                    </Button>
                    <Button
                      //  onClick={() => {}}
                      type="submit"
                      variant="contained"
                      color="primary"
                      fullWidth
                    >
                      Submit
                    </Button>
                  </Box>
                </form>
              </Box>
            )}

            {/* Modal for user Details*/}
            {selectedStudent && (
              <Dialog
                open={openStudentDetailsModal}
                onClose={() => setOpenStudentDetailsModal(false)}
                fullWidth
                maxWidth="sm"
                sx={{
                  fontSize: "6px",
                  "& .MuiDialogContent-root": {
                    padding: "16px",
                    display: "flex",
                    flexDirection: "column",
                    justifyContent: "center",
                    alignItems: "center", // Vertical centering
                  },
                  "& .MuiDialogTitle-root": {
                    backgroundColor: "#1976d2",
                    color: "white",
                  },
                }}
              >
                <Box sx={{ p: 3 }}>
                  <Box
                    sx={{
                      display: "flex",
                      justifyContent: "space-between",
                      alignItems: "center",
                      mb: 2,
                    }}
                  >
                    <Typography
                      variant="h5"
                      gutterBottom
                      sx={{
                        fontWeight: "bold",
                        textAlign: "center",
                        flex: 1,
                        fontSize: { xs: "12px", md: "15px", lg: "18px" },
                      }}
                    >
                      User Details
                    </Typography>
                    <IconButton
                      onClick={() => {
                        // fetchListDate();
                        setOpenStudentDetailsModal(false);
                      }}
                    >
                      <span className="material-icons">close</span>
                    </IconButton>
                  </Box>

                  {selectedStudent && (
                    <Box
                      sx={{
                        display: "flex",
                        flexDirection: "column",
                        alignItems: "center",
                        textAlign: "center",
                        gap: 2,
                        fontSize: { xs: "12px", md: "15px", lg: "18px" },
                      }}
                    >
                      {/* Display user's photo in a circle */}
                      {/*<Box
                                       component="img"
                                       // src={
                                       //   "https://drive.google.com/thumbnail?id=1cPyIpmPL-n24bhuBv7XPzP2hXmS5E7FD&sz=w1000"
                                       // }
                                       src={"./studentEmoji.png"}
                                       alt={selectedStudent?.name}
                                       sx={{
                                         width: { xs: 60, sm: 100 },
                                         height: { xs: 60, sm: 100 },
                                         borderRadius: "50%",
                                         objectFit: "cover",
                                       }}
                                     />*/}

                      {/* Display user details */}

                      <Typography
                        variant="body1"
                        sx={{
                          width: "100%",
                          fontSize: { xs: "12px", md: "15px", lg: "18px" },
                        }}
                      >
                        <strong>User Code:</strong>{" "}
                        {selectedStudent?.userId ?? "-"}
                      </Typography>

                      <Typography
                        variant="body1"
                        xs={12}
                        sx={{
                          fontSize: { xs: "12px", md: "15px", lg: "18px" },
                        }}
                      >
                        <strong>Full Name:</strong>{" "}
                        {selectedStudent?.fullName ?? "-"}
                      </Typography>
                      <Typography
                        variant="body1"
                        sx={{
                          width: "100%",
                          fontSize: { xs: "12px", md: "15px", lg: "18px" },
                        }}
                      >
                        <strong>Role:</strong> {selectedStudent?.role ?? "-"}
                      </Typography>

                      <Typography
                        variant="body1"
                        sx={{
                          fontSize: { xs: "12px", md: "15px", lg: "18px" },
                        }}
                      >
                        <strong> Branch code:</strong>{" "}
                        {selectedStudent?.branchCode ?? "-"}
                      </Typography>
                      <Typography variant="body1">
                        <strong>Father:</strong> {selectedStudent?.careOf}
                      </Typography>

                      <Typography variant="body1">
                        <strong>Email:</strong> {selectedStudent.email}
                      </Typography>
                      <Typography
                        variant="body1"
                        sx={{
                          fontSize: { xs: "12px", md: "15px", lg: "18px" },
                        }}
                      >
                        <strong>Mobile:</strong>{" "}
                        {selectedStudent?.mobile ?? "-"}
                      </Typography>
                      <Typography
                        variant="body1"
                        sx={{
                          fontSize: { xs: "12px", md: "15px", lg: "18px" },
                        }}
                      >
                        <strong>Address:</strong>{" "}
                        {selectedStudent?.address ?? "-"}
                      </Typography>

                      {/* <Box>
                                 <Button variant="outlined">Edit</Button>
                               </Box> */}
                    </Box>
                  )}
                </Box>
              </Dialog>
            )}
          </div>
        );
      };

      const Management2 = () => {
        const [checked, setChecked] = useState(false);
        const [submitted, setSubmitted] = useState(true);
        const [familyMembers, setFamilyMembers] = useState(0);
        const [listData, setListData] = useState([]);
        const [showList, setShowList] = useState(true);
        const [loading, setLoading] = useState(false);
        const [selectedStudent, setSelectedStudent] = React.useState(null);
        // const [newUserModal, setNewUserModal] = React.useState(false);
        const [openStudentDetailsModal, setOpenStudentDetailsModal] =
          React.useState(false);

        const [user, setUser] = useState({
          fullName: "",
          gender: "",
          father: "",
          email: "",
          phone: "",
          profession: "",
          branch: "",
          role: "",
        });

        const [errors, setErrors] = useState({});

        const validateField = (name, value) => {
          const newErrors = { ...errors };

          switch (name) {
            case "userId":
              if (!value) newErrors.userId = "user ID is required.";
              else delete newErrors.userId;
              break;
            // case "surname":
            //   if (!value) newErrors.surname = "Surname is required.";
            //   else delete newErrors.surname;
            //   break;
            case "fullName":
              if (!value) newErrors.fullName = "Name is required.";
              else delete newErrors.fullName;
              break;
            case "email":
              if (!value) {
                newErrors.email = "Email is required.";
              } else if (!/\S+@\S+\.\S+/.test(value)) {
                newErrors.email = "Email is invalid.";
              } else {
                delete newErrors.email;
              }
              break;
            // case "phone":
            //   if (!value) {
            //     newErrors.phone = "Phone number is required.";
            //   } else if (!/^\d{10}$/.test(value)) {
            //     newErrors.phone = "Phone number must be 10 digits.";
            //   } else {
            //     delete newErrors.phone;
            //   }
            //   break;
            // case "address":
            //   if (!value) newErrors.address = "Address is required.";
            //   else delete newErrors.address;
            //   break;
            //   case "profession":
            //     if (!value) newErrors.profession = "Profession is required.";
            //     else delete newErrors.profession;
            //     break;
            // case "father":
            //   if (!value) newErrors.father = "Gardian name is required.";
            //   else delete newErrors.father;
            //   break;
            // case "profession":
            //   if (!value)
            //     newErrors.profession = "profession's name is required.";
            //   else delete newErrors.profession;
            //   break;
            // case "role":
            //   if (!value) newErrors.role = "Batch Year is required.";
            //   else if (!/^\d{4}$/.test(value)) {
            //     newErrors.role = "Batch Year must be a 4-digit year.";
            //   } else {
            //     delete newErrors.role;
            //   }
            //   break;
            default:
              break;
          }

          setErrors(newErrors);
        };

        const handleChange = (event) => {
          const { name, value } = event.target;
          setUser({
            ...user,
            [name]: value,
          });

          validateField(name, value); // validate each field on change
        };

        const handleSubmit = (event) => {
          event.preventDefault();
          console.log("user", user);
          console.log("errors", errors);
          try {
            if (
              Object.keys(errors).length === 0
              // &&
              // Object.values(user).every((val) => val !== "")
            ) {
              // users.push({
              //   ...user,
              //   roleId: 0,
              //   theme: "",
              //   active: true,
              //   joinDate: "",
              //   branchCode: "GNB01",
              //   gender: "Male",
              //   careOf: "",
              // });

              // console.log("users", users);
              axios
                .post(`${baseURL}/add-new-gn-user`, {
                  fullName: user.fullName,
                  userId: "GNC" + user.phone,
                  role: "customer",
                  mobile: user.phone,
                  email: user.email,
                  otp: "123456",
                  loginExpiration: "",
                  password: user.password,
                  address: user.address,
                  roleId: 0,
                  theme: "",
                  active: true,
                  joinDate: "",
                  branchCode: user?.branch,
                  gender: user.gender,
                  careOf: user.father,
                })

                .then((res) => {
                  // alert(res.data.message);
                  if (res.data.message != "Same details enrolled") {
                    setShowList(true);
                    fetchListDate();
                  }
                })
                .catch((error) => {
                  // setShowList(true);
                  // setShowList(false);
                  // alert("catch", error);
                  alert(error.message);
                  console.log("Error occurred:", error);
                });

              setShowList(true);
            } else {
              alert("some fileds missing");
            }
          } catch (err) {
            console.log("err", err);
          }
          // Final validation before submission
        };

        useEffect(() => {
          setLoading(true);
          try {
            fetch(`${baseURL}/get-gn-users`, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              credentials: "include",
              body: JSON.stringify({ need: "customers" }),
            })
              .then((response) => response.json()) // Parse the JSON
              .then((data) => {
                setListData(data.data);
                setLoading(false);
              })
              .catch((error) => {
                console.error("Error loading JSON:", error);
                setLoading(false);
              });
          } catch (er) {
            setLoading(false);
            console.log("er", er);
            alert("catch");
          }
        }, []);
        const fetchListDate = () => {
          try {
            fetch(`${baseURL}/get-gn-users`, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              credentials: "include",
              body: JSON.stringify({ need: "customers" }),
            })
              .then((response) => response.json()) // Parse the JSON
              .then((data) => {
                setListData(data.data);
                setLoading(false);
              })
              .catch((error) => {
                console.error("Error loading JSON:", error);
                setLoading(false);
              });
          } catch (er) {
            console.log("er", er);
            alert("catch");
          }
        };

        const [searchFilter, setSearchFilter] = React.useState("");

        const [roleFilter, setRoleFilter] = React.useState("");

        const getFilteredlist = () => {
          console.log("listData", listData);
          return listData.filter((user) => {
            return (
              user?.role.toLowerCase().includes(roleFilter.toLowerCase()) &&
              user?.fullName.toLowerCase().includes(searchFilter.toLowerCase())
            );
          });
        };

        const clearStudentFilters = () => {
          setSearchFilter("");
          setRoleFilter("");
        };
        const [branches, setBranches] = useState([]);
        const fetchBranches = () => {
          fetch(`${baseURL}/get-all-branches`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            credentials: "include",
            body: JSON.stringify({}),
          })
            .then((response) => response.json()) // Parse the JSON
            .then((data) => {
              setBranches(data);
            })
            .catch((error) => {
              console.error("Error loading JSON:", error);
              setBranches([]);
            });
        };

        return (
          <div
            style={{
              overflowX: "scroll",
            }}
          >
            {loading ? (
              <div className="loader-container">
                <div className="loader"></div>
              </div>
            ) : showList ? (
              <div className="form-container">
                <Box sx={{ p: 0, m: 0, width: "100%" }} className="box">
                  <Box
                    sx={{
                      display: "flex",
                      justifyContent: "space-between",
                      alignItems: "center",
                      // mb: 3,
                    }}
                  >
                    <Typography
                      variant="h5"
                      gutterBottom
                      sx={{ fontWeight: "bold", fontSize: "1.25rem" }} // Reduced font size
                    >
                      Customers
                    </Typography>
                  </Box>
                  <Box
                    sx={{
                      display: "flex",
                      justifyContent: "space-between",
                      alignItems: "center",
                      // mb: 3,
                    }}
                  >
                    <Typography
                      variant="h5"
                      gutterBottom
                      sx={{ fontWeight: "bold", fontSize: "1rem" }} // Reduced font size
                    >
                      filtered :{" "}
                      {getFilteredlist().reduce((acc, el) => acc + 1, 0)} /{" "}
                      {getFilteredlist().length}
                    </Typography>
                    <Button
                      onClick={() => {
                        // alert("Contact administrator2");
                        setShowList(false);
                        fetchBranches();
                        // setNewUserModal(true);
                      }}
                      variant="contained"
                      color="primary"
                      // href="https://zphs-school.vercel.app/enroll-form"
                      // href="https://sakinalaraju100.github.io/zphs-school/public/addStudentForm.html"
                    >
                      New User
                    </Button>
                  </Box>

                  {/* New user Button */}
                  <Box sx={{ mb: 3, textAlign: "right" }}></Box>

                  {/* Filters Section */}

                  <Box sx={{ mb: 3 }}>
                    <Box
                      sx={{
                        display: "flex",
                        flexDirection: "row",
                        gap: 2,
                        flexWrap: "wrap",
                        mb: 2,
                      }}
                    >
                      {/*<Box sx={{ flexGrow: 1, minWidth: "200px" }}>
                                 <Typography
                                   variant="subtitle2"
                                   gutterBottom
                                   sx={{ fontSize: "0.875rem" }}
                                 ></Typography>
                                 <Box
                                   sx={{
                                     display: "flex",
                                     alignItems: "center",
                                     bgcolor: "grey.100",
                                     borderRadius: 1,
                                     px: 2,
                                   }}
                                 >
                                   <span
                                     className="material-icons"
                                     sx={{ color: "grey.500" }}
                                   >
                                     school
                                   </span>
                                   <select
                                     value={roleFilter}
                                     onChange={(e) => {
                                       // console.log("roleFilter", e.target.value);
                                       setRoleFilter(e.target.value);
                                       setSearchFilter("");
                                       getFilteredlist();
                                     }}
                                     style={{
                                       border: "none",
                                       outline: "none",
                                       padding: "8px",
                                       backgroundColor: "transparent",
                                       width: "100%",
                                     }}
                                   >
                                     <option value="">All</option>
                                     {roles.map((role, ri) => (
                                       <option key={ri + role} value={role}>
                                         {role}
                                       </option>
                                     ))}
                                   </select>
                                 </Box>
                               </Box>*/}
                      <Box sx={{ flexGrow: 1, minWidth: "200px" }}>
                        <Typography
                          variant="subtitle2"
                          gutterBottom
                          sx={{ fontSize: "0.875rem" }}
                        ></Typography>
                        <Box
                          sx={{
                            display: "flex",
                            alignItems: "center",
                            bgcolor: "grey.100",
                            borderRadius: 1,
                            px: 2,
                          }}
                        >
                          <span
                            className="material-icons"
                            sx={{ color: "grey.500" }}
                          >
                            search
                          </span>
                          <input
                            type="text"
                            // value={searchFilter}
                            // onChange={(e) => setSearchFilter(e.target.value)}
                            value={searchFilter}
                            onChange={(e) => {
                              setSearchFilter(e.target.value);
                              getFilteredlist();
                              // if (e.target.value.length > 2) {
                              //   // setSearchFilter(e.target.value);
                              // } else {
                              //   setSearchFilter("");
                              // }
                            }}
                            placeholder="Filter by name, role, gender, mobile or branch..."
                            style={{
                              border: "none",
                              outline: "none",
                              padding: "8px",
                              backgroundColor: "transparent",
                              width: "100%",
                            }}
                          />
                          {searchFilter && (
                            <IconButton
                              onClick={() => {
                                setSearchFilter("");
                              }}
                              sx={{ ml: 1 }}
                            >
                              <span
                                className="material-icons"
                                style={{ color: "grey.500" }}
                              >
                                clear
                              </span>
                            </IconButton>
                          )}
                        </Box>
                      </Box>
                    </Box>
                  </Box>

                  <Box sx={{ width: "100%", overflowX: "auto" }}>
                    <TableContainer sx={{ minWidth: "250px" }}>
                      <Table sx={{}}>
                        <TableHead>
                          <TableRow sx={{ bgcolor: "primary.main" }}>
                            <TableCell
                              sx={{
                                color: "white",
                                fontWeight: "bold",
                                backgroundColor: "primary.main",
                                position: "sticky",
                                left: 0,
                                zIndex: 1,
                              }}
                            >
                              Code
                            </TableCell>

                            <TableCell
                              sx={{ color: "white", fontWeight: "bold" }}
                            >
                              Full Name
                            </TableCell>

                            <TableCell
                              sx={{ color: "white", fontWeight: "bold" }}
                            >
                              Role
                            </TableCell>

                            <TableCell
                              sx={{ color: "white", fontWeight: "bold" }}
                            >
                              Branch code
                            </TableCell>

                            <TableCell
                              sx={{ color: "white", fontWeight: "bold" }}
                            >
                              Mobile
                            </TableCell>
                            <TableCell
                              sx={{ color: "white", fontWeight: "bold" }}
                            >
                              email
                            </TableCell>
                            <TableCell
                              sx={{ color: "white", fontWeight: "bold" }}
                            >
                              address
                            </TableCell>
                          </TableRow>
                        </TableHead>
                        <TableBody>
                          {getFilteredlist().map((user, ind) => (
                            <TableRow
                              key={ind}
                              onClick={() => {
                                setSelectedStudent(user);
                                setOpenStudentDetailsModal(true);
                                // setChecked(user?.enrolled);
                                // setFamilyMembers(user?.familyMembers);
                              }}
                              sx={{
                                "&:nth-of-type(odd)": { bgcolor: "grey.50" },
                                "&:hover": { bgcolor: "grey.100" },
                              }}
                            >
                              <TableCell
                                sx={{
                                  color: "white",
                                  fontWeight: "bold",
                                  position: "sticky",
                                  left: 0,
                                  backgroundColor: user?.enrolled
                                    ? "lightblue"
                                    : "lightgreen",
                                  zIndex: 1,
                                }}
                              >
                                {user?.userId ?? "-"}
                              </TableCell>
                              <TableCell>{user?.fullName ?? "-"}</TableCell>
                              {/* <TableCell>{user?.father}</TableCell> */}
                              <TableCell>{user?.role ?? "-"}</TableCell>
                              <TableCell>{user?.branchCode ?? "-"}</TableCell>
                              <TableCell>{user?.mobile ?? "-"}</TableCell>
                              <TableCell>{user?.email ?? "-"}</TableCell>
                              <TableCell>{user?.address ?? "-"}</TableCell>
                            </TableRow>
                          ))}
                        </TableBody>
                      </Table>
                    </TableContainer>
                  </Box>

                  <Box sx={{ mt: 3, textAlign: "center" }}>
                    <Typography
                      variant="body2"
                      color="text.secondary"
                      sx={{ fontSize: "0.875rem" }}
                      onClick={() => {
                        setShowList(false);
                      }}
                    >
                      For any updates, please contact the administration.
                    </Typography>
                  </Box>
                </Box>
              </div>
            ) : (
              <Box
                sx={{
                  maxWidth: "500px",
                  margin: "auto",
                  padding: "20px",
                  backgroundColor: "#fff",
                  borderRadius: "8px",
                  boxShadow: 2,
                }}
              >
                <Typography variant="h5" textAlign="center" mb={2}>
                  New Customer
                </Typography>
                <form onSubmit={handleSubmit}>
                  {/* Role Selection
                           <FormControl fullWidth margin="normal">
                             <InputLabel>Role</InputLabel>
                             <Select
                               label="Role"
                               name="role"
                               value={user.role}
                               onChange={handleChange}
                             >
                               {roles.map((role, index) => (
                                 <MenuItem key={index} value={role}>
                                   {role}
                                 </MenuItem>
                               ))}
                             </Select>
                             <FormHelperText error={Boolean(errors.role)}>
                               {errors.role}
                             </FormHelperText>
                           </FormControl>*/}

                  {/* Full Name */}
                  <TextField
                    label="Full Name"
                    name="fullName"
                    value={user.fullName}
                    onChange={handleChange}
                    fullWidth
                    margin="normal"
                    error={Boolean(errors.fullName)}
                    helperText={errors.fullName}
                  />

                  {/* Care Of Person */}
                  <TextField
                    label="Care Of Person"
                    name="father"
                    value={user.father}
                    onChange={handleChange}
                    fullWidth
                    margin="normal"
                    error={Boolean(errors.father)}
                    helperText={errors.father}
                  />

                  {/* Gender Selection */}
                  <FormControl fullWidth margin="normal">
                    <InputLabel>Gender</InputLabel>
                    <Select
                      label="Gender"
                      name="gender"
                      value={user.gender}
                      onChange={handleChange}
                    >
                      <MenuItem value="Male">Male</MenuItem>
                      <MenuItem value="Female">Female</MenuItem>
                    </Select>
                  </FormControl>

                  {/* Email */}
                  <TextField
                    label="Email"
                    name="email"
                    type="email"
                    value={user.email}
                    onChange={handleChange}
                    fullWidth
                    margin="normal"
                    error={Boolean(errors.email)}
                    helperText={errors.email}
                  />

                  {/* Phone */}
                  <TextField
                    label="Phone"
                    name="phone"
                    value={user.phone}
                    onChange={handleChange}
                    fullWidth
                    margin="normal"
                    error={Boolean(errors.phone)}
                    helperText={errors.phone}
                  />

                  {/* password */}
                  <TextField
                    label="Password"
                    name="password"
                    value={user.password}
                    onChange={handleChange}
                    fullWidth
                    margin="normal"
                    error={Boolean(errors.password)}
                    helperText={errors.password}
                  />

                  {/* Branch Selection */}
                  <FormControl fullWidth margin="normal">
                    <InputLabel>Branch</InputLabel>
                    <Select
                      label="Branch"
                      name="branch"
                      value={user.branch}
                      onChange={handleChange}
                    >
                      {branches.map((branch) => (
                        <MenuItem
                          key={branch?.branchCode}
                          value={branch?.branchCode}
                        >
                          {branch?.name}
                        </MenuItem>
                      ))}
                    </Select>
                  </FormControl>

                  {/* Buttons */}
                  <Box
                    sx={{
                      display: "flex",
                      flexDirection: { xs: "column", sm: "row" },
                      gap: 2,
                      mt: 3,
                    }}
                  >
                    <Button
                      onClick={() => setShowList(true)}
                      variant="outlined"
                      color="secondary"
                      fullWidth
                    >
                      Back
                    </Button>
                    <Button
                      //  onClick={() => {}}
                      type="submit"
                      variant="contained"
                      color="primary"
                      fullWidth
                    >
                      Submit
                    </Button>
                  </Box>
                </form>
              </Box>
            )}

            {/* Modal for user Details*/}
            {selectedStudent && (
              <Dialog
                open={openStudentDetailsModal}
                onClose={() => setOpenStudentDetailsModal(false)}
                fullWidth
                maxWidth="sm"
                sx={{
                  fontSize: "6px",
                  "& .MuiDialogContent-root": {
                    padding: "16px",
                    display: "flex",
                    flexDirection: "column",
                    justifyContent: "center",
                    alignItems: "center", // Vertical centering
                  },
                  "& .MuiDialogTitle-root": {
                    backgroundColor: "#1976d2",
                    color: "white",
                  },
                }}
              >
                <Box sx={{ p: 3 }}>
                  <Box
                    sx={{
                      display: "flex",
                      justifyContent: "space-between",
                      alignItems: "center",
                      mb: 2,
                    }}
                  >
                    <Typography
                      variant="h5"
                      gutterBottom
                      sx={{
                        fontWeight: "bold",
                        textAlign: "center",
                        flex: 1,
                        fontSize: { xs: "12px", md: "15px", lg: "18px" },
                      }}
                    >
                      User Details
                    </Typography>
                    <IconButton
                      onClick={() => {
                        // fetchListDate();
                        setOpenStudentDetailsModal(false);
                      }}
                    >
                      <span className="material-icons">close</span>
                    </IconButton>
                  </Box>

                  {selectedStudent && (
                    <Box
                      sx={{
                        display: "flex",
                        flexDirection: "column",
                        alignItems: "center",
                        textAlign: "center",
                        gap: 2,
                        fontSize: { xs: "12px", md: "15px", lg: "18px" },
                      }}
                    >
                      {/* Display user's photo in a circle */}
                      {/*<Box
                                       component="img"
                                       // src={
                                       //   "https://drive.google.com/thumbnail?id=1cPyIpmPL-n24bhuBv7XPzP2hXmS5E7FD&sz=w1000"
                                       // }
                                       src={"./studentEmoji.png"}
                                       alt={selectedStudent?.name}
                                       sx={{
                                         width: { xs: 60, sm: 100 },
                                         height: { xs: 60, sm: 100 },
                                         borderRadius: "50%",
                                         objectFit: "cover",
                                       }}
                                     />*/}

                      {/* Display user details */}

                      <Typography
                        variant="body1"
                        sx={{
                          width: "100%",
                          fontSize: { xs: "12px", md: "15px", lg: "18px" },
                        }}
                      >
                        <strong>User Code:</strong>{" "}
                        {selectedStudent?.userId ?? "-"}
                      </Typography>

                      <Typography
                        variant="body1"
                        xs={12}
                        sx={{
                          fontSize: { xs: "12px", md: "15px", lg: "18px" },
                        }}
                      >
                        <strong>Full Name:</strong>{" "}
                        {selectedStudent?.fullName ?? "-"}
                      </Typography>
                      <Typography
                        variant="body1"
                        sx={{
                          width: "100%",
                          fontSize: { xs: "12px", md: "15px", lg: "18px" },
                        }}
                      >
                        <strong>Role:</strong> {selectedStudent?.role ?? "-"}
                      </Typography>

                      <Typography
                        variant="body1"
                        sx={{
                          fontSize: { xs: "12px", md: "15px", lg: "18px" },
                        }}
                      >
                        <strong> Branch code:</strong>{" "}
                        {selectedStudent?.branchCode ?? "-"}
                      </Typography>
                      <Typography variant="body1">
                        <strong>Father:</strong> {selectedStudent?.careOf}
                      </Typography>

                      <Typography variant="body1">
                        <strong>Email:</strong> {selectedStudent.email}
                      </Typography>
                      <Typography
                        variant="body1"
                        sx={{
                          fontSize: { xs: "12px", md: "15px", lg: "18px" },
                        }}
                      >
                        <strong>Mobile:</strong>{" "}
                        {selectedStudent?.mobile ?? "-"}
                      </Typography>
                      <Typography
                        variant="body1"
                        sx={{
                          fontSize: { xs: "12px", md: "15px", lg: "18px" },
                        }}
                      >
                        <strong>Address:</strong>{" "}
                        {selectedStudent?.address ?? "-"}
                      </Typography>

                      {/* <Box>
                                 <Button variant="outlined">Edit</Button>
                               </Box> */}
                    </Box>
                  )}
                </Box>
              </Dialog>
            )}
          </div>
        );
      };

      const SalesReports = () => {
        const [selectedLoan, setSelectedLoan] = React.useState(null);

        const [openStudentDetailsModal, setOpenStudentDetailsModal] =
          React.useState(false);

        // useEffect(() => {
        //   const ctx = document.getElementById("myPieChart").getContext("2d");
        //   new Chart(ctx, {
        //     type: "pie",
        //     data: {
        //       labels: ["Completed", "In Progress", "Rejected", "Pending"],
        //       datasets: [
        //         {
        //           label: " Value ",
        //           data: [110, 80, 55, 63],
        //           backgroundColor: ["green", "blue", "red", "orange"],
        //           hoverOffset: 3,
        //         },
        //       ],
        //     },
        //   });
        // }, []);

        // useEffect(() => {
        //   const ctx = document.getElementById("myPieChart").getContext("2d");
        //   new Chart(ctx, {
        //     type: "pie",
        //     data: {
        //       labels: ["In Progress", "Pending", "Completed", "Rejected"],
        //       datasets: [
        //         {
        //           label: " Value ",
        //           data: [110, 80, 55, 63],
        //           backgroundColor: ["orange", "blue", "green", "red"],
        //           hoverOffset: 3,
        //         },
        //       ],
        //     },
        //     options: {
        //       responsive: true,
        //       plugins: {
        //         legend: {
        //           position: "top",
        //         },
        //         tooltip: {
        //           callbacks: {
        //             label: function (tooltipItem) {
        //               return tooltipItem.label + ": " + tooltipItem.raw;
        //             },
        //           },
        //         },
        //       },
        //       cutout: "50%", // Adjust this value to change the center radius
        //     },
        //   });
        // }, []);

        useEffect(() => {
          const ctx = document.getElementById("myPieChart").getContext("2d");
          const total = [110, 80, 55, 63].reduce((a, b) => a + b, 0);

          const centerTextPlugin = {
            id: "centerText",
            beforeDraw: (chart) => {
              const { width, height, ctx } = chart;
              ctx.save();
              ctx.font = "bold 16px sans-serif";
              ctx.fillStyle = "black";
              ctx.textAlign = "center";
              ctx.textBaseline = "middle";
              ctx.fillText(`Total: ${total}`, width / 2, height / 1.6);
              ctx.restore();
            },
          };

          new Chart(ctx, {
            type: "pie",
            data: {
              labels: ["In Progress", "Pending", "Completed", "Rejected"],
              datasets: [
                {
                  label: " Value ",
                  data: [110, 80, 55, 63],
                  backgroundColor: ["orange", "blue", "green", "red"],
                  hoverOffset: 3,
                },
              ],
            },
            options: {
              responsive: true,
              plugins: {
                legend: {
                  position: "top",
                },
                tooltip: {
                  callbacks: {
                    label: function (tooltipItem) {
                      return tooltipItem.label + ": " + tooltipItem.raw;
                    },
                  },
                },
              },
              cutout: "50%", // Creates a doughnut effect
            },
            plugins: [centerTextPlugin],
          });
        }, []);

        // useEffect(() => {
        //   const ctx = document.getElementById("myPieChart").getContext("2d");
        //   new Chart(ctx, {
        //     type: "pie",
        //     data: {
        //       labels: ["In Progress", "Pending", "Completed", "Rejected"],
        //       // labels: ["Completed", "In Progress", "Rejected", "Pending"],
        //       datasets: [
        //         {
        //           label: " Value ",
        //           data: [110, 80, 55, 63],
        //           backgroundColor: ["green", "blue", "red", "orange"],
        //           hoverOffset: 3,
        //         },
        //       ],
        //     },
        //     options: {
        //       responsive: true,
        //       plugins: {
        //         legend: {
        //           position: "top",
        //         },
        //         tooltip: {
        //           callbacks: {
        //             label: function (tooltipItem) {
        //               return tooltipItem.label + ": " + tooltipItem.raw;
        //             },
        //           },
        //         },
        //         // Custom plugin to display text in the center
        //         datalabels: {
        //           display: true,
        //           align: "center",
        //           anchor: "center",
        //           formatter: () => "Total: 200", // Display total count
        //           font: {
        //             size: "20", // Adjust font size as needed
        //             weight: "bold",
        //           },
        //         },
        //       },
        //       cutout: "50%", // Adjust this value to change the center radius
        //     },
        //     plugins: [ChartDataLabels], // Ensure you include the ChartDataLabels plugin
        //   });
        // }, []);

        const [searchFilter, setSearchFilter] = React.useState("");

        const [roleFilter, setRoleFilter] = React.useState("");

        const getFilteredlist = () => {
          return allLoans.filter((user) => {
            return (
              user?.status.toLowerCase().includes(roleFilter.toLowerCase()) &&
              user?.fullName.toLowerCase().includes(searchFilter.toLowerCase())
            );
          });
        };

        const clearStudentFilters = () => {
          setSearchFilter("");
          setRoleFilter("");
        };

        return (
          <div>
            <h2>Sales Report</h2>
            <div style={{ width: "80%", margin: "auto" }}>
              <canvas id="myPieChart"></canvas>
            </div>

            <div className="form-container">
              <Box sx={{ p: 0, m: 0, width: "100%" }} className="box">
                <Box
                  sx={{
                    display: "flex",
                    justifyContent: "space-between",
                    alignItems: "center",
                    // mb: 3,
                  }}
                >
                  <Typography
                    variant="h5"
                    gutterBottom
                    sx={{ fontWeight: "bold", fontSize: "1.25rem" }} // Reduced font size
                  >
                    Loans
                  </Typography>
                </Box>
                <Box
                  sx={{
                    display: "flex",
                    justifyContent: "space-between",
                    alignItems: "center",
                    // mb: 3,
                  }}
                >
                  <Typography
                    variant="h5"
                    gutterBottom
                    sx={{ fontWeight: "bold", fontSize: "1rem" }} // Reduced font size
                  >
                    filtered :{" "}
                    {getFilteredlist().reduce((acc, el) => acc + 1, 0)} /{" "}
                    {allLoans.length}
                  </Typography>
                  {/*<Button
                                   onClick={() => {
                                     // alert("Contact administrator");
                                     // setShowList(false);
                                     setBodyarea("ApplyLoan");
                                     // setNewUserModal(true);
                                   }}
                                   variant="contained"
                                   color="primary"
                                   // href="https://zphs-school.vercel.app/enroll-form"
                                   // href="https://sakinalaraju100.github.io/zphs-school/public/addStudentForm.html"
                                 >
                                   apply Loan
                                 </Button>*/}
                </Box>

                {/* New user Button */}
                <Box sx={{ mb: 3, textAlign: "right", gap: 2 }}>
                  <Button
                    onClick={() => {
                      setRoleFilter("Active");
                    }}
                    variant="contained"
                    color="primary"
                    sx={{ mr: 1 }}
                  >
                    Active Loans
                  </Button>
                  <Button
                    onClick={() => {
                      setRoleFilter("Month");
                    }}
                    variant="contained"
                    color="primary"
                  >
                    Current Month
                  </Button>
                  {/* <Button
                                   onClick={() => {
                                     // setBodyarea("ApplyLoan");
                                   }}
                                   variant="contained"
                                   color="primary"
                                 >
                                   Dis
                                 </Button>*/}
                </Box>

                {/* Filters Section */}

                <Box sx={{ mb: 3 }}>
                  <Box
                    sx={{
                      display: "flex",
                      flexDirection: "row",
                      gap: 2,
                      flexWrap: "wrap",
                      mb: 2,
                    }}
                  >
                    <Box sx={{ flexGrow: 1, minWidth: "200px" }}>
                      <Typography
                        variant="subtitle2"
                        gutterBottom
                        sx={{ fontSize: "0.875rem" }}
                      ></Typography>
                      <Box
                        sx={{
                          display: "flex",
                          alignItems: "center",
                          bgcolor: "grey.100",
                          borderRadius: 1,
                          px: 2,
                        }}
                      >
                        <span
                          className="material-icons"
                          sx={{ color: "grey.500" }}
                        >
                          school
                        </span>
                        <select
                          value={roleFilter}
                          onChange={(e) => {
                            // console.log("roleFilter", e.target.value);
                            setRoleFilter(e.target.value);
                            setSearchFilter("");
                            getFilteredlist();
                          }}
                          style={{
                            border: "none",
                            outline: "none",
                            padding: "8px",
                            backgroundColor: "transparent",
                            width: "100%",
                          }}
                        >
                          <option value="">All</option>
                          {[
                            "Active",
                            "Verification",
                            "Completed",
                            "Rejected",
                            "Month",
                            "Day",
                            "Week",
                            "Year",
                          ].map((role, ri) => (
                            <option key={ri + role} value={role}>
                              {role}
                            </option>
                          ))}
                        </select>
                      </Box>
                    </Box>
                    <Box sx={{ flexGrow: 1, minWidth: "200px" }}>
                      <Typography
                        variant="subtitle2"
                        gutterBottom
                        sx={{ fontSize: "0.875rem" }}
                      ></Typography>
                      <Box
                        sx={{
                          display: "flex",
                          alignItems: "center",
                          bgcolor: "grey.100",
                          borderRadius: 1,
                          px: 2,
                        }}
                      >
                        <span
                          className="material-icons"
                          sx={{ color: "grey.500" }}
                        >
                          search
                        </span>
                        <input
                          type="text"
                          // value={searchFilter}
                          // onChange={(e) => setSearchFilter(e.target.value)}
                          value={searchFilter}
                          onChange={(e) => {
                            setSearchFilter(e.target.value);
                            getFilteredlist();
                            // if (e.target.value.length > 2) {
                            //   // setSearchFilter(e.target.value);
                            // } else {
                            //   setSearchFilter("");
                            // }
                          }}
                          placeholder="Filter by Name, Loan ID, Status..."
                          style={{
                            border: "none",
                            outline: "none",
                            padding: "8px",
                            backgroundColor: "transparent",
                            width: "100%",
                          }}
                        />
                        {searchFilter && (
                          <IconButton
                            onClick={() => {
                              setSearchFilter("");
                            }}
                            sx={{ ml: 1 }}
                          >
                            <span
                              className="material-icons"
                              style={{ color: "grey.500" }}
                            >
                              clear
                            </span>
                          </IconButton>
                        )}
                      </Box>
                    </Box>
                  </Box>
                </Box>

                <Box sx={{ width: "100%", overflowX: "auto" }}>
                  <TableContainer sx={{ minWidth: "250px" }}>
                    <Table sx={{}}>
                      <TableHead>
                        <TableRow sx={{ bgcolor: "primary.main" }}>
                          <TableCell
                            sx={{
                              color: "white",
                              fontWeight: "bold",
                              backgroundColor: "primary.main",
                              position: "sticky",
                              left: 0,
                              zIndex: 1,
                            }}
                          >
                            LoanID
                          </TableCell>

                          <TableCell
                            sx={{ color: "white", fontWeight: "bold" }}
                          >
                            Full Name
                          </TableCell>

                          <TableCell
                            sx={{ color: "white", fontWeight: "bold" }}
                          >
                            status
                          </TableCell>

                          <TableCell
                            sx={{ color: "white", fontWeight: "bold" }}
                          >
                            mobile
                          </TableCell>

                          {/*}

                                           <TableCell
                                             sx={{ color: "white", fontWeight: "bold" }}
                                           >
                                             Sales Member
                                           </TableCell>*/}

                          <TableCell
                            sx={{ color: "white", fontWeight: "bold" }}
                          >
                            notes
                          </TableCell>
                        </TableRow>
                      </TableHead>
                      <TableBody>
                        {/* {allLoans.map((loan, ind) => (*/}
                        {getFilteredlist().map((loan, ind) => (
                          <TableRow
                            key={ind}
                            onClick={() => {
                              setSelectedLoan(loan);
                              setOpenStudentDetailsModal(true);
                              // setChecked(loan?.enrolled);
                              // setFamilyMembers(loan?.familyMembers);
                            }}
                            sx={{
                              "&:nth-of-type(odd)": { bgcolor: "grey.50" },
                              "&:hover": { bgcolor: "grey.100" },
                            }}
                          >
                            <TableCell
                              sx={{
                                color: "white",
                                fontWeight: "bold",
                                position: "sticky",
                                left: 0,
                                backgroundColor: loan?.enrolled
                                  ? "lightblue"
                                  : "lightgreen",
                                zIndex: 1,
                              }}
                            >
                              {loan?.loanId ?? "-"}
                            </TableCell>
                            <TableCell>{loan?.fullName ?? "-"}</TableCell>
                            {/* <TableCell>{loan?.father}</TableCell> */}
                            <TableCell>{loan?.status ?? "-"}</TableCell>
                            <TableCell>{loan?.mobile ?? "-"}</TableCell>
                            <TableCell>{loan?.notes ?? "-"}</TableCell>
                            {/*} <TableCell>{loan?.email ?? "-"}</TableCell>
                                             <TableCell>{loan?.address ?? "-"}</TableCell>*/}
                          </TableRow>
                        ))}
                      </TableBody>
                    </Table>
                  </TableContainer>
                </Box>

                <Box sx={{ mt: 3, textAlign: "center" }}>
                  <Typography
                    variant="body2"
                    color="text.secondary"
                    sx={{ fontSize: "0.875rem" }}
                    onClick={() => {
                      // setShowList(false);
                    }}
                  >
                    For any updates, please contact the administration.
                  </Typography>
                </Box>
              </Box>
            </div>
            {/* Modal for user Details*/}
            {selectedLoan && (
              <Dialog
                open={openStudentDetailsModal}
                onClose={() => setOpenStudentDetailsModal(false)}
                fullWidth
                maxWidth="sm"
                sx={{
                  width: "100%",
                  fontSize: "6px",
                  "& .MuiDialogContent-root": {
                    padding: "16px",
                    display: "flex",
                    flexDirection: "column",
                    justifyContent: "center",
                    alignItems: "center", // Vertical centering
                  },
                  "& .MuiDialogTitle-root": {
                    backgroundColor: "#1976d2",
                    color: "white",
                  },
                }}
              >
                <Box sx={{ p: 3 }}>
                  <Box
                    sx={{
                      display: "flex",
                      justifyContent: "space-between",
                      alignItems: "center",
                      mb: 2,
                    }}
                  >
                    <Typography
                      variant="h5"
                      gutterBottom
                      sx={{
                        fontWeight: "bold",
                        textAlign: "center",
                        flex: 1,
                        fontSize: { xs: "12px", md: "15px", lg: "18px" },
                      }}
                    >
                      Loan Details
                    </Typography>
                    <IconButton
                      onClick={() => {
                        // fetchListDate();
                        setOpenStudentDetailsModal(false);
                      }}
                    >
                      <span className="material-icons">close</span>
                    </IconButton>
                  </Box>

                  <Box
                    sx={{
                      display: "flex",
                      flexDirection: "column",
                      alignItems: "center",
                      textAlign: "center",
                      gap: 2,
                      fontSize: { xs: "12px", md: "15px", lg: "18px" },
                    }}
                  >
                    {/* Display user's photo in a circle */}
                    {/*<Box
                                       component="img"
                                       // src={
                                       //   "https://drive.google.com/thumbnail?id=1cPyIpmPL-n24bhuBv7XPzP2hXmS5E7FD&sz=w1000"
                                       // }
                                       src={"./studentEmoji.png"}
                                       alt={selectedLoan?.name}
                                       sx={{
                                         width: { xs: 60, sm: 100 },
                                         height: { xs: 60, sm: 100 },
                                         borderRadius: "50%",
                                         objectFit: "cover",
                                       }}
                                     />*/}

                    {/* Display user details */}

                    <Typography
                      variant="body1"
                      sx={{
                        width: "100%",
                        fontSize: { xs: "12px", md: "15px", lg: "18px" },
                      }}
                    >
                      <strong>User Code:</strong> {selectedLoan?.loanId ?? "-"}
                    </Typography>

                    <Typography
                      variant="body1"
                      xs={12}
                      sx={{
                        fontSize: { xs: "12px", md: "15px", lg: "18px" },
                      }}
                    >
                      <strong>Full Name:</strong>{" "}
                      {selectedLoan?.fullName ?? "-"}
                    </Typography>
                    <Typography
                      variant="body1"
                      sx={{
                        width: "100%",
                        fontSize: { xs: "12px", md: "15px", lg: "18px" },
                      }}
                    >
                      <strong>Status:</strong> {selectedLoan?.status ?? "-"}
                    </Typography>

                    <Typography
                      variant="body1"
                      sx={{
                        fontSize: { xs: "12px", md: "15px", lg: "18px" },
                      }}
                    >
                      <strong> Branch code:</strong>{" "}
                      {selectedLoan?.branchCode ?? "-"}
                    </Typography>
                    <Typography variant="body1">
                      <strong>Father:</strong> {selectedLoan?.careOf}
                    </Typography>
                    <Typography variant="body1">
                      <strong>Branch:</strong> {selectedLoan?.branchCode}
                    </Typography>
                    <Typography variant="body1">
                      <strong>RefferedBY:</strong> {selectedLoan?.refferedBY}
                    </Typography>

                    <Typography variant="body1">
                      <strong>Email:</strong> {selectedLoan.email}
                    </Typography>
                    <Typography
                      variant="body1"
                      sx={{
                        fontSize: { xs: "12px", md: "15px", lg: "18px" },
                      }}
                    >
                      <strong>Mobile:</strong> {selectedLoan?.mobile ?? "-"}
                    </Typography>
                    <Typography
                      variant="body1"
                      sx={{
                        fontSize: { xs: "12px", md: "15px", lg: "18px" },
                      }}
                    >
                      <strong>Address:</strong> {selectedLoan?.address ?? "-"}
                    </Typography>
                    <Typography
                      variant="body1"
                      sx={{
                        fontSize: { xs: "12px", md: "15px", lg: "18px" },
                      }}
                    >
                      <strong>Pincode:</strong> {selectedLoan?.pincode ?? "-"}
                    </Typography>
                    <Typography
                      variant="body1"
                      sx={{
                        width: "100%",
                        fontSize: { xs: "12px", md: "15px", lg: "18px" },
                      }}
                    >
                      <strong>loanDetails:</strong>{" "}
                      {JSON.stringify(selectedLoan?.loanDetails) ?? "-"}
                    </Typography>
                    <Typography
                      variant="body1"
                      sx={{
                        width: "100%",
                        fontSize: { xs: "12px", md: "15px", lg: "18px" },
                      }}
                    >
                      <strong>payDetails:</strong>{" "}
                      {JSON.stringify(selectedLoan?.payDetails) ?? "-"}
                    </Typography>

                    {/* <Box>
                                 <Button variant="outlined">Edit</Button>
                               </Box> */}
                  </Box>
                </Box>
              </Dialog>
            )}
          </div>
        );
      };
      const ApplyLoan = () => {
        // way for single

        const [file, setFile] = useState(null);
        const [url, setUrl] = useState("");

        const handleFileChange = (e) => {
          setFile(e.target.files[0]);
        };

        // way for multiple
        const [files, setFiles] = useState([]);
        const [uploadedFiles, setUploadedFiles] = useState([]);

        const handleFileChange3 = (e) => {
          setFiles(Array.from(e.target.files));
        };

        // original

        const [eligibilityDetails, setEligibilityDetails] =
          React.useState(null);
        const [openEligibilityModal, setOpenEligibilityModal] =
          React.useState(false);

        const checkEligibility = (loan) => {
          // Example calculation logic for eligibility
          const eligibleAmount = loan.loanRequirement * 0.4; // 80% of the loan amount
          const interestRate = 11.75; // Example interest rate
          const durationMonths = 24; // Example duration in months

          setEligibilityDetails({
            amount: eligibleAmount,
            rate: interestRate,
            duration: durationMonths,
            minLoanAmount: eligibleAmount * 0.75,
            maxLoanAmount: eligibleAmount * 1.25,
          });
          setOpenEligibilityModal(true);
        };

        const allTypesOfLoans = [
          "Personal Loan",
          "Secured Loan",
          "Unsecured Loan",
        ];
        const [loanType, setLoanType] = React.useState(allTypesOfLoans[0]);

        const steps = ["Basic", "Work", "Docs", "Preview"];
        const [step, setStep] = React.useState(0);
        const [activeStep, setActiveStep] = React.useState(0);

        const [loan, setLoan] = React.useState({}); //main
        const [loanFiles, setLoanFiles] = React.useState({}); //main
        const [errors, setErrors] = React.useState({});

        const handleBack = () => {
          setActiveStep((prevActiveStep) => prevActiveStep - 1);
        };

        const handleNext = () => {
          // let newSkipped = skipped;
          // if (isStepSkipped(activeStep)) {
          //   newSkipped = new Set(newSkipped.values());
          //   newSkipped.delete(activeStep);
          // }

          setActiveStep((prevActiveStep) => prevActiveStep + 1);
          // setSkipped(newSkipped);
        };

        const handleLoanSubmit = (loan) => {
          console.log("loan", loan);
          axios
            .post(`${baseURL}/add-new-gn-loan`, {
              userId: JSON.parse(localStorage.getItem("gnUserObj"))?.userId,
              loanType,
              userobj: JSON.parse(localStorage.getItem("gnUserObj")),
              ...loan,
            })

            .then((res) => {
              alert("Loan successfully applied");
              window.location.reload();
            })
            .catch((error) => {
              alert(error.message);
              console.log("Error occurred:", error);
            });
        };

        const handleChange = (event) => {
          const { name, value } = event.target;
          setLoan({
            ...loan,
            [name]: value,
          });

          // validateField(name, value); // validate each field on change
        };

        return (
          <Box sx={{ width: "100%" }}>
            <Box>
              <FormControl fullWidth margin="normal">
                <InputLabel>Select Type of Loan</InputLabel>
                <Select
                  label="Select Type of Loan"
                  name="loanType"
                  value={loanType}
                  onChange={(e) => {
                    setLoanType(e.target.value);
                    setLoan({});
                  }}
                  disabled={activeStep != 0}
                >
                  {allTypesOfLoans.map((type, index) => (
                    <MenuItem key={index} value={type}>
                      {type}
                    </MenuItem>
                  ))}
                </Select>
              </FormControl>
            </Box>

            {loanType == "Personal Loan" && (
              <div>
                <Box>
                  <Stepper activeStep={activeStep} alternativeLabel>
                    {steps.map((label) => (
                      <Step key={label}>
                        <StepLabel>{label}</StepLabel>
                      </Step>
                    ))}
                  </Stepper>
                </Box>
                <Box
                  sx={{
                    mt: 1,
                    display: "flex",
                    flexDirection: "row",
                    justifyContent: "space-between",
                  }}
                >
                  <Button
                    size="small"
                    color="inherit"
                    disabled={activeStep === 0}
                    onClick={handleBack}
                    variant="outlined"
                    sx={{ mr: 1 }}
                  >
                    Back
                  </Button>
                  <Button
                    size="small"
                    onClick={() => {
                      if (activeStep === steps.length - 1) {
                        handleLoanSubmit(loan);
                      } else {
                        handleNext();
                      }
                    }}
                    variant="outlined"
                    // disabled={activeStep === steps.length - 1}
                  >
                    {activeStep === steps.length - 1
                      ? "Check & Submit"
                      : "Next"}
                  </Button>
                </Box>
                <Box
                  sx={{
                    mt: 1,
                  }}
                >
                  {activeStep === 0 && (
                    <Box>
                      {/* Full Name */}
                      <TextField
                        size="small"
                        label="Full Name as per Adhaar"
                        placeholder="Enter Full Name as per Adhaar"
                        name="fullName"
                        value={loan.fullName}
                        onChange={handleChange}
                        fullWidth
                        margin="normal"
                        error={Boolean(errors.fullName)}
                        helperText={errors.fullName}
                      />

                      {/* Care Of Person
                                 <TextField
                                   size="small"
                                   label="Care Of Person"
                                   name="careOf"
                                   value={loan.careOf}
                                   onChange={handleChange}
                                   fullWidth
                                   margin="normal"
                                   error={Boolean(errors.careOf)}
                                   helperText={errors.careOf}
                                 /> */}

                      {/* Mobile */}
                      <TextField
                        size="small"
                        label="Mobile"
                        name="mobile"
                        value={loan.mobile}
                        onChange={handleChange}
                        fullWidth
                        margin="normal"
                        error={Boolean(errors.mobile)}
                        helperText={errors.mobile}
                      />

                      {/* Email */}
                      <TextField
                        size="small"
                        label="Email"
                        name="email"
                        type="email"
                        value={loan.email}
                        onChange={handleChange}
                        fullWidth
                        margin="normal"
                        error={Boolean(errors.email)}
                        helperText={errors.email}
                      />
                      {/* Email */}
                      <TextField
                        size="small"
                        label="House Number"
                        name="Hno"
                        type="text"
                        value={loan.Hno}
                        onChange={handleChange}
                        fullWidth
                        margin="normal"
                        error={Boolean(errors.Hno)}
                        helperText={errors.Hno}
                      />

                      {/* Address */}
                      <TextField
                        size="small"
                        label="Address"
                        name="address"
                        value={loan.address}
                        onChange={handleChange}
                        fullWidth
                        margin="normal"
                        error={Boolean(errors.address)}
                        helperText={errors.address}
                      />

                      {/* Pincode */}
                      <TextField
                        size="small"
                        label="Pincode"
                        name="pincode"
                        value={loan.pincode}
                        onChange={handleChange}
                        fullWidth
                        margin="normal"
                        error={Boolean(errors.pincode)}
                        helperText={errors.pincode}
                      />

                      {/* Marital Status
                                 <FormControl fullWidth margin="normal">
                                   <InputLabel>Marital Status</InputLabel>
                                   <Select
                                     label="Marital Status"
                                     name="maritalStatus"
                                     value={loan.maritalStatus}
                                     onChange={handleChange}
                                   >
                                     <MenuItem value="Married">Married</MenuItem>
                                     <MenuItem value="Single">Single</MenuItem>
                                     <MenuItem value="Divorced">Divorced</MenuItem>
                                   </Select>
                                 </FormControl>*/}

                      {/* Gender Selection
                                 <FormControl fullWidth margin="normal">
                                   <InputLabel>Gender</InputLabel>
                                   <Select
                                     label="Gender"
                                     name="gender"
                                     value={loan.gender}
                                     onChange={handleChange}
                                   >
                                     <MenuItem value="Male">Male</MenuItem>
                                     <MenuItem value="Female">Female</MenuItem>
                                   </Select>
                                 </FormControl>*/}

                      {/* Adhaar Number */}
                      <TextField
                        size="small"
                        label="Adhaar Number"
                        name="adhaarNumber"
                        value={loan.adhaarNumber}
                        onChange={handleChange}
                        fullWidth
                        margin="normal"
                        error={Boolean(errors.adhaarNumber)}
                        helperText={errors.adhaarNumber}
                      />
                      {/* PAN Number */}
                      <TextField
                        size="small"
                        label="PAN Number"
                        name="panNumber"
                        value={loan.panNumber}
                        onChange={handleChange}
                        fullWidth
                        margin="normal"
                        error={Boolean(errors.panNumber)}
                        helperText={errors.panNumber}
                      />
                      {/* cbill Score */}
                      <TextField
                        size="small"
                        label="cbill Score"
                        name="cbillScore"
                        value={loan.cbillScore}
                        onChange={handleChange}
                        fullWidth
                        margin="normal"
                        error={Boolean(errors.cbillScore)}
                        helperText={errors.cbillScore}
                      />
                      {/* YOur Monthly Income */}
                      <TextField
                        size="small"
                        label="Your Monthly Income"
                        name="yourMOnthlyIncome"
                        value={loan.yourMOnthlyIncome}
                        onChange={handleChange}
                        fullWidth
                        margin="normal"
                        error={Boolean(errors.yourMOnthlyIncome)}
                        helperText={errors.yourMOnthlyIncome}
                      />
                      {/* Monthly existing emi amount */}
                      <TextField
                        size="small"
                        label="Monthly existing emi amount"
                        name="monthlExistingEmiAmount"
                        value={loan.monthlExistingEmiAmount}
                        onChange={handleChange}
                        fullWidth
                        margin="normal"
                        error={Boolean(errors.monthlExistingEmiAmount)}
                        helperText={errors.monthlExistingEmiAmount}
                      />
                      {/* Loan Requirement */}
                      <TextField
                        size="small"
                        label="Loan Requirement"
                        name="loanRequirement"
                        value={loan.loanRequirement}
                        onChange={handleChange}
                        fullWidth
                        margin="normal"
                        error={Boolean(errors.loanRequirement)}
                        helperText={errors.loanRequirement}
                      />

                      <Button
                        size="small"
                        fullWidth
                        onClick={handleNext}
                        variant="contained"
                        // disabled={activeStep === steps.length - 1}
                      >
                        Next
                      </Button>
                    </Box>
                  )}
                  {activeStep === 1 && (
                    <Box>
                      {/* Type of Employment */}
                      <FormControl fullWidth margin="normal">
                        <InputLabel>Type of Employment</InputLabel>
                        <Select
                          label="Type of Employment"
                          name="typeOfEmployment"
                          value={loan.typeOfEmployment}
                          onChange={handleChange}
                        >
                          <MenuItem value="Private">Private</MenuItem>
                          <MenuItem value="Government">Government</MenuItem>
                          <MenuItem value="Self-Employed">
                            Self-Employed
                          </MenuItem>
                          <MenuItem value="Unemployed">Unemployed</MenuItem>
                        </Select>
                      </FormControl>

                      {/* Company Name */}
                      <TextField
                        size="small"
                        label="Company Name"
                        name="companyName"
                        value={loan.companyName}
                        onChange={handleChange}
                        fullWidth
                        margin="normal"
                      />

                      {/* Years of Experience in Months */}
                      <TextField
                        size="small"
                        label="Years of Experience (Months)"
                        name="yearsOfExperience"
                        value={loan.yearsOfExperience}
                        onChange={handleChange}
                        fullWidth
                        margin="normal"
                        type="number"
                      />

                      {/* Monthly in Hand Salary */}
                      <TextField
                        size="small"
                        label="Monthly in Hand Salary"
                        name="monthlySalary"
                        value={loan.monthlySalary}
                        onChange={handleChange}
                        fullWidth
                        margin="normal"
                        type="number"
                      />

                      {/* Company Address */}
                      <TextField
                        size="small"
                        label="Company Address"
                        name="companyAddress"
                        value={loan.companyAddress}
                        onChange={handleChange}
                        fullWidth
                        margin="normal"
                      />

                      {/* Company Pincode */}
                      <TextField
                        size="small"
                        label="Company Pincode"
                        name="companyPincode"
                        value={loan.companyPincode}
                        onChange={handleChange}
                        fullWidth
                        margin="normal"
                      />

                      {/* Mode of Salary Payment */}
                      <FormControl fullWidth margin="normal">
                        <InputLabel>Mode of Salary Payment</InputLabel>
                        <Select
                          label="Mode of Salary Payment"
                          name="modeOfSalary"
                          value={loan.modeOfSalary}
                          onChange={handleChange}
                        >
                          <MenuItem value="Bank">Bank</MenuItem>
                          <MenuItem value="Cash">Cash</MenuItem>
                          <MenuItem value="Cheque">Cheque</MenuItem>
                        </Select>
                      </FormControl>

                      <Button
                        size="small"
                        fullWidth
                        onClick={handleNext}
                        variant="contained"
                        // disabled={activeStep === steps.length - 1}
                      >
                        Next
                      </Button>
                    </Box>
                  )}
                  {activeStep === 2 && (
                    <Box>
                      <Typography variant="h6" gutterBottom>
                        Upload Documents
                      </Typography>

                      <hr />
                      {/*
                            <input
                              accept="*"
                              name="photo"
                              style={{ display: "none" }}
                              id="upload-file-photo"
                              type="file"
                              onChange={handleChangeFiles}
                            />
                            <label htmlFor="upload-file-photo">
                              <Button variant="contained" component="span">
                                Upload Photo
                              </Button>
                            </label>

                            <Box sx={{ mt: 2 }}>

                              {loanFiles["photo"] && (
                                <>
                                  {loanFiles["photo"].type === "image" && (
                                    <img
                                      src={loanFiles["photo"].data}
                                      alt="Photo"
                                      style={{ maxWidth: "200px", height: "auto" }}
                                    />
                                  )}
                                  {loanFiles["photo"].type === "pdf" && (
                                    <iframe
                                      src={loanFiles["photo"].data}
                                      title="Photo"
                                      width="200px"
                                      height="300px"
                                    />
                                  )}
                                </>
                              )}
                            </Box>
                            {console.log("loanFiles", loanFiles)}

                            {loanFiles.photo && <hr />}

                            <input
                              accept="*"
                              name="Aadhar"
                              style={{ display: "none" }}
                              id="upload-file-aadhar"
                              type="file"
                              onChange={handleChangeFiles}
                            />
                            <label htmlFor="upload-file-aadhar">
                              <Button variant="contained" component="span">
                                Upload Aadhar
                              </Button>
                            </label>

                            <Box sx={{ mt: 2 }}>

                              {loanFiles["Aadhar"] && (
                                <>
                                  {loanFiles["Aadhar"]?.type === "image" && (
                                    <img
                                      src={loanFiles["Aadhar"]?.data}
                                      alt="Aadhar"
                                      style={{ maxWidth: "200px", height: "auto" }}
                                    />
                                  )}
                                  {loanFiles["Aadhar"]?.type === "pdf" && (
                                    <iframe
                                      src={loanFiles["Aadhar"].data}
                                      title="PDF Preview"
                                      width="200px"
                                      height="300px"
                                    />
                                  )}
                                </>
                              )}
                            </Box>

                            {loanFiles.Aadhar && <hr />}

                            <input
                              accept="*"
                              name="PAN"
                              style={{ display: "none" }}
                              id="upload-file-PAN"
                              type="file"
                              onChange={handleChangeFiles}
                            />
                            <label htmlFor="upload-file-PAN">
                              <Button variant="contained" component="span">
                                Upload PAN
                              </Button>
                            </label>

                            <Box sx={{ mt: 2 }}>


                              {loanFiles["PAN"] && (
                                <>
                                  {loanFiles["PAN"]?.type === "image" && (
                                    <img
                                      src={loanFiles["PAN"]?.data}
                                      alt="PAN"
                                      style={{ maxWidth: "200px", height: "auto" }}
                                    />
                                  )}
                                  {loanFiles["PAN"]?.type === "pdf" && (
                                    <iframe
                                      src={loanFiles["PAN"]?.data}
                                      title="PAN"
                                      width="200px"
                                      height="300px"
                                    />
                                  )}
                                </>
                              )}
                            </Box>

                            {loanFiles.PAN && <hr />}

      */}

                      <input
                        accept="*"
                        name="photo"
                        style={{ display: "none" }}
                        id="upload-file-photo"
                        type="file"
                        // onChange={handleChangeFiles}
                        onChange={async (e) => {
                          const file = e.target.files[0];

                          // Create a FormData instance to send the file to the backend
                          const formData = new FormData();
                          formData.append("file", file);

                          try {
                            // Send the file to the backend API
                            const response = await axios.post(
                              baseURL + "/upload",
                              formData,
                              {
                                headers: {
                                  "Content-Type": "multipart/form-data",
                                },
                              }
                            );
                            console.log(
                              "File uploaded successfully",
                              response.data
                            );
                            setLoan({
                              ...loan,
                              photo: response.data?.url ?? "",
                            });
                          } catch (error) {
                            console.error("Error uploading file", error);
                          }
                        }}
                      />
                      <label htmlFor="upload-file-photo">
                        <Button variant="contained" component="span">
                          Upload photo
                        </Button>
                      </label>

                      <Box sx={{ mt: 2 }}>
                        {loan?.photo && (
                          <img
                            src={loan?.photo}
                            alt="Photo"
                            width="200px"
                            height="300px"
                            style={{ objectFit: "cover" }}
                          />
                        )}
                      </Box>

                      {loan?.photo && <hr />}

                      <input
                        accept="*"
                        name="aadhar"
                        style={{ display: "none" }}
                        id="upload-file-aadhar"
                        type="file"
                        // onChange={handleChangeFiles}
                        onChange={async (e) => {
                          const file = e.target.files[0];

                          // Create a FormData instance to send the file to the backend
                          const formData = new FormData();
                          formData.append("file", file);

                          try {
                            // Send the file to the backend API
                            const response = await axios.post(
                              baseURL + "/upload",
                              formData,
                              {
                                headers: {
                                  "Content-Type": "multipart/form-data",
                                },
                              }
                            );
                            console.log(
                              "File uploaded successfully",
                              response.data
                            );
                            setLoan({
                              ...loan,
                              aadhar: response.data?.url ?? "",
                            });
                          } catch (error) {
                            console.error("Error uploading file", error);
                          }
                        }}
                      />
                      <label htmlFor="upload-file-aadhar">
                        <Button variant="contained" component="span">
                          Upload aadhar
                        </Button>
                      </label>

                      <Box sx={{ mt: 2 }}>
                        {loan?.aadhar && (
                          <img
                            src={loan?.aadhar}
                            alt="Aadhar"
                            width="200px"
                            height="300px"
                            style={{ objectFit: "cover" }}
                          />
                        )}
                      </Box>

                      {loan?.aadhar && <hr />}

                      <input
                        accept="*"
                        name="pan"
                        style={{ display: "none" }}
                        id="upload-file-pan"
                        type="file"
                        // onChange={handleChangeFiles}
                        onChange={async (e) => {
                          const file = e.target.files[0];

                          // Create a FormData instance to send the file to the backend
                          const formData = new FormData();
                          formData.append("file", file);

                          try {
                            // Send the file to the backend API
                            const response = await axios.post(
                              baseURL + "/upload",
                              formData,
                              {
                                headers: {
                                  "Content-Type": "multipart/form-data",
                                },
                              }
                            );
                            console.log(
                              "File uploaded successfully",
                              response.data
                            );
                            setLoan({
                              ...loan,
                              pan: response.data?.url ?? "",
                            });
                          } catch (error) {
                            console.error("Error uploading file", error);
                          }
                        }}
                      />
                      <label htmlFor="upload-file-pan">
                        <Button variant="contained" component="span">
                          Upload PAN
                        </Button>
                      </label>

                      <Box sx={{ mt: 2 }}>
                        {loan?.pan && (
                          <img
                            src={loan?.pan}
                            alt="PAN"
                            width="200px"
                            height="300px"
                            style={{ objectFit: "cover" }}
                          />
                        )}
                      </Box>

                      {loan?.pan && <hr />}

                      <input
                        accept="*"
                        name="paySlips"
                        style={{ display: "none" }}
                        id="upload-file-paySlips"
                        type="file"
                        // onChange={handleChangeFiles}
                        onChange={async (e) => {
                          const file = e.target.files[0];

                          // Create a FormData instance to send the file to the backend
                          const formData = new FormData();
                          formData.append("file", file);

                          try {
                            // Send the file to the backend API
                            const response = await axios.post(
                              baseURL + "/upload",
                              formData,
                              {
                                headers: {
                                  "Content-Type": "multipart/form-data",
                                },
                              }
                            );
                            console.log(
                              "File uploaded successfully",
                              response.data
                            );
                            setLoan({
                              ...loan,
                              paySlip: response.data?.url ?? "",
                            });
                          } catch (error) {
                            console.error("Error uploading file", error);
                          }
                        }}
                      />
                      <label htmlFor="upload-file-paySlips">
                        <Button variant="contained" component="span">
                          Upload PaySlip
                        </Button>
                      </label>

                      <Box sx={{ mt: 2 }}>
                        {loan?.paySlip && (
                          <iframe
                            src={`https://docs.google.com/gview?url=${loan?.paySlip}&embedded=true`}
                            width="200px"
                            height="300px"
                            frameborder="0"
                          ></iframe>
                        )}
                      </Box>

                      {loan?.paySlip && <hr />}

                      <input
                        accept="*"
                        name="bankStatement"
                        style={{ display: "none" }}
                        id="upload-file-bankStatement"
                        type="file"
                        // onChange={handleChangeFiles}
                        onChange={async (e) => {
                          const file = e.target.files[0];

                          // Create a FormData instance to send the file to the backend
                          const formData = new FormData();
                          formData.append("file", file);

                          try {
                            // Send the file to the backend API
                            const response = await axios.post(
                              baseURL + "/upload",
                              formData,
                              {
                                headers: {
                                  "Content-Type": "multipart/form-data",
                                },
                              }
                            );
                            console.log(
                              "File uploaded successfully",
                              response.data
                            );
                            setLoan({
                              ...loan,
                              bankStatement: response.data?.url ?? "",
                            });
                          } catch (error) {
                            console.error("Error uploading file", error);
                          }
                        }}
                      />
                      <label htmlFor="upload-file-bankStatement">
                        <Button variant="contained" component="span">
                          Upload bankStatement
                        </Button>
                      </label>

                      <Box sx={{ mt: 2 }}>
                        {loan?.bankStatement && (
                          <iframe
                            src={`https://docs.google.com/gview?url=${loan?.bankStatement}&embedded=true`}
                            width="200px"
                            height="300px"
                            frameborder="0"
                          ></iframe>
                        )}
                      </Box>

                      {loan.bankStatement && <hr />}

                      <Button
                        size="small"
                        fullWidth
                        onClick={() => {
                          handleNext();
                        }}
                        variant="contained"
                        // disabled={activeStep === steps.length - 1}
                      >
                        Next
                      </Button>
                    </Box>
                  )}
                  {activeStep === 3 && (
                    <Box>
                      <Card>
                        <CardContent>
                          <Typography variant="h6">Loan Preview</Typography>

                          <Typography>
                            <strong>fullName:</strong> {loan.fullName}
                          </Typography>
                          <Typography>
                            <strong>mobile:</strong> {loan.mobile}
                          </Typography>
                          <Typography>
                            <strong>email:</strong> {loan.email}
                          </Typography>
                          <Typography>
                            <strong>Hno:</strong> {loan.Hno}
                          </Typography>
                          <Typography>
                            <strong>address:</strong> {loan.address}
                          </Typography>
                          <Typography>
                            <strong>pincode:</strong> {loan.pincode}
                          </Typography>
                          <Typography>
                            <strong>adhaarNumber:</strong> {loan.adhaarNumber}
                          </Typography>
                          <Typography>
                            <strong>panNumber:</strong> {loan.panNumber}
                          </Typography>
                          <Typography>
                            <strong>cbillScore:</strong> {loan.cbillScore}
                          </Typography>
                          <Typography>
                            <strong>yourMOnthlyIncome:</strong>{" "}
                            {loan.yourMOnthlyIncome}
                          </Typography>
                          <Typography>
                            <strong>monthlExistingEmiAmount:</strong>{" "}
                            {loan.monthlExistingEmiAmount}
                          </Typography>
                          <Typography>
                            <strong>loanRequirement:</strong>{" "}
                            {loan.loanRequirement}
                          </Typography>
                          <Typography>
                            <strong>typeOfEmployment:</strong>{" "}
                            {loan.typeOfEmployment}
                          </Typography>
                          <Typography>
                            <strong>companyName:</strong> {loan.companyName}{" "}
                          </Typography>
                          <Typography>
                            <strong>yearsOfExperience:</strong>{" "}
                            {loan.yearsOfExperience}
                          </Typography>
                          <Typography>
                            <strong>monthlySalary:</strong> {loan.monthlySalary}{" "}
                          </Typography>
                          <Typography>
                            <strong>companyAddress:</strong>{" "}
                            {loan.companyAddress}
                          </Typography>
                          <Typography>
                            <strong>companyPincode:</strong>{" "}
                            {loan.companyPincode}
                          </Typography>
                          <Typography>
                            <strong>Mode of Salary Payment:</strong>{" "}
                            {loan.modeOfSalary}
                          </Typography>

                          {/*} <Typography>
                                  <strong>Income Proof:</strong>
                                  <a href={loan.pan} target="_blank" rel="noreferrer">
                                    {" "}
                                    View pan
                                  </a>
                                </Typography>*/}
                          <Typography>
                            <strong>Photo :</strong>
                            <Box sx={{ mt: 2 }}>
                              {loan?.photo && (
                                <img
                                  src={loan?.photo}
                                  alt="PAN"
                                  width="200px"
                                  height="300px"
                                  style={{ objectFit: "cover" }}
                                />
                              )}
                            </Box>
                          </Typography>
                          <Typography>
                            <strong>Aadhar Card:</strong>
                            <Box sx={{ mt: 2 }}>
                              {loan?.aadhar && (
                                <img
                                  src={loan?.aadhar}
                                  alt="PAN"
                                  width="200px"
                                  height="300px"
                                  style={{ objectFit: "cover" }}
                                />
                              )}
                            </Box>
                          </Typography>
                          <Typography>
                            <strong>PAN card:</strong>
                            <Box sx={{ mt: 2 }}>
                              {loan?.pan && (
                                <img
                                  src={loan?.pan}
                                  alt="PAN"
                                  width="200px"
                                  height="300px"
                                  style={{ objectFit: "cover" }}
                                />
                              )}
                            </Box>
                          </Typography>
                          <Typography>
                            <strong>PaySlip :</strong>
                            <Box sx={{ mt: 2 }}>
                              {loan?.paySlip && (
                                <iframe
                                  src={`https://docs.google.com/gview?url=${loan?.paySlip}&embedded=true`}
                                  width="200px"
                                  height="300px"
                                  frameborder="0"
                                ></iframe>
                              )}
                            </Box>
                          </Typography>
                          <Typography>
                            <strong>bank Statement :</strong>
                            <Box sx={{ mt: 2 }}>
                              {loan?.bankStatement && (
                                <iframe
                                  src={`https://docs.google.com/gview?url=${loan?.bankStatement}&embedded=true`}
                                  width="200px"
                                  height="300px"
                                  frameborder="0"
                                ></iframe>
                              )}
                            </Box>
                          </Typography>
                        </CardContent>
                      </Card>
                    </Box>
                  )}
                </Box>

                {/* // Modal for Eligibility Details*/}
                {openEligibilityModal && eligibilityDetails && (
                  <Dialog
                    open={openEligibilityModal}
                    onClose={() => setOpenEligibilityModal(false)}
                    fullWidth
                    maxWidth="sm"
                  >
                    <DialogTitle>Eligibility Details</DialogTitle>
                    <DialogContent>
                      <Typography variant="body1">
                        Eligible Loan Amount: {eligibilityDetails.amount}
                      </Typography>

                      <Slider
                        value={eligibilityDetails?.amount}
                        onChange={(e, newValue) =>
                          setEligibilityDetails({
                            ...eligibilityDetails,
                            amount: newValue,
                          })
                        }
                        aria-labelledby="amount-slider"
                        min={eligibilityDetails?.minLoanAmount}
                        max={eligibilityDetails?.maxLoanAmount}
                        step={100}
                        valueLabelDisplay="auto"
                      />

                      <Typography variant="body1">
                        Rate of Interest: {eligibilityDetails.rate}%
                      </Typography>

                      <Typography variant="body1">
                        Duration: {eligibilityDetails.duration} months
                      </Typography>
                      <Slider
                        value={eligibilityDetails.duration}
                        onChange={(e, newValue) =>
                          setEligibilityDetails({
                            ...eligibilityDetails,
                            duration: newValue,
                          })
                        }
                        aria-labelledby="duration-slider"
                        min={6}
                        max={60}
                        step={6}
                        valueLabelDisplay="auto"
                      />
                      <Typography variant="body1">
                        Monthly EMI: 
                        {Math.round(
                          eligibilityDetails.amount /
                            eligibilityDetails.duration
                        )}
                      </Typography>
                    </DialogContent>
                    <DialogActions>
                      <Button
                        onClick={() => setOpenEligibilityModal(false)}
                        color="primary"
                      >
                        Close
                      </Button>
                      <Button
                        variant="outlined"
                        onClick={() => {
                          setOpenEligibilityModal(false);
                          handleNext();
                        }}
                        color="primary"
                      >
                        Accept
                      </Button>
                    </DialogActions>
                  </Dialog>
                )}
              </div>
            )}
            {loanType == "Secured Loans" && (
              <div>Secured loans Under development</div>
            )}
            {loanType == "Unsecured Loans" && (
              <div>Unsecured loans Under development</div>
            )}
          </Box>
        );
      };

      const Branches = () => {
        const [addMemberModal, setAddMemberModal] = useState(false);
        const [nonBranchTaggedMembers, setNonBranchTaggedMembers] = useState([]);
        const [branchMembers, setBranchMembers] = useState([]);
        const [selectednonBranchTaggedMember, setSelectednonBranchTaggedMember] = useState(null);
        const [checked, setChecked] = useState(false);
        const [submitted, setSubmitted] = useState(true);
        const [familyMembers, setFamilyMembers] = useState(0);
        const [listData, setListData] = useState([]);
        const [showList, setShowList] = useState(true);
        const [loading, setLoading] = useState(false);
        const [selectedStudent, setSelectedStudent] = React.useState(null);
        // const [newUserModal, setNewUserModal] = React.useState(false);
        const [openStudentDetailsModal, setOpenStudentDetailsModal] =
          React.useState(false);
        const [openBranchDetailsModal, setOpenBranchDetailsModal] =
          React.useState(false);
        const [selectedBranch, setSelectedBranch] =
          React.useState(null);
        const [openNewBranchModal, setOpenNewBranchModal] =
          React.useState(false);

        const [branch, setBranch] = useState({});

        const [errors, setErrors] = useState({});

        const validateField = (name, value) => {
          console.log("name, value", name, value);
          const newErrors = { ...errors };

          switch (name) {
            case "name":
              if (!value) newErrors.userId = "Name is required.";
              else delete newErrors.userId;
              break;

            case "address":
              if (!value) newErrors.address = "address is required.";
              else delete newErrors.address;
              break;
            case "pincode":
              if (!value) newErrors.pincode = "pincode is required.";
              else delete newErrors.pincode;
              break;
            case "location":
              if (!value) newErrors.location = "location is required.";
              else delete newErrors.location;
              break;
            case "status":
              if (!value) newErrors.status = "status is required.";
              else delete newErrors.status;
              break;

            default:
              break;
          }

          console.log("newErrorslast", newErrors);

          setErrors(newErrors);
        };

        const handleChange = (event) => {
          const { name, value } = event.target;
          setBranch({
            ...branch,
            [name]: value,
          });

          validateField(name, value); // validate each field on change
        };

        const handleNewBranchSubmit = (event) => {
          event.preventDefault();

          console.log("branch", branch.name);

          if (
            !branch.name ||
            !branch.address ||
            !branch.pincode ||
            !branch.status ||
            !branch.location
          ) {
            return alert("some fields are missing");
          }
          console.log("errors", errors);
          try {
            if (
              Object.keys(errors).length === 0
              // &&
              // Object.values(user).every((val) => val !== "")
            ) {
              axios
                .post(`${baseURL}/add-new-gn-branch`, {
                  name: branch.name,
                  address: branch.address,
                  pincode: branch.pincode,
                  location: branch.location,
                  status: branch.status,
                  image: "URL",
                })

                .then((res) => {
                  fetchBranches();
                })
                .catch((error) => {
                  alert(error.message);
                  console.log("Error occurred:", error);
                });

              setOpenNewBranchModal(false);
            } else {
              alert("some fileds missing");
            }
          } catch (err) {
            console.log("err", err);
          }
          // Final validation before submission
        };

        const fetchBranches = () => {
          fetch(`${baseURL}/get-all-branches`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            credentials: "include",
            body: JSON.stringify({}),
          })
            .then((response) => response.json()) // Parse the JSON
            .then((data) => {
              setListData(data);
              setLoading(false);
            })
            .catch((error) => {
              console.error("Error loading JSON:", error);
              setLoading(false);
            });
        };
        const getNonBranchTaggedMembers = () => {
          fetch(`${baseURL}/getNonBranchTaggedMembers`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              goldnoontoken: localStorage.getItem("goldnoontoken"),
            },
            credentials: "include",
            body: JSON.stringify({}),
          })
            .then((response) => response.json()) // Parse the JSON
            .then((data) => {
              setNonBranchTaggedMembers(data);
              setLoading(false);
            })
            .catch((error) => {
              console.error("Error loading JSON:", error);
              setLoading(false);
            });
        };
        const getBranchMembers = (branchCode) => {
          fetch(`${baseURL}/getBranchMembers`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              goldnoontoken: localStorage.getItem("goldnoontoken"),
            },
            credentials: "include",
            body: JSON.stringify({branchCode}),
          })
            .then((response) => response.json()) // Parse the JSON
            .then((data) => {
              setBranchMembers(data);
              setLoading(false);
            })
            .catch((error) => {
              console.error("Error loading JSON:", error);
              setLoading(false);
            });
        };
        const updateMemberBranch = (userId, branchCode) => {
          console.log('userId to Update, branchCode', userId, branchCode)
          fetch(`${baseURL}/updateMemberBranch`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              goldnoontoken: localStorage.getItem("goldnoontoken"),
            },
            credentials: "include",
            body: JSON.stringify({ userId, branchCode}),
          })
            .then((response) => response) // Parse the JSON
            .then((data) => {
              setAddMemberModal(false)
              setOpenBranchDetailsModal(false);
              alert('Branch tagged successfully')

            })
            .catch((error) => {
              // console.error("Error loading JSON:", error);
              alert('Error during tagging branch')

            });
        };
        const untagMemberBranch = (userId) => {
          console.log('userId to untag', userId,)
          fetch(`${baseURL}/untagMemberBranch`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              goldnoontoken: localStorage.getItem("goldnoontoken"),
            },
            credentials: "include",
            body: JSON.stringify({ userId}),
          })
            .then((response) => response) // Parse the JSON
            .then((data) => {
              setOpenBranchDetailsModal(false);
              alert('Member Branch untagged successfully')

            })
            .catch((error) => {
              // console.error("Error loading JSON:", error);
              alert('Error during untagging branch')

            });
        };

        useEffect(() => {
          setLoading(true);
          try {
            fetchBranches();
          } catch (er) {
            setLoading(false);
            console.log("er", er);
          }
        }, []);

        return (
          <div
            style={{
              overflowX: "scroll",
            }}
          >
            {loading ? (
              <div className="loader-container">
                <div className="loader"></div>
              </div>
            ) : showList && (
              <div className="form-container">
                <Box sx={{ p: 0, m: 0, width: "100%" }} className="box">
                  <Box
                    sx={{
                      display: "flex",
                      justifyContent: "space-between",
                      alignItems: "center",
                      // mb: 3,
                    }}
                  >
                    <Typography
                      variant="h5"
                      gutterBottom
                      sx={{ fontWeight: "bold", fontSize: "1.25rem" }} // Reduced font size
                    >
                      Branches
                    </Typography>
                  </Box>
                  <Box
                    sx={{
                      display: "flex",
                      justifyContent: "right",
                      alignItems: "center",
                      mb: 1,
                    }}
                  >
                    <Button
                      onClick={() => setOpenNewBranchModal(true)}
                      variant="contained"
                      color="primary"
                    >
                      New Branch
                    </Button>
                  </Box>

                  <Box sx={{ width: "100%", overflowX: "auto" }}>
                    <TableContainer sx={{ minWidth: "250px" }}>
                      <Table sx={{}}>
                        <TableHead>
                          <TableRow sx={{ bgcolor: "primary.main" }}>
                            <TableCell
                              sx={{
                                color: "white",
                                fontWeight: "bold",
                                backgroundColor: "primary.main",
                                position: "sticky",
                                left: 0,
                                zIndex: 1,
                              }}
                            >
                              Code
                            </TableCell>

                            <TableCell
                              sx={{ color: "white", fontWeight: "bold" }}
                            >
                              Name
                            </TableCell>

                            <TableCell
                              sx={{ color: "white", fontWeight: "bold" }}
                            >
                              address
                            </TableCell>

                            <TableCell
                              sx={{ color: "white", fontWeight: "bold" }}
                            >
                              pincode
                            </TableCell>

                            <TableCell
                              sx={{ color: "white", fontWeight: "bold" }}
                            >
                              status
                            </TableCell>
                          </TableRow>
                        </TableHead>
                        <TableBody>
                          {listData.map((branch, ind) => (
                            <TableRow
                              key={ind}
                              onClick={() => {
                                setOpenBranchDetailsModal(true);
                                console.log('branch', branch)
                                setSelectedBranch(branch);
                                getBranchMembers(branch?.branchCode)
                                getNonBranchTaggedMembers()
                              }}
                              sx={{
                                "&:nth-of-type(odd)": { bgcolor: "grey.50" },
                                "&:hover": { bgcolor: "grey.100" },
                              }}
                            >
                              <TableCell
                                sx={{
                                  color: "white",
                                  fontWeight: "bold",
                                  position: "sticky",
                                  left: 0,
                                  backgroundColor: branch?.enrolled
                                    ? "lightblue"
                                    : "lightgreen",
                                  zIndex: 1,
                                }}
                              >
                                {branch?.branchCode ?? "-"}
                              </TableCell>
                              <TableCell>{branch?.name ?? "-"}</TableCell>

                              <TableCell>{branch?.address ?? "-"}</TableCell>
                              <TableCell>{branch?.pincode ?? "-"}</TableCell>
                              <TableCell>{branch?.status ?? "-"}</TableCell>
                            </TableRow>
                          ))}
                        </TableBody>
                      </Table>
                    </TableContainer>
                  </Box>
                </Box>
              </div>
            )}

            {/* Modal for new branch*/}

            <Dialog
              open={openNewBranchModal}
              onClose={() => setOpenNewBranchModal(false)}
              fullWidth
              maxWidth="sm"
              sx={{
                fontSize: "6px",
                "& .MuiDialogContent-root": {
                  padding: "16px",
                  display: "flex",
                  flexDirection: "column",
                  justifyContent: "center",
                  alignItems: "center", // Vertical centering
                },
                "& .MuiDialogTitle-root": {
                  backgroundColor: "#1976d2",
                  color: "white",
                },
              }}
            >
              <Box
                sx={{
                  maxWidth: "600px",
                  margin: "auto",
                  padding: "20px",
                  backgroundColor: "#fff",
                  borderRadius: "8px",
                  boxShadow: 2,
                }}
              >
                <Typography variant="h5" textAlign="center" mb={2}>
                  New Branch
                </Typography>
                <form onSubmit={handleNewBranchSubmit}>
                  {/* Branch Name */}
                  <TextField
                    label="Branch Name"
                    name="name"
                    value={branch.name}
                    onChange={handleChange}
                    fullWidth
                    margin="normal"
                    error={Boolean(errors.name)}
                    helperText={errors.name}
                  />

                  {/* Branch Address */}
                  <TextField
                    label="Branch address"
                    name="address"
                    value={branch.address}
                    onChange={handleChange}
                    fullWidth
                    margin="normal"
                    error={Boolean(errors.address)}
                    helperText={errors.address}
                  />

                  {/* Pincode */}
                  <TextField
                    label="Pincode"
                    name="pincode"
                    type="text"
                    value={branch.pincode}
                    onChange={handleChange}
                    fullWidth
                    margin="normal"
                    error={Boolean(errors.pincode)}
                    helperText={errors.pincode}
                  />

                  {/* Status Selection */}
                  <FormControl fullWidth margin="normal">
                    <InputLabel>Status</InputLabel>
                    <Select
                      label="Status"
                      name="status"
                      value={branch.status}
                      onChange={handleChange}
                    >
                      <MenuItem value="Active">Active</MenuItem>
                      <MenuItem value="OpenSoon">Opening Soon</MenuItem>
                      <MenuItem value="Closed">Closed</MenuItem>
                    </Select>
                  </FormControl>

                  {/* Location */}
                  <TextField
                    label="Location"
                    name="location"
                    placeholder="latitude,longitude"
                    type="text"
                    value={branch.location}
                    onChange={handleChange}
                    fullWidth
                    margin="normal"
                    error={Boolean(errors.location)}
                    helperText={errors.location}
                  />

                  {/* Buttons */}
                  <Box
                    sx={{
                      display: "flex",
                      flexDirection: { xs: "column", sm: "row" },
                      gap: 2,
                      mt: 3,
                    }}
                  >
                    <Button
                      onClick={() => setOpenNewBranchModal(false)}
                      variant="outlined"
                      color="secondary"
                      fullWidth
                    >
                      Back
                    </Button>
                    <Button
                      //  onClick={() => {}}
                      type="submit"
                      variant="contained"
                      color="primary"
                      fullWidth
                    >
                      Submit
                    </Button>
                  </Box>
                </form>
              </Box>
            </Dialog>


            {/* Modal for branch details*/}

            <Dialog
              open={openBranchDetailsModal}
              onClose={() => {
                setOpenBranchDetailsModal(false);
                setSelectedBranch(branch);
                setAddMemberModal(false)
              }}
              fullWidth
              // maxWidth="sm"
              sx={{
                fontSize: "6px",
                "& .MuiDialogContent-root": {
                  padding: "16px",
                  display: "flex",
                  flexDirection: "column",
                  justifyContent: "center",
                  alignItems: "center", // Vertical centering
                },
                "& .MuiDialogTitle-root": {
                  backgroundColor: "#1976d2",
                  color: "white",
                },
              }}
            >
              <Box
                sx={{
                  // maxWidth: "600px",
                  // margin: "auto",
                  padding: "20px",
                  backgroundColor: "#fff",
                  borderRadius: "8px",
                  boxShadow: 2,
                }}
              >
                <Typography variant="h5" textAlign="center" mb={2}>
                  Branch Details
                </Typography>
               
                <Button
                      onClick={() => {setAddMemberModal((k=>!k))}}
                      variant="contained"
                      color="primary"
                      fullWidth
                      size={'small'}
                    >
                      Add member
                </Button>

                 {/* Member Selection */}
                {addMemberModal &&<> <FormControl fullWidth margin="normal">
                    <InputLabel>Members</InputLabel>
                    <Select
                      label="Members"
                      name="members"
                      value={selectednonBranchTaggedMember}
                      onChange={(e)=>{
                        setSelectednonBranchTaggedMember(e.target.value)
                      }}
                    >
                      {nonBranchTaggedMembers.length>0 ?nonBranchTaggedMembers.map((mem, memi)=>{
                        return <MenuItem value={mem?.userId}>{mem?.fullName} {" - "}{mem?.role}</MenuItem>
                      }) : <span>No Untagged Members</span>}

                     
                    </Select>
                </FormControl>
                  <Box
                    sx={{
                      display: "flex",
                      flexDirection: { xs: "column", sm: "row" },
                      gap: 2,
                      mt: 3,
                    }}
                  >
                    <Button
                      onClick={() => setAddMemberModal(false)}
                      variant="outlined"
                      color="secondary"
                      fullWidth
                    >
                      Close
                    </Button>
                    <Button
                      onClick={() => {
                        if(selectednonBranchTaggedMember){
                          updateMemberBranch(selectednonBranchTaggedMember, selectedBranch?.branchCode)
                        }
                        else{
                          alert('please select refresh')
                        }}}
                      variant="contained"
                      color="secondary"
                      fullWidth
                    >
                      Submit
                    </Button>
                  </Box>
                </>
              }

                <Typography variant="h5" textAlign="center" mb={2}>
                  Tagged members
                </Typography>
               <Box sx={{ width: "100%", overflowX: "auto" }}>
                    <TableContainer sx={{ minWidth: "250px" }}>
                      <Table sx={{}}>
                        <TableHead>
                          <TableRow sx={{ bgcolor: "primary.main" }}>
                            <TableCell
                              sx={{ color: "white", fontWeight: "bold" }}
                            >
                              Role
                            </TableCell>
                            <TableCell
                              sx={{ color: "white", fontWeight: "bold" }}
                            >
                              Id
                            </TableCell>
                            <TableCell
                              sx={{ color: "white", fontWeight: "bold" }}
                            >
                              Name
                            </TableCell>
                            <TableCell
                              sx={{ color: "white", fontWeight: "bold" }}
                            >
                              Actions
                            </TableCell>
                          </TableRow>
                        </TableHead>
                        <TableBody>
                          {branchMembers.length>0 ?(branchMembers.map((user, ind) => (
                            <TableRow
                              key={ind}
                              onClick={() => {}}
                              sx={{
                                "&:nth-of-type(odd)": { bgcolor: "grey.50" },
                                "&:hover": { bgcolor: "grey.100" },
                              }}
                            >
                              <TableCell
                                sx={{
                                  color: "white",
                                  fontWeight: "bold",
                                  position: "sticky",
                                  left: 0,
                                  backgroundColor: branch?.enrolled
                                    ? "lightblue"
                                    : "lightgreen",
                                  zIndex: 1,
                                }}
                              >
                                {user?.role ?? "-"}
                              </TableCell>
                              <TableCell>{user?.userId ?? "-"}</TableCell>
                              <TableCell>{user?.fullName ?? "-"}</TableCell>
                              <TableCell><Button variant={'contained'} onClick={()=>{untagMemberBranch(user?.userId)}}>Untag</Button></TableCell>
                            </TableRow>
                          ))):<span>"No Members found"</span>}
                        </TableBody>
                      </Table>
                    </TableContainer>
                  </Box>

                  {/* Buttons */}
                  <Box
                    sx={{
                      display: "flex",
                      flexDirection: { xs: "column", sm: "row" },
                      gap: 2,
                      mt: 3,
                    }}
                  >
                    <Button
                      onClick={() => {
                        setOpenBranchDetailsModal(false);
                        setAddMemberModal(false)
                      }}
                      variant="outlined"
                      color="secondary"
                      fullWidth
                    >
                      Back
                    </Button>
                    
                  </Box>

              </Box>
            </Dialog>
          </div>
        );
      };

      const leaderboardData = [
        { name: "Aarav Sharma", amount: " 5,13,787", rank: 1 },
        { name: "Isha Patel", amount: " 4,67,884", rank: 2 },
        { name: "Rohan Mehta", amount: " 4,63,129", rank: 3 },
        { name: "Neha Reddy", amount: " 3,27,655", rank: 4 },
        { name: "Karan Singh", amount: " 3,11,993", rank: 5 },
      ];

      const getBackgroundColor = (rank) => {
        if (rank === 1) return "#005f73";
        if (rank === 2) return "#94d2bd";
        return "#ee9b00";
      };

      const Leaderboard = () => {
        return (
          <Box sx={{ maxWidth: 400, margin: "auto", mt: 1 }}>
            {leaderboardData.map((player) => (
              <Card
                key={player.rank}
                sx={{
                  display: "flex",
                  alignItems: "center",
                  justifyContent: "space-between",
                  margin: "10px 0",
                  padding: "10px",
                  backgroundColor: getBackgroundColor(player.rank),
                  color: player.rank <= 2 ? "#fff" : "#000",
                }}
              >
                <Box display="flex" alignItems="center">
                  {player.rank <= 2 && (
                    <Avatar sx={{ bgcolor: "#fff", color: "gold", mr: 1 }}>
                      <span
                        className="material-icons"
                        sx={{ color: "grey.500" }}
                      >
                        school
                      </span>
                    </Avatar>
                  )}
                  <Box>
                    <Typography variant="h6">{player.name}</Typography>
                    <Typography variant="body2">{player.amount}</Typography>
                  </Box>
                </Box>
                <Typography variant="h5" sx={{ fontWeight: "bold" }}>
                  {player.rank}
                </Typography>
              </Card>
            ))}
          </Box>
        );
      };

      const HomePage = () => {
        const AllLoans = () => {

        const [emiTableArr, setEmiTable] = useState([]);

          const [approvedLoanDetails, setApprovedLoanDetails] = useState({
            amount: 100000,
            roi: 10,
            duration: 12,
          });

          const [loanDisbursedDetails, setLoanDisbursedDetails] = useState({});
          const [emiDetails, setEmiDetails] = useState({});

          const [checked, setChecked] = useState(false);
          const [submitted, setSubmitted] = useState(true);
          const [familyMembers, setFamilyMembers] = useState(0);
          const [listData, setListData] = useState([]);
          const [showList, setShowList] = useState(true);
          const [loading, setLoading] = useState(false);
          const [selectedLoan, setSelectedLoan] = React.useState(null);
          // const [newUserModal, setNewUserModal] = React.useState(false);
          const [openStudentDetailsModal, setOpenStudentDetailsModal] =
            React.useState(false);

          const [user, setUser] = useState({
            fullName: "",
            gender: "",
            father: "",
            email: "",
            phone: "",
            profession: "",
            branch: "",
            role: "",
          });

          const [errors, setErrors] = useState({});

          const validateField = (name, value) => {
            const newErrors = { ...errors };

            switch (name) {
              case "userId":
                if (!value) newErrors.userId = "user ID is required.";
                else delete newErrors.userId;
                break;
              // case "surname":
              //   if (!value) newErrors.surname = "Surname is required.";
              //   else delete newErrors.surname;
              //   break;
              case "fullName":
                if (!value) newErrors.fullName = "Name is required.";
                else delete newErrors.fullName;
                break;
              case "email":
                if (!value) {
                  newErrors.email = "Email is required.";
                } else if (!/\S+@\S+\.\S+/.test(value)) {
                  newErrors.email = "Email is invalid.";
                } else {
                  delete newErrors.email;
                }
                break;
              // case "phone":
              //   if (!value) {
              //     newErrors.phone = "Phone number is required.";
              //   } else if (!/^\d{10}$/.test(value)) {
              //     newErrors.phone = "Phone number must be 10 digits.";
              //   } else {
              //     delete newErrors.phone;
              //   }
              //   break;
              // case "address":
              //   if (!value) newErrors.address = "Address is required.";
              //   else delete newErrors.address;
              //   break;
              //   case "profession":
              //     if (!value) newErrors.profession = "Profession is required.";
              //     else delete newErrors.profession;
              //     break;
              // case "father":
              //   if (!value) newErrors.father = "Gardian name is required.";
              //   else delete newErrors.father;
              //   break;
              // case "profession":
              //   if (!value)
              //     newErrors.profession = "profession's name is required.";
              //   else delete newErrors.profession;
              //   break;
              // case "role":
              //   if (!value) newErrors.role = "Batch Year is required.";
              //   else if (!/^\d{4}$/.test(value)) {
              //     newErrors.role = "Batch Year must be a 4-digit year.";
              //   } else {
              //     delete newErrors.role;
              //   }
              //   break;
              default:
                break;
            }

            setErrors(newErrors);
          };

          const handleChange = (event) => {
            const { name, value } = event.target;
            setUser({
              ...user,
              [name]: value,
            });

            validateField(name, value); // validate each field on change
          };

          const handleSubmit = (event) => {
            // not using as of now
            event.preventDefault();
            console.log("user", user);
            console.log("errors", errors);
            try {
              if (
                Object.keys(errors).length === 0
                // &&
                // Object.values(user).every((val) => val !== "")
              ) {
                users.push({
                  ...user,
                  roleId: 0,
                  theme: "",
                  active: true,
                  joinDate: "",
                  branchCode: "GNB01",
                  gender: "Male",
                  careOf: "",
                });

                console.log("users", users);
                // axios
                //   .post(`${baseURL}/new-enroll`, user)

                //   .then((res) => {
                //     alert(res.data.message);
                //     if (res.data.message != "Same details enrolled") {
                //       setShowList(true);
                //       fetchListDate();
                //     }
                //   })
                //   .catch((error) => {
                //     // setShowList(true);
                //     // setShowList(false);
                //     // alert("catch", error);
                //     alert(error.message);
                //     console.log("Error occurred:", error);
                //   });

                // setShowList(true);
              } else {
                alert("some fileds missing");
              }
            } catch (err) {
              console.log("err", err);
            }
            // Final validation before submission
          };

          useEffect(() => {
            setLoading(true);
            try {
              fetch(`${baseURL}/gn-loans`, {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                  goldnoontoken: localStorage.getItem("goldnoontoken"),
                },
                credentials: "include",
                body: JSON.stringify({}),
              })
                .then((response) => response.json()) // Parse the JSON
                .then((data) => {
                  setListData(data?.data ?? []);
                  setLoading(false);
                })
                .catch((error) => {
                  console.error("Error loading JSON:", error);
                  setLoading(false);
                });
            } catch (er) {
              setLoading(false);
              console.log("er", er);
              alert("catch");
            }
          }, []);
          const fetchListDate = () => {
            try {
              fetch(`${baseURL}/gn-loans`, {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                  goldnoontoken: localStorage.getItem("goldnoontoken"),
                },
                credentials: "include",
                body: JSON.stringify({}),
              })
                .then((response) => response.json()) // Parse the JSON
                .then((data) => {
                  setListData(data?.data ?? []);
                })
                .catch((error) => console.error("Error loading JSON:", error));
            } catch (er) {
              console.log("er", er);
              alert("catch");
            }
          };

          const [searchFilter, setSearchFilter] = React.useState("");

          const [roleFilter, setRoleFilter] = React.useState("");

          const getFilteredlist = () => {
            console.log("listData", listData);
            return listData.filter((user) => {
              return (
                String(user?.loanStatus)
                  .toLowerCase()
                  .includes(roleFilter.toLowerCase()) &&
                user?.fullName
                  .toLowerCase()
                  .includes(searchFilter.toLowerCase())
              );
            });
          };

          const clearStudentFilters = () => {
            setSearchFilter("");
            setRoleFilter("");
          };

          // 1. Add state for dialog popup and selected loan for updating. Place this near other useState hooks, such as after loan state:
          const [openUpdateLoanDialog, setOpenUpdateLoanDialog] =
            useState(false);
          const [loanToUpdate, setLoanToUpdate] = useState(null);
          const [updateStatus, setUpdateStatus] = useState("");
          const [updateNotes, setUpdateNotes] = useState("");

          // 2. Replace updateLoan (previously alert) with dialog open and state handling:
          const updateLoan = (loan) => {
            setLoanToUpdate(loan);
            setUpdateStatus(loan.loanStatus || "");
            setUpdateNotes("");
            setOpenUpdateLoanDialog(true);
          };

          return (
            <div
              style={{
                overflowX: "scroll",
              }}
            >
              {loading ? (
                <div className="loader-container">
                  <div className="loader"></div>
                </div>
              ) : (
                <div className="form-container">
                  <Box sx={{ p: 0, m: 0, width: "100%" }} className="box">
                    <Box
                      sx={{
                        display: "flex",
                        justifyContent: "space-between",
                        alignItems: "center",
                        // mb: 3,
                      }}
                    >
                      <Typography
                        variant="h5"
                        gutterBottom
                        sx={{ fontWeight: "bold", fontSize: "1.25rem" }} // Reduced font size
                      >
                        All Loans
                      </Typography>
                    </Box>
                    <Box
                      sx={{
                        display: "flex",
                        justifyContent: "space-between",
                        alignItems: "center",
                        // mb: 3,
                      }}
                    >
                      <Typography
                        variant="h5"
                        gutterBottom
                        sx={{ fontWeight: "bold", fontSize: "1rem" }} // Reduced font size
                      >
                        filtered :{" "}
                        {getFilteredlist().reduce((acc, el) => acc + 1, 0)} /{" "}
                        {listData.length}
                      </Typography>
                      {/*<Button
                                       onClick={() => {
                                         // alert("Contact administrator");
                                         // setShowList(false);
                                         setBodyarea("ApplyLoan");
                                         // setNewUserModal(true);
                                       }}
                                       variant="contained"
                                       color="primary"
                                       // href="https://zphs-school.vercel.app/enroll-form"
                                       // href="https://sakinalaraju100.github.io/zphs-school/public/addStudentForm.html"
                                     >
                                       apply Loan
                                     </Button>*/}
                    </Box>

                    {/* New user Button */}
                    <Box sx={{ mb: 3, textAlign: "right" }}></Box>

                    {/* Filters Section */}

                    <Box sx={{ mb: 3 }}>
                      <Box
                        sx={{
                          display: "flex",
                          flexDirection: "row",
                          gap: 2,
                          flexWrap: "wrap",
                          mb: 2,
                        }}
                      >
                        <Box sx={{ flexGrow: 1, minWidth: "200px" }}>
                          <Typography
                            variant="subtitle2"
                            gutterBottom
                            sx={{ fontSize: "0.875rem" }}
                          ></Typography>
                          <Box
                            sx={{
                              display: "flex",
                              alignItems: "center",
                              bgcolor: "grey.100",
                              borderRadius: 1,
                              px: 2,
                            }}
                          >
                            <span
                              className="material-icons"
                              sx={{ color: "grey.500" }}
                            >
                              school
                            </span>
                            <select
                              value={roleFilter}
                              onChange={(e) => {
                                // console.log("roleFilter", e.target.value);
                                setRoleFilter(e.target.value);
                                setSearchFilter("");
                                getFilteredlist();
                              }}
                              style={{
                                border: "none",
                                outline: "none",
                                padding: "8px",
                                backgroundColor: "transparent",
                                width: "100%",
                              }}
                            >
                              <option value="">All</option>
                              {[
                                "Progress",
                                "Verification",
                                "Completed",
                                "Rejected",
                                "Month",
                                "Day",
                                "Week",
                                "Year",
                              ].map((role, ri) => (
                                <option key={ri + role} value={role}>
                                  {role}
                                </option>
                              ))}
                            </select>
                          </Box>
                        </Box>
                        <Box sx={{ flexGrow: 1, minWidth: "200px" }}>
                          <Typography
                            variant="subtitle2"
                            gutterBottom
                            sx={{ fontSize: "0.875rem" }}
                          ></Typography>
                          <Box
                            sx={{
                              display: "flex",
                              alignItems: "center",
                              bgcolor: "grey.100",
                              borderRadius: 1,
                              px: 2,
                            }}
                          >
                            <span
                              className="material-icons"
                              sx={{ color: "grey.500" }}
                            >
                              search
                            </span>
                            <input
                              type="text"
                              // value={searchFilter}
                              // onChange={(e) => setSearchFilter(e.target.value)}
                              value={searchFilter}
                              onChange={(e) => {
                                setSearchFilter(e.target.value);
                                getFilteredlist();
                                // if (e.target.value.length > 2) {
                                //   // setSearchFilter(e.target.value);
                                // } else {
                                //   setSearchFilter("");
                                // }
                              }}
                              placeholder="Filter by Name, Loan ID, mobile or Status..."
                              style={{
                                border: "none",
                                outline: "none",
                                padding: "8px",
                                backgroundColor: "transparent",
                                width: "100%",
                              }}
                            />
                            {searchFilter && (
                              <IconButton
                                onClick={() => {
                                  setSearchFilter("");
                                }}
                                sx={{ ml: 1 }}
                              >
                                <span
                                  className="material-icons"
                                  style={{ color: "grey.500" }}
                                >
                                  clear
                                </span>
                              </IconButton>
                            )}
                          </Box>
                        </Box>
                      </Box>
                    </Box>

                    <Box sx={{ width: "100%", overflowX: "auto" }}>
                      <TableContainer sx={{ minWidth: "250px" }}>
                        <Table sx={{}}>
                          <TableHead>
                            <TableRow sx={{ bgcolor: "primary.main" }}>
                              <TableCell
                                sx={{
                                  color: "white",
                                  fontWeight: "bold",
                                  backgroundColor: "primary.main",
                                  position: "sticky",
                                  left: 0,
                                  zIndex: 1,
                                }}
                              >
                                LoanID
                              </TableCell>

                              <TableCell
                                sx={{ color: "white", fontWeight: "bold" }}
                              >
                                Full Name
                              </TableCell>

                              <TableCell
                                sx={{ color: "white", fontWeight: "bold" }}
                              >
                                status
                              </TableCell>

                              <TableCell
                                sx={{ color: "white", fontWeight: "bold" }}
                              >
                                mobile
                              </TableCell>

                              {/*}

                                           <TableCell
                                             sx={{ color: "white", fontWeight: "bold" }}
                                           >
                                             Sales Member
                                           </TableCell>*/}

                              <TableCell
                                sx={{ color: "white", fontWeight: "bold" }}
                              >
                                Applied Date
                              </TableCell>

                              <TableCell
                                sx={{ color: "white", fontWeight: "bold" }}
                              >
                                Actions
                              </TableCell>
                            </TableRow>
                          </TableHead>
                          <TableBody>
                            {/* {allLoans.map((loan, ind) => (*/}
                            {getFilteredlist().map((loan, ind) => (
                              <TableRow
                                key={ind}
                                sx={{
                                  "&:nth-of-type(odd)": { bgcolor: "grey.50" },
                                  "&:hover": { bgcolor: "grey.100" },
                                }}
                              >
                                <TableCell
                                  sx={{
                                    color: "white",
                                    fontWeight: "bold",
                                    position: "sticky",
                                    left: 0,
                                    backgroundColor: loan?.enrolled
                                      ? "lightblue"
                                      : "lightgreen",
                                    zIndex: 1,
                                  }}
                                >
                                  {loan?.loanId ?? "-"}
                                </TableCell>
                                <TableCell>{loan?.fullName ?? "-"}</TableCell>
                                {/* <TableCell>{loan?.father}</TableCell> */}
                                <TableCell>{loan?.loanStatus ?? "-"}</TableCell>
                                <TableCell>{loan?.mobile ?? "-"}</TableCell>
                                <TableCell>
                                  {new Date(loan?.createdAt).toLocaleDateString(
                                    "en-US",
                                    {
                                      year: "numeric",
                                      month: "long",
                                      day: "numeric",
                                    }
                                  ) ?? "-"}
                                </TableCell>
                                <TableCell>
                                  <Stack
                                    direction="row"
                                    spacing={1}
                                    justifyContent="center"
                                    alignItems="center"
                                  >
                                    <Tooltip title="View">
                                      <span>
                                        <Button
                                          onClick={() => {
                                            setSelectedLoan(loan);
                                            setOpenStudentDetailsModal(true);
                                            // setChecked(loan?.enrolled);
                                            // setFamilyMembers(loan?.familyMembers);
                                          }}
                                          size="small"
                                          color="primary"
                                          // variant="outlined"
                                          sx={{
                                            minWidth: 0,
                                            p: 1,
                                            // borderRadius: 1,
                                          }}
                                          startIcon={
                                            <span className="material-icons">
                                              visibility
                                            </span>
                                          }
                                        >
                                          View
                                        </Button>
                                      </span>
                                    </Tooltip>
                                    {loan.edit && (
                                      <Tooltip title="Edit">
                                        <span>
                                          <Button
                                            size="small"
                                            color="info"
                                            // variant="outlined"
                                            sx={{
                                              minWidth: 0,
                                              p: 1,
                                              // borderRadius: 2,
                                            }}
                                            startIcon={
                                              <span className="material-icons">
                                                edit
                                              </span>
                                            }
                                          ></Button>
                                        </span>
                                      </Tooltip>
                                    )}
                                    {loan.delete && (
                                      <Tooltip title="Delete">
                                        <span>
                                          <Button
                                            size="small"
                                            color="error"
                                            // variant="outlined"
                                            sx={{
                                              minWidth: 0,
                                              p: 1,
                                              // borderRadius: 2,
                                            }}
                                            startIcon={
                                              <span className="material-icons">
                                                delete
                                              </span>
                                            }
                                          ></Button>
                                        </span>
                                      </Tooltip>
                                    )}
                                    {loan.update && (
                                      <Tooltip title="Update Status">
                                        <span>
                                          <Button
                                            onClick={() => {
                                              updateLoan(loan);
                                            }}
                                            size="small"
                                            color="success"
                                            variant="outlined"
                                            sx={{
                                              minWidth: 0,
                                              p: 1,
                                              borderRadius: 2,
                                            }}
                                            startIcon={
                                              <span className="material-icons">
                                                forward
                                              </span>
                                            }
                                          >
                                            update
                                          </Button>
                                        </span>
                                      </Tooltip>
                                    )}
                                  </Stack>
                                </TableCell>
                              </TableRow>
                            ))}
                          </TableBody>
                        </Table>
                      </TableContainer>
                    </Box>

                    <Box sx={{ mt: 3, textAlign: "center" }}>
                      <Typography
                        variant="body2"
                        color="text.secondary"
                        sx={{ fontSize: "0.875rem" }}
                        onClick={() => {
                          // setShowList(false);
                        }}
                      >
                        For any updates, please contact the administration.
                      </Typography>
                    </Box>
                  </Box>
                </div>
              )}

              {/* modal for loan Details */}

              {selectedLoan && (
                // <Dialog
                //   open={openStudentDetailsModal}
                //   onClose={() => setOpenStudentDetailsModal(false)}
                //   fullWidth
                //   maxWidth="sm"
                //   sx={{
                //     width: "100%",
                //     fontSize: "6px",
                //     "& .MuiDialogContent-root": {
                //       padding: "16px",
                //       display: "flex",
                //       flexDirection: "column",
                //       justifyContent: "center",
                //       alignItems: "center", // Vertical centering
                //     },
                //     "& .MuiDialogTitle-root": {
                //       backgroundColor: "#1976d2",
                //       color: "white",
                //     },
                //   }}
                // >
                //   <Box sx={{ maxWidth: 400, margin: "auto", mt: 1, p: 3 }}>
                //     <Box
                //       sx={{
                //         display: "flex",
                //         justifyContent: "space-between",
                //         alignItems: "center",
                //         mb: 2,
                //       }}
                //     >
                //       <Typography
                //         variant="h5"
                //         gutterBottom
                //         sx={{
                //           fontWeight: "bold",
                //           textAlign: "center",
                //           flex: 1,
                //           fontSize: { xs: "12px", md: "15px", lg: "18px" },
                //         }}
                //       >
                //         Loan Details
                //       </Typography>
                //       <IconButton
                //         onClick={() => {
                //           fetchListDate();
                //           setOpenStudentDetailsModal(false);
                //         }}
                //       >
                //         <span className="material-icons">close</span>
                //       </IconButton>
                //     </Box>
                //     <Box
                //       sx={{
                //         display: "flex",
                //         flexDirection: "column",
                //         alignItems: "center",
                //         textAlign: "center",
                //         gap: 2,
                //         fontSize: { xs: "12px", md: "15px", lg: "18px" },
                //       }}
                //     >
                //       <Typography>
                //         <strong>fullName:</strong> {selectedLoan.fullName}
                //       </Typography>
                //       <Typography>
                //         <strong>mobile:</strong> {selectedLoan.mobile}
                //       </Typography>
                //       <Typography>
                //         <strong>email:</strong> {selectedLoan.email}
                //       </Typography>
                //       <Typography>
                //         <strong>Hno:</strong> {selectedLoan.Hno}
                //       </Typography>
                //       <Typography>
                //         <strong>address:</strong> {selectedLoan.address}
                //       </Typography>
                //       <Typography>
                //         <strong>pincode:</strong> {selectedLoan.pincode}
                //       </Typography>
                //       <Typography>
                //         <strong>adhaarNumber:</strong>{" "}
                //         {selectedLoan.adhaarNumber}
                //       </Typography>
                //       <Typography>
                //         <strong>panNumber:</strong> {selectedLoan.panNumber}
                //       </Typography>
                //       <Typography>
                //         <strong>cbillScore:</strong> {selectedLoan.cbillScore}
                //       </Typography>
                //       <Typography>
                //         <strong>yourMOnthlyIncome:</strong>{" "}
                //         {selectedLoan.yourMOnthlyIncome}
                //       </Typography>
                //       <Typography>
                //         <strong>monthlExistingEmiAmount:</strong>{" "}
                //         {selectedLoan.monthlExistingEmiAmount}
                //       </Typography>
                //       <Typography>
                //         <strong>loanRequirement:</strong>{" "}
                //         {selectedLoan.loanRequirement}
                //       </Typography>
                //       <Typography>
                //         <strong>typeOfEmployment:</strong>{" "}
                //         {selectedLoan.typeOfEmployment}
                //       </Typography>
                //       <Typography>
                //         <strong>companyName:</strong> {selectedLoan.companyName}{" "}
                //       </Typography>
                //       <Typography>
                //         <strong>yearsOfExperience:</strong>{" "}
                //         {selectedLoan.yearsOfExperience}
                //       </Typography>
                //       <Typography>
                //         <strong>monthlySalary:</strong>{" "}
                //         {selectedLoan.monthlySalary}{" "}
                //       </Typography>
                //       <Typography>
                //         <strong>companyAddress:</strong>{" "}
                //         {selectedLoan.companyAddress}
                //       </Typography>
                //       <Typography>
                //         <strong>companyPincode:</strong>{" "}
                //         {selectedLoan.companyPincode}
                //       </Typography>
                //       <Typography>
                //         <strong>Mode of Salary Payment:</strong>{" "}
                //         {selectedLoan.modeOfSalary}
                //       </Typography>

                //       {/*} <Typography>
                //             <strong>Income Proof:</strong>
                //             <a href={selectedLoan.pan} target="_blank" rel="noreferrer">
                //               {" "}
                //               View pan
                //             </a>
                //           </Typography>*/}
                //       <Typography>
                //         <strong>Photo :</strong>
                //         <Box sx={{ mt: 2 }}>
                //           {selectedLoan?.photo && (
                //             <img
                //               src={selectedLoan?.photo}
                //               alt="PAN"
                //               width="200px"
                //               height="300px"
                //               style={{ objectFit: "cover" }}
                //             />
                //           )}
                //         </Box>
                //       </Typography>
                //       <Typography>
                //         <strong>Aadhar Card:</strong>
                //         <Box sx={{ mt: 2 }}>
                //           {selectedLoan?.aadhar && (
                //             <img
                //               src={selectedLoan?.aadhar}
                //               alt="PAN"
                //               width="200px"
                //               height="300px"
                //               style={{ objectFit: "cover" }}
                //             />
                //           )}
                //         </Box>
                //       </Typography>
                //       <Typography>
                //         <strong>PAN card:</strong>
                //         <Box sx={{ mt: 2 }}>
                //           {selectedLoan?.pan && (
                //             <img
                //               src={selectedLoan?.pan}
                //               alt="PAN"
                //               width="200px"
                //               height="300px"
                //               style={{ objectFit: "cover" }}
                //             />
                //           )}
                //         </Box>
                //       </Typography>
                //       <Typography>
                //         <strong>PaySlip :</strong>
                //         <Box sx={{ mt: 2 }}>
                //           {selectedLoan?.paySlip && (
                //             <iframe
                //               src={`https://docs.google.com/gview?url=${selectedLoan?.paySlip}&embedded=true`}
                //               width="200px"
                //               height="300px"
                //               frameborder="0"
                //             ></iframe>
                //           )}
                //         </Box>
                //       </Typography>
                //       <Typography>
                //         <strong>bank Statement :</strong>
                //         <Box sx={{ mt: 2 }}>
                //           {selectedLoan?.bankStatement && (
                //             <iframe
                //               src={`https://docs.google.com/gview?url=${selectedLoan?.bankStatement}&embedded=true`}
                //               width="200px"
                //               height="300px"
                //               frameborder="0"
                //             ></iframe>
                //           )}
                //         </Box>
                //       </Typography>
                //     </Box>
                //   </Box>
                // </Dialog>
                <Dialog
                  open={openStudentDetailsModal}
                  onClose={() => setOpenStudentDetailsModal(false)}
                  fullWidth
                  maxWidth="sm"
                  sx={{
                    "& .MuiDialogTitle-root": {
                      backgroundColor: "#1976d2",
                      color: "white",
                      padding: "12px 16px",
                    },
                    "& .MuiDialogContent-root": {
                      padding: "20px",
                    },
                  }}
                >
                  <Box sx={{ p: { xs: 2, md: 3 } }}>
                    {/* Title + Close Button */}
                    <Box
                      sx={{
                        display: "flex",
                        justifyContent: "space-between",
                        alignItems: "center",
                        mb: 2,
                      }}
                    >
                      <Typography
                        variant="h6"
                        sx={{
                          fontWeight: "bold",
                          fontSize: { xs: "16px", md: "18px" },
                          textAlign: "center",
                          flexGrow: 1,
                        }}
                      >
                        Loan Details
                      </Typography>

                      <IconButton
                        onClick={() => {
                          fetchListDate();
                          setOpenStudentDetailsModal(false);
                        }}
                      >
                        <span className="material-icons">close</span>
                      </IconButton>
                    </Box>

                    {/* Content */}
                    <Box
                      sx={{
                        display: "flex",
                        flexDirection: "column",
                        gap: 1.5,
                        fontSize: { xs: "13px", md: "15px" },
                      }}
                    >
                      {/* Text Fields */}
                      {[
                        ["Full Name", selectedLoan.fullName],
                        ["Mobile", selectedLoan.mobile],
                        ["Email", selectedLoan.email],
                        ["H.No", selectedLoan.Hno],
                        ["Address", selectedLoan.address],
                        ["Pincode", selectedLoan.pincode],
                        ["Aadhaar Number", selectedLoan.adhaarNumber],
                        ["PAN Number", selectedLoan.panNumber],
                        ["CIBIL Score", selectedLoan.cbillScore],
                        ["Monthly Income", selectedLoan.yourMOnthlyIncome],
                        ["Existing EMI", selectedLoan.monthlExistingEmiAmount],
                        ["Loan Requirement", selectedLoan.loanRequirement],
                        ["Employment Type", selectedLoan.typeOfEmployment],
                        ["Company Name", selectedLoan.companyName],
                        ["Experience (Years)", selectedLoan.yearsOfExperience],
                        ["Monthly Salary", selectedLoan.monthlySalary],
                        ["Company Address", selectedLoan.companyAddress],
                        ["Company Pincode", selectedLoan.companyPincode],
                        ["Salary Payment Mode", selectedLoan.modeOfSalary],
                      ].map(([label, value], i) => (
                        <Typography key={i}>
                          <strong>{label}:</strong> {value}
                        </Typography>
                      ))}
                      {selectedLoan?.actions && (
                        <Typography>
                          <strong>Actions:</strong>{" "}
                          {selectedLoan?.actions.length} times
                        </Typography>
                      )}
                      {selectedLoan?.actions &&
                        selectedLoan?.actions.map((action, actionIndex) => {
                          return (
                            <Typography key={actionIndex}>
                              <strong>Status:</strong> {action.loanStatus}
                              <strong>Notes:</strong> {action.note}
                              <strong>At:</strong>{" "}
                              {new Date(action.dateTime).toLocaleDateString(
                                "en-US",
                                {
                                  year: "numeric",
                                  month: "long",
                                  day: "numeric",
                                  hour: "2-digit",
                                  minute: "2-digit",
                                }
                              )}
                              <strong>By:</strong> {action.updatedBy}
                            </Typography>
                          );
                        })}

                      {/* IMAGES + DOCUMENTS */}
                      {[
                        ["Photo", selectedLoan.photo],
                        ["Aadhaar Card", selectedLoan.aadhar],
                        ["PAN Card", selectedLoan.pan],
                      ].map(
                        ([label, src], i) =>
                          src && (
                            <Box key={i}>
                              <Typography>
                                <strong>{label}:</strong>
                              </Typography>

                              <Box sx={{ mt: 1, textAlign: "center" }}>
                                <img
                                  src={src}
                                  alt={label}
                                  style={{
                                    width: "100%",
                                    maxWidth: "250px",
                                    height: "auto",
                                    borderRadius: "6px",
                                    objectFit: "cover",
                                  }}
                                />
                              </Box>
                            </Box>
                          )
                      )}

                      {/* PDF Documents */}
                      {[
                        ["Payslip", selectedLoan.paySlip],
                        ["Bank Statement", selectedLoan.bankStatement],
                      ].map(
                        ([label, src], i) =>
                          src && (
                            <Box key={i}>
                              <Typography>
                                <strong>{label}:</strong>
                              </Typography>
                              <Box sx={{ mt: 1 }}>
                                <iframe
                                  src={`https://docs.google.com/gview?url=${src}&embedded=true`}
                                  width="100%"
                                  height="300px"
                                  style={{ border: 0, borderRadius: "6px" }}
                                />
                              </Box>
                            </Box>
                          )
                      )}
                    </Box>
                  </Box>
                </Dialog>
              )}
              <Dialog
                open={openUpdateLoanDialog}
                onClose={() => setOpenUpdateLoanDialog(false)}
                fullWidth
                maxWidth="sm"
              >
                <DialogTitle
                  sx={{
                    display: "flex",
                    justifyContent: "space-between",
                    alignItems: "center",
                    // bgcolor: "#1976d2",
                    // color: "white",
                  }}
                >
                  Update Loan Status
                  <IconButton
                    onClick={() => setOpenUpdateLoanDialog(false)}
                    size="small"
                  >
                    <span className="material-icons">close</span>
                  </IconButton>
                </DialogTitle>
                <DialogContent
                  sx={{
                    display: "flex",
                    flexDirection: "column",
                    gap: 2,
                  }}
                >
                  <FormControl fullWidth sx={{ mt: 2 }}>
                    <InputLabel>Status</InputLabel>
                    <Select
                      value={updateStatus}
                      label="Status"
                      onChange={(e) => setUpdateStatus(e.target.value)}
                    >
                      <MenuItem value={"pending"}>Pending</MenuItem>
                      <MenuItem value={"verification"}>Verification</MenuItem>
                      <MenuItem value={"approved"}>Approved</MenuItem>
                      <MenuItem value={"rejected"}>Rejected</MenuItem>
                      <MenuItem value={"processing"}>Processing</MenuItem>
                      <MenuItem value={"disbursing"}>Disbursing</MenuItem>
                      <MenuItem value={"loanRecovering"}>
                        loan Recovering
                      </MenuItem>
                      <MenuItem value={"completed"}>Completed</MenuItem>
                    </Select>
                  </FormControl>
                  {updateStatus === "approved" && (
                    <div>
                      <Typography variant="body1">
                        Eligible Loan Amount: {" "}
                        <TextField
                          onChange={(e) => {
                            setApprovedLoanDetails({
                              ...approvedLoanDetails,
                              amount: e.target.value,
                            });
                          }}
                          value={approvedLoanDetails?.amount}
                        />
                      </Typography>

                      <Slider
                        value={approvedLoanDetails?.amount}
                        onChange={(e, newValue) =>
                          setApprovedLoanDetails({
                            ...approvedLoanDetails,
                            amount: newValue,
                          })
                        }
                        aria-labelledby="amount-slider"
                        min={approvedLoanDetails?.minLoanAmount ?? 50000}
                        max={approvedLoanDetails?.maxLoanAmount ?? 5000000}
                        step={10000}
                        valueLabelDisplay="auto"
                      />

                      <Typography variant="body1">
                        Rate of Interest: {approvedLoanDetails.roi}%
                      </Typography>
                      <Slider
                        value={approvedLoanDetails?.roi}
                        onChange={(e, newValue) =>
                          setApprovedLoanDetails({
                            ...approvedLoanDetails,
                            roi: newValue,
                          })
                        }
                        aria-labelledby="amount-slider"
                        min={7}
                        max={24}
                        step={0.5}
                        valueLabelDisplay="auto"
                      />

                      <Typography variant="body1">
                        Duration: {approvedLoanDetails.duration} months
                      </Typography>
                      <Slider
                        value={approvedLoanDetails.duration}
                        onChange={(e, newValue) =>
                          setApprovedLoanDetails({
                            ...approvedLoanDetails,
                            duration: newValue,
                          })
                        }
                        aria-labelledby="duration-slider"
                        min={6}
                        max={60}
                        step={6}
                        valueLabelDisplay="auto"
                      />
                      <Typography variant="body1">
                        Monthly EMI: 
                        {Math.round(
                          approvedLoanDetails.amount /
                            approvedLoanDetails.duration
                        )}
                      </Typography>
                    </div>
                  )}
                  {updateStatus === "disbursing" && (
                    <div>
                      <Typography variant="body1">
                        Approved Loan Amount:  10000/-
                      </Typography>
                      <Typography variant="body1">
                        Approved Loan Rate of Interest: 11%
                      </Typography>
                     
                      <FormControl fullWidth sx={{ mt: 2 }}>
                  <InputLabel>Select Emi Plan</InputLabel>
                    <Select
                      value={'monthly'}
                      label="Select Emi Plan"
                    >
                      <MenuItem value={"monthly"}>Monthly</MenuItem>
                    </Select>
                  </FormControl>

                  <FormControl fullWidth sx={{ mt: 2 }}>
                    <InputLabel>Choose Emi Date</InputLabel>
                    <Select
                      value={emiDetails?.emiDate ?? 1}
                      label="Choose Emi Date"
                      onChange={(e) => setEmiDetails({...emiDetails, emiDate: e.target.value})}
                    >
                      <MenuItem defaultValue value={1}>1</MenuItem>
                      <MenuItem value={2}>2</MenuItem>
                      <MenuItem value={3}>3</MenuItem>
                      <MenuItem value={4}>4</MenuItem>
                      <MenuItem value={5}>5</MenuItem>
                      <MenuItem value={6}>6</MenuItem>
                      <MenuItem value={7}>7</MenuItem>
                      <MenuItem value={8}>8</MenuItem>
                      <MenuItem value={9}>9</MenuItem>
                      <MenuItem value={10}>10</MenuItem>
                      <MenuItem value={11}>11</MenuItem>
                      <MenuItem value={12}>12</MenuItem>
                      <MenuItem value={13}>13</MenuItem>
                      <MenuItem value={14}>14</MenuItem>
                      <MenuItem value={15}>15</MenuItem>
                      <MenuItem value={16}>16</MenuItem>
                      <MenuItem value={17}>17</MenuItem>
                      <MenuItem value={18}>18</MenuItem>
                      <MenuItem value={19}>19</MenuItem>
                      <MenuItem value={20}>20</MenuItem>
                      <MenuItem value={21}>21</MenuItem>
                      <MenuItem value={22}>22</MenuItem>
                      <MenuItem value={23}>23</MenuItem>
                      <MenuItem value={24}>24</MenuItem>
                      <MenuItem value={25}>25</MenuItem>
                      <MenuItem value={26}>26</MenuItem>
                      <MenuItem value={27}>27</MenuItem>
                      <MenuItem value={28}>28</MenuItem>
                    </Select>
                  </FormControl>

                      <Typography variant="body1">
                        Duration: {approvedLoanDetails.duration} months
                      </Typography>
                      <Slider
                        value={approvedLoanDetails.duration}
                        onChange={(e, newValue) =>
                          setApprovedLoanDetails({
                            ...approvedLoanDetails,
                            duration: newValue,
                          })
                        }
                        aria-labelledby="duration-slider"
                        min={6}
                        max={60}
                        step={6}
                        valueLabelDisplay="auto"
                      />
                      <Typography variant="body1">
                        Monthly EMI: 
                        {Math.round(
                          approvedLoanDetails.amount /
                            approvedLoanDetails.duration
                        )}
                      </Typography>
                      <Typography>
                        <div>
                        {approvedLoanDetails?.duration > 0 && (
                          <Table>
                            <TableHead>
                              <TableRow>
                                <TableCell>Month</TableCell>
                                <TableCell>EMI Amount</TableCell>
                                <TableCell>Status</TableCell>
                              </TableRow>
                            </TableHead>
                            <TableBody>
                              {[...Array(Number(approvedLoanDetails?.duration))].map((emi, monthIndex) => (
                                 <TableRow key={monthIndex}>
                                  <TableCell style={{ fontSize: "8px" }}>
                                    {moment().add(monthIndex + 1, "months").format(`${emiDetails?.emiDate ?? 1}-MMM-YYYY`)}
                                  </TableCell>
                                  <TableCell style={{ fontSize: "8px" }}>
                                     {Math.round( approvedLoanDetails.amount / approvedLoanDetails.duration).toFixed(2)}
                                  </TableCell>
                                  <TableCell style={{ fontSize: "8px" }}>
                                     {'Not Paid'}
                                  </TableCell>
                                  
                                </TableRow>
                              ))}
                            </TableBody>
                          </Table>
                        )}
                      </div>
                      </Typography>

                    </div>
                  )}

                  <TextField
                    label="Notes"
                    multiline
                    minRows={3}
                    value={updateNotes}
                    onChange={(e) => setUpdateNotes(e.target.value)}
                    fullWidth
                    placeholder="Enter update notes here..."
                  />
                </DialogContent>
                <DialogActions>
                  <Button
                    onClick={() => setOpenUpdateLoanDialog(false)}
                    color="inherit"
                  >
                    Cancel
                  </Button>
                  <Button
                    variant="contained"
                    color="primary"
                    onClick={async () => {
                      // Call /update-loan-status with required data
                      try {
                        console.log("loanToUpdate", loanToUpdate);
                        let login = loginData;
                        if (!login) {
                          // fallback to localStorage if needed
                          login = JSON.parse(localStorage.getItem("gnUserObj"));
                        }
                        await axios.post(`${baseURL}/update-loan-status`, {
                          loanId: loanToUpdate?.loanId,
                          userId: login?.userId,
                          newLoanStatus: updateStatus,
                          notes: updateNotes,
                          approvedLoanDetails: approvedLoanDetails ?? {},
                          loanDisbursedDetails: loanDisbursedDetails ?? {},
                          emiDetails : emiDetails ?? {}
                        });
                        alert("Loan status updated successfully");
                        setOpenUpdateLoanDialog(false);
                      } catch (err) {
                        alert("Failed to update loan status");
                      }
                    }}
                  >
                    Submit
                  </Button>
                </DialogActions>
              </Dialog>
            </div>
          );
        };

        const Dashboard = () => {
          // Carousel images
          const carouselImages = [
            {
              label: "Welcome Goldnoon Fintech",

              imgPath:
                "https://images.unsplash.com/photo-1606761568499-6d2451b23c66?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxpaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2340&q=80",
              description: "We deal your financial solutions..",
            },
            {
              label: "One Stop For financial needs",
              imgPath:
                "https://images.unsplash.com/photo-1460925895917-afdab827c52f?q=80&w=2015&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
              // "https://images.unsplash.com/photo-1427504494785-3a9ca7044f45?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxpaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2340&q=80",
              // "https://www.google.com/url?sa=i&url=https%3A%2F%2Fwww.freepik.com%2Ffree-photos-vectors%2Ffinancial-planning&psig=AOvVaw2IDSKpFUbkqP0mSy_JToVt&ust=1742367192011000&source=images&cd=vfe&opi=89978449&ved=0CBEQjRxqFwoTCNCVwOSFk4wDFQAAAAAdAAAAABAE",
              description: "Excellence in Learning",
            },
            {
              label: "Empowering with Goldnoon",

              imgPath:
                "https://plus.unsplash.com/premium_photo-1661716853327-a16e87a6dff1?q=80&w=1974&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
              // "https://images.unsplash.com/photo-1580582932707-520aed937b7b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2340&q=80",
              description: "State-of-the-art Infrastructure",
            },
          ];

          const [activeStep, setActiveStep] = React.useState(0);
          const maxSteps = carouselImages.length;

          React.useEffect(() => {
            const timer = setInterval(() => {
              setActiveStep(
                (prevActiveStep) => (prevActiveStep + 1) % maxSteps
              );
            }, 5000);

            return () => clearInterval(timer);
          }, [maxSteps]);

          return (
            <div>
              <Box
                sx={{
                  position: "relative",
                  height: { xs: "40vh", sm: "50vh", md: "75vh" },
                }}
              >
                <Paper
                  square
                  elevation={0}
                  sx={{
                    height: "100%",
                    position: "relative",
                    backgroundColor: "grey.800",
                    color: "#fff",
                    backgroundSize: "cover",
                    backgroundPosition: "center",
                    backgroundImage: `url(${carouselImages[activeStep].imgPath})`,
                    transition: "background-image 0.5s ease-in-out",
                  }}
                >
                  <Box
                    sx={{
                      position: "absolute",
                      top: 0,
                      bottom: 0,
                      right: 0,
                      left: 0,
                      backgroundColor: "rgba(0,0,0,.5)",
                    }}
                  />
                  <Container
                    maxWidth="md"
                    sx={{
                      position: "relative",
                      height: "100%",
                      display: "flex",
                      flexDirection: "column",
                      justifyContent: "center",
                      alignItems: "center",
                      textAlign: "center",
                      px: { xs: 2, sm: 3, md: 4 },
                    }}
                  >
                    <Typography
                      variant="body"
                      component="h3"
                      gutterBottom
                      sx={{
                        fontSize: { xs: "1.75rem", sm: "3rem", md: "3.75rem" },
                      }}
                    >
                      {carouselImages[activeStep].label}
                    </Typography>
                    {activeStep == 0 && (
                      <Typography
                        variant="h5"
                        paragraph
                        sx={{
                          fontSize: {
                            xs: "1.2rem",
                            sm: "1.5rem",
                            md: "1.5rem",
                          },

                          color: theme.appBarColor,
                        }}
                      >
                        {carouselImages[activeStep].description}
                      </Typography>
                    )}
                    {activeStep == 1 && (
                      <Button
                        size="small"
                        variant="outlined"
                        onClick={() => {
                          setCustomerSignUPDialogOpen(true);
                        }}
                        sx={{
                          color: theme.appBarColor,
                          // bgcolor: theme.appBarColor,
                        }}
                      >
                        New Customer
                      </Button>
                    )}
                    {activeStep == 2 && (
                      <Button
                        size="small"
                        variant="outlined"
                        onClick={() => {
                          setShareInterestDialogOpen(true);
                        }}
                        sx={{
                          color: theme.appBarColor,
                          // bgcolor: theme.appBarColor,
                        }}
                      >
                        Become a Partner
                      </Button>
                    )}
                  </Container>
                </Paper>
                <MobileStepper
                  steps={maxSteps}
                  position="static"
                  activeStep={activeStep}
                  sx={{
                    position: "absolute",
                    bottom: 0, // You can adjust the bottom distance as needed
                    left: "50%", // Centers horizontally
                    transform: "translateX(-50%)", // Ensures the element is centered by shifting it back by 50%
                    width: "auto", // Use auto or a fixed width if needed
                    background: "transparent",
                  }}
                />
              </Box>

              {/* Customer My Loans and apply Loans section */}
              {loginData?.role == "customer" && (
                <Box
                  sx={{
                    // bgcolor: "grey.100",
                    pt: 0,
                    mb: 1,
                    display: "flex",
                    justifyContent: "center",
                  }}
                  gap={2}
                >
                  <Card
                    sx={{
                      display: "flex",
                      flexDirection: "column",
                      justifyContent: "center",
                      alignItems: "center",
                      padding: 2,
                      margin: 1,
                      cursor: "pointer",
                      backgroundColor: theme.appBarColor,
                      color: "white",
                      // "&:hover": {
                      //   backgroundColor: "rgba(255, 255, 255, 0.1)",
                      // },
                    }}
                    onClick={() => {
                      setBodyarea("AllLoans");
                      // setCustomerSignUPDialogOpen(true);
                    }}
                  >
                    <Box sx={{ display: "flex", alignItems: "center" }}>
                      <span
                        className="material-icons"
                        style={{ marginRight: "8px" }}
                      >
                        people
                      </span>
                      <Typography variant="h6">My Loans</Typography>
                    </Box>
                  </Card>
                  <Card
                    sx={{
                      display: "flex",
                      flexDirection: "column",
                      justifyContent: "center",
                      alignItems: "center",
                      padding: 2,
                      margin: 1,
                      cursor: "pointer",
                      backgroundColor: theme.appBarColor,
                      color: "white",
                      // "&:hover": {
                      //   backgroundColor: "rgba(255, 255, 255, 0.1)",
                      // },
                    }}
                    onClick={() => {
                      setBodyarea("ApplyLoan");
                      // setShareInterestDialogOpen(true);
                    }}
                  >
                    <Box sx={{ display: "flex", alignItems: "center" }}>
                      <span
                        className="material-icons"
                        style={{ marginRight: "8px" }}
                      >
                        forward
                      </span>
                      <Typography variant="h6">Apply Loan</Typography>
                    </Box>
                  </Card>
                </Box>
              )}
              {/* Customer My Loans and apply Loans section */}
              {loginData?.role.toLowerCase() == "sales" && (
                <Box
                  sx={{
                    // bgcolor: "grey.100",
                    pt: 0,
                    mb: 1,
                    display: "flex",
                    justifyContent: "center",
                  }}
                  gap={2}
                >
                  <Card
                    sx={{
                      display: "flex",
                      flexDirection: "column",
                      justifyContent: "center",
                      alignItems: "center",
                      padding: 2,
                      margin: 1,
                      cursor: "pointer",
                      backgroundColor: theme.appBarColor,
                      color: "white",
                      // "&:hover": {
                      //   backgroundColor: "rgba(255, 255, 255, 0.1)",
                      // },
                    }}
                    onClick={() => {
                      setBodyarea("SalesReports");
                      // setCustomerSignUPDialogOpen(true);
                    }}
                  >
                    <Box sx={{ display: "flex", alignItems: "center" }}>
                      <span
                        className="material-icons"
                        style={{ marginRight: "8px" }}
                      >
                        people
                      </span>
                      <Typography variant="h6">Sales Reports</Typography>
                    </Box>
                  </Card>
                  <Card
                    sx={{
                      display: "flex",
                      flexDirection: "column",
                      justifyContent: "center",
                      alignItems: "center",
                      padding: 2,
                      margin: 1,
                      cursor: "pointer",
                      backgroundColor: theme.appBarColor,
                      color: "white",
                      // "&:hover": {
                      //   backgroundColor: "rgba(255, 255, 255, 0.1)",
                      // },
                    }}
                    onClick={() => {
                      setBodyarea("SalesBoard");
                      // setShareInterestDialogOpen(true);
                    }}
                  >
                    <Box sx={{ display: "flex", alignItems: "center" }}>
                      <span
                        className="material-icons"
                        style={{ marginRight: "8px" }}
                      >
                        forward
                      </span>
                      <Typography variant="h6">Sales Board</Typography>
                    </Box>
                  </Card>
                </Box>
              )}
              {/* Customer My Loans and apply Loans section */}
              {loginData?.role.toLowerCase() == "admin" && (
                <Box
                  sx={{
                    // bgcolor: "grey.100",
                    pt: 0,
                    mb: 1,
                    display: "flex",
                    justifyContent: "center",
                  }}
                  gap={2}
                >
                  <Card
                    sx={{
                      display: "flex",
                      flexDirection: "column",
                      justifyContent: "center",
                      alignItems: "center",
                      padding: 2,
                      margin: 1,
                      cursor: "pointer",
                      backgroundColor: theme.appBarColor,
                      color: "white",
                      // "&:hover": {
                      //   backgroundColor: "rgba(255, 255, 255, 0.1)",
                      // },
                    }}
                    onClick={() => {
                      setBodyarea("AllCustomers");
                      // setCustomerSignUPDialogOpen(true);
                    }}
                  >
                    <Box sx={{ display: "flex", alignItems: "center" }}>
                      <span
                        className="material-icons"
                        style={{ marginRight: "8px" }}
                      >
                        people
                      </span>
                      <Typography variant="h6">All Customers</Typography>
                    </Box>
                  </Card>
                  <Card
                    sx={{
                      display: "flex",
                      flexDirection: "column",
                      justifyContent: "center",
                      alignItems: "center",
                      padding: 2,
                      margin: 1,
                      cursor: "pointer",
                      backgroundColor: theme.appBarColor,
                      color: "white",
                      // "&:hover": {
                      //   backgroundColor: "rgba(255, 255, 255, 0.1)",
                      // },
                    }}
                    onClick={() => {
                      setBodyarea("AllLoans");
                      // setShareInterestDialogOpen(true);
                    }}
                  >
                    <Box sx={{ display: "flex", alignItems: "center" }}>
                      <span
                        className="material-icons"
                        style={{ marginRight: "8px" }}
                      >
                        forward
                      </span>
                      <Typography variant="h6">All Loans</Typography>
                    </Box>
                  </Card>
                </Box>
              )}

              {/* News & Updates */}
              <Box sx={{ bgcolor: "grey.100", py: 2 }}>
                <Container maxWidth="lg">
                  <Typography
                    variant="body"
                    gutterBottom
                    sx={{
                      textAlign: "center",
                      mb: 4,
                      position: "relative",
                      // "&:after": {
                      //   content: '""',
                      //   position: "absolute",
                      //   bottom: "-10px",
                      //   left: "50%",
                      //   transform: "translateX(-50%)",
                      //   width: "60px",
                      //   height: "3px",
                      //   backgroundColor: "primary.main",
                      // },
                    }}
                  >
                    Key Benifits with Goldnoon
                  </Typography>
                  <div>
                    <div className="notification success">
                      <span className="icon"></span> Customized Loan Offers..
                    </div>

                    <div className="notification error">
                      <span className="icon"></span> Online & mobile access..
                      {/*<span className="icon"> </span> Minimal Documents*/}
                    </div>

                    <div className="notification warning">
                      <span className="icon"></span> Quick Disbursement..
                    </div>

                    <div className="notification general">
                      <span className="icon"></span> Minimal Documents..
                    </div>
                  </div>
                </Container>
              </Box>

              {/* Achievements Section */}

              <Box
                sx={{
                  flexGrow: 1,
                  overflowX: "auto",
                  whiteSpace: "nowrap",
                  width: "100%",
                }}
              >
                <Container
                  // maxWidth="lg"
                  // maxWidth={false}

                  sx={{
                    display: "inline-block",
                    // minWidth: "200px",
                    // maxWidth: {
                    //   xs: "320px", // Full width on extra-small screens
                    //   sm: "450px", // 450px on small screens
                    //   md: "768px", // 600px on medium screens
                    //   lg: "1024px", // 800px on large screens
                    // },
                    my: 2,

                    position: "relative",
                    "& .MuiContainer-root": {
                      overflowX: "auto",
                      scrollBehavior: "smooth",
                      "&::-webkit-scrollbar": {
                        display: "none",
                      },
                      msOverflowStyle: "none",
                      scrollbarWidth: "none",
                    },
                  }}
                >
                  <Typography
                    variant="h4"
                    gutterBottom
                    sx={{
                      textAlign: "center",
                      mb: 4,
                      fontSize: { xs: "1.25rem", sm: "2rem", md: "2.25rem" },
                      position: "relative",
                      "&:after": {
                        content: '""',
                        position: "absolute",
                        bottom: "-10px",
                        left: "50%",
                        transform: "translateX(-50%)",
                        width: "60px",
                        height: "3px",
                        backgroundColor: theme.appBarColor,
                      },
                    }}
                  >
                    Our Founders & Achievements
                  </Typography>

                  <Box sx={{ position: "relative" }}>
                    <IconButton
                      sx={{
                        position: "absolute",
                        left: -20,
                        top: "50%",
                        transform: "translateY(-50%)",
                        backgroundColor: "white",
                        boxShadow: 2,
                        "&:hover": { backgroundColor: "grey.100" },
                        zIndex: 2,
                      }}
                      onClick={() => {
                        const container = document.getElementById(
                          "achievements-scroll"
                        );
                        container.scrollBy({ left: -300, behavior: "smooth" });
                      }}
                    >
                      <span className="material-icons">chevron_left</span>
                    </IconButton>

                    <Box
                      id="achievements-scroll"
                      sx={{
                        display: "flex",
                        overflowX: "auto",
                        gap: 3,
                        pb: 2,
                        scrollBehavior: "smooth",
                        "&::-webkit-scrollbar": { display: "none" },
                        msOverflowStyle: "none",
                        scrollbarWidth: "none",
                      }}
                    >
                      {achievements.map((achievement, index) => (
                        <Card
                          key={index}
                          sx={{
                            minWidth: 300,
                            maxWidth: 300,
                            height: "200px",
                            flex: "0 0 auto",
                            display: "flex",
                            flexDirection: "column",
                            transition: "transform 0.2s",
                            "&:hover": {
                              transform: achievement.isViewMore
                                ? "translateY(-5px)"
                                : "translateY(-5px)",
                              boxShadow: 3,
                            },
                            ...(achievement.isViewMore && {
                              backgroundColor: "primary.main",
                              color: "white",
                              display: "flex",
                              alignItems: "center",
                              justifyContent: "center",
                              cursor: "pointer",
                              transition: "all 0.3s ease",
                              "&:hover": {
                                backgroundColor: "primary.dark",
                                transform: "translateY(-5px)",
                                boxShadow: 3,
                              },
                            }),
                          }}
                        >
                          {achievement.isViewMore ? (
                            <CardContent
                              sx={{
                                textAlign: "center",
                                display: "flex",
                                flexDirection: "column",
                                alignItems: "center",
                                justifyContent: "center",
                                height: "100%",
                                padding: "24px",
                              }}
                            >
                              <Box
                                sx={{
                                  backgroundColor: "rgba(255,255,255,0.2)",
                                  borderRadius: "50%",
                                  width: 80,
                                  height: 80,
                                  display: "flex",
                                  alignItems: "center",
                                  justifyContent: "center",
                                  mb: 2,
                                  transition: "all 0.3s ease",
                                }}
                              >
                                <span
                                  className="material-icons"
                                  style={{ fontSize: "40px" }}
                                >
                                  {achievement.icon}
                                </span>
                              </Box>
                              <Typography
                                variant="h6"
                                component="div"
                                sx={{ mt: 2, fontWeight: "bold" }}
                              >
                                {achievement.title}
                              </Typography>
                              <Typography
                                variant="body1"
                                sx={{ mt: 1, opacity: 0.9 }}
                              >
                                Click to explore more achievements
                              </Typography>
                            </CardContent>
                          ) : (
                            <CardContent
                              sx={{
                                flexGrow: 1,
                                padding: "24px",
                                height: "100%",
                                display: "flex",
                                flexDirection: "column",
                              }}
                            >
                              <Box
                                sx={{
                                  display: "flex",
                                  alignItems: "center",
                                  mb: 2,
                                }}
                              >
                                <Box
                                  sx={{
                                    backgroundColor: "primary.main",
                                    borderRadius: "50%",
                                    p: 1,
                                    mr: 2,
                                    display: "flex",
                                    alignItems: "center",
                                    justifyContent: "center",
                                  }}
                                >
                                  <span
                                    className="material-icons"
                                    style={{ color: "white" }}
                                  >
                                    {achievement.icon}
                                  </span>
                                </Box>
                                <Typography variant="h6" component="div">
                                  {achievement.title}
                                </Typography>
                              </Box>
                              <Typography
                                variant="body2"
                                color="text.secondary"
                                gutterBottom
                              >
                                {achievement.date}
                              </Typography>
                              <Typography
                                variant="body1"
                                sx={{
                                  overflow: "hidden",
                                  textOverflow: "ellipsis",
                                  display: "-webkit-box",
                                  WebkitLineClamp: 4,
                                  WebkitBoxOrient: "vertical",
                                }}
                              >
                                {achievement.description}
                              </Typography>
                            </CardContent>
                          )}
                        </Card>
                      ))}
                    </Box>

                    <IconButton
                      sx={{
                        position: "absolute",
                        right: -20,
                        top: "50%",
                        transform: "translateY(-50%)",
                        backgroundColor: "white",
                        boxShadow: 2,
                        "&:hover": { backgroundColor: "grey.100" },
                        zIndex: 2,
                      }}
                      onClick={() => {
                        const container = document.getElementById(
                          "achievements-scroll"
                        );
                        container.scrollBy({ left: 300, behavior: "smooth" });
                      }}
                    >
                      <span className="material-icons">chevron_right</span>
                    </IconButton>
                  </Box>
                </Container>
              </Box>

              {/* SCroll with marquee */}
              <Box
                style={{
                  fontSize: "12px",
                  // paddingTop: "6px",
                  // backgroundColor: "#25D366",
                  color: "white",
                  // "&:hover": {
                  //   fontSize: "12px",
                  // },
                }}
              >
                <marquee behavior="scroll" direction="left">
                  <Box
                    sx={{
                      display: "flex",
                      justifyContent: "space-around",
                      mt: 2,
                    }}
                  >
                    <Box
                      sx={{
                        bgcolor: "grey.200",
                        p: 2,
                        borderRadius: 1,
                        textAlign: "center",
                        flex: 1,
                        mx: 1,
                      }}
                    >
                      <Typography variant="h6" color={theme.appBarColor}>
                        Partner 1
                      </Typography>
                    </Box>
                    <Box
                      sx={{
                        bgcolor: "grey.200",
                        p: 2,
                        borderRadius: 1,
                        textAlign: "center",
                        flex: 1,
                        mx: 1,
                      }}
                    >
                      <Typography variant="h6" color={theme.appBarColor}>
                        Partner 2
                      </Typography>
                    </Box>
                    <Box
                      sx={{
                        bgcolor: "grey.200",
                        p: 2,
                        borderRadius: 1,
                        textAlign: "center",
                        flex: 1,
                        mx: 1,
                      }}
                    >
                      <Typography variant="h6" color={theme.appBarColor}>
                        Partner 3
                      </Typography>
                    </Box>
                  </Box>
                </marquee>
              </Box>

              {/* New Customer and Become apartner button */}
              <Box
                sx={{
                  bgcolor: "grey.100",
                  pt: 2,
                  display: "flex",
                  justifyContent: "center",
                }}
                gap={2}
              >
                <Button
                  size="small"
                  variant="outlined"
                  sx={{
                    color: theme.appBarColor,
                    // bgcolor: theme.appBarColor,
                  }}
                  onClick={() => {
                    setCustomerSignUPDialogOpen(true);
                  }}
                >
                  New Customer
                </Button>
                <Button
                  size="small"
                  variant="outlined"
                  sx={{
                    color: theme.appBarColor,
                    // bgcolor: theme.appBarColor,
                  }}
                  onClick={() => {
                    setShareInterestDialogOpen(true);
                  }}
                >
                  Become a Partner
                </Button>
              </Box>

              {/* About Us Section */}
              <Box sx={{ py: 2, bgcolor: "grey.100" }}>
                <Container maxWidth="lg">
                  {/*<Typography
                                 variant="h4"
                                 gutterBottom
                                 sx={{
                                   textAlign: "center",
                                   mb: 4,
                                   fontSize: { xs: "1.75rem", sm: "2rem", md: "2.25rem" },
                                   position: "relative",
                                   "&:after": {
                                     content: '""',
                                     position: "absolute",
                                     bottom: "-10px",
                                     left: "50%",
                                     transform: "translateX(-50%)",
                                     width: "60px",
                                     height: "3px",
                                     backgroundColor: "primary.main",
                                   },
                                 }}
                               >
                                 About Us
                               </Typography>*/}

                  <Grid
                    container
                    spacing={{ xs: 2, sm: 3, md: 4 }}
                    sx={{
                      minHeight: {
                        xs: "400px", // Minimum height for extra small screens
                        sm: "500px", // Minimum height for small screens
                        md: "600px", // Minimum height for medium and larger screens
                      },
                      height: "100%", // Ensure it takes full height of its container
                    }}
                  >
                    {/* School History */}
                    <Grid item xs={12} md={12}>
                      <Card
                        sx={{
                          // height: "100%",
                          // height: { xs: 10, sm: 3, md: 4 },
                          display: "flex",
                          flexDirection: "column",
                          p: { xs: 2, sm: 2, md: 3 },
                          // m: { xs: 2, sm: 2, md: 3 },

                          fontSize: {
                            xs: "0.875rem", // Extra small screens
                            sm: "1rem", // Small screens
                            md: "1.125rem", // Medium and larger screens
                          },
                        }}
                      >
                        <Typography variant="h5" gutterBottom color="primary">
                          Our Motive
                        </Typography>
                        <Typography variant="body1" paragraph>
                          We Established in 2020, with a strong motive to
                          empowering individuals and Businesses with seamles
                          financial solutions as a trusted financial
                          Organization. We Offers a wind range of Loan Products,
                          Investiments opportunities, and wealth Management
                          service to meet financial needs
                        </Typography>
                      </Card>
                    </Grid>

                    {/* Google Map */}
                    <Grid item xs={12} md={12}>
                      <Card
                        sx={{
                          height: "100%",
                          display: "flex",
                          flexDirection: "column",
                        }}
                      >
                        <Box
                          sx={{
                            flex: 1,
                            minHeight: "300px",
                            width: "100%",
                          }}
                        >
                          <iframe
                            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d60710.79354192987!2d79.51014090191924!3d18.005488225693174!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3a334f75c05023ed%3A0x2352eaaf6fe897ea!2sHanamkonda%2C%20Telangana!5e0!3m2!1sen!2sin!4v1741608615942!5m2!1sen!2sin"
                            width="100%"
                            height="100%"
                            style={{ border: 0 }}
                            allowFullScreen=""
                            loading="lazy"
                          ></iframe>
                        </Box>
                        <Box sx={{ p: 3 }}>
                          <Typography variant="h6" gutterBottom>
                            Our Location
                          </Typography>
                          <Typography variant="body2" color="text.secondary">
                            Main Branch Located in Hanamkonda, Warangal. Sub
                            branches where placed in Multiple cities.
                          </Typography>
                        </Box>
                      </Card>
                    </Grid>
                  </Grid>
                </Container>
              </Box>

              {/* Footer */}
              <Box
                component="footer"
                id="contact-section"
                sx={{ bgcolor: "primary.main", color: "white", py: 6, mt: 4 }}
              >
                <Container maxWidth="lg">
                  <Grid container spacing={4}>
                    <Grid item xs={12} md={4}>
                      <Typography
                        variant="h6"
                        gutterBottom
                        sx={{
                          display: "flex",
                          alignItems: "center",
                          gap: 1,
                          color: "#FFD700",
                          fontWeight: "bold",
                          marginBottom: 3,
                        }}
                      >
                        <span className="material-icons">contact_support</span>
                        Contact Us
                      </Typography>

                      <Box
                        sx={{
                          display: "flex",
                          flexDirection: "column",
                          gap: 2,
                        }}
                      >
                        <Box
                          sx={{ display: "flex", alignItems: "center", gap: 2 }}
                        >
                          <span
                            className="material-icons"
                            style={{ fontSize: "20px" }}
                          >
                            location_on
                          </span>
                          <Typography variant="body2">
                            Company
                            <br />
                            Goldnoon Fintech
                          </Typography>
                        </Box>

                        <Box
                          sx={{ display: "flex", alignItems: "center", gap: 2 }}
                        >
                          <span
                            className="material-icons"
                            style={{ fontSize: "20px" }}
                          >
                            phone
                          </span>
                          <Typography
                            variant="body2"
                            component="a"
                            href="tel:+91 9676639383"
                            sx={{
                              color: "white",
                              textDecoration: "none",
                              "&:hover": { textDecoration: "underline" },
                            }}
                          >
                            +91 9676639383
                          </Typography>
                        </Box>

                        <Box
                          sx={{ display: "flex", alignItems: "center", gap: 2 }}
                        >
                          <span
                            className="material-icons"
                            style={{ fontSize: "20px" }}
                          >
                            email
                          </span>
                          <Typography
                            variant="body2"
                            component="a"
                            href="mailto:goldnoon@gmail.com"
                            sx={{
                              color: "white",
                              textDecoration: "none",
                              "&:hover": { textDecoration: "underline" },
                            }}
                          >
                            goldnoon@gmail.com
                          </Typography>
                        </Box>

                        <Box
                          sx={{ display: "flex", alignItems: "center", gap: 2 }}
                        >
                          <span
                            className="material-icons"
                            style={{ fontSize: "20px" }}
                          >
                            schedule
                          </span>
                          <Typography variant="body2">
                            Monday - Saturday
                            <br />
                            10:00 AM - 6:00 PM
                          </Typography>
                        </Box>
                      </Box>
                    </Grid>

                    <Grid
                      item
                      xs={12}
                      md={4}
                      sx={{
                        display: {
                          xs: "none", // Hidden on extra-small screens
                          md: "block", // Visible on small screens and up
                          sm: "none", // Visible on small screens and up
                        },
                      }}
                    >
                      <Typography
                        variant="h6"
                        gutterBottom
                        sx={{
                          display: "flex",
                          alignItems: "center",
                          gap: 1,
                          color: "#98FB98",
                          fontWeight: "bold",
                          marginBottom: 3,
                        }}
                      >
                        <span className="material-icons">link</span>
                        Quick Links
                      </Typography>
                      <Box
                        sx={{
                          display: "flex",
                          flexDirection: "column",
                          gap: 1,
                        }}
                      >
                        {[
                          "Admissions",
                          "Academic Calendar",
                          "Facilities",
                          "Staff Directory",
                        ].map((link, linkindex) => (
                          <Typography
                            key={linkindex}
                            variant="body2"
                            sx={{
                              display: "flex",
                              alignItems: "center",
                              gap: 1,
                              cursor: "pointer",
                              transition: "all 0.3s ease",
                              "&:hover": {
                                paddingLeft: "10px",
                                color: "#98FB98",
                              },
                            }}
                          >
                            <span
                              className="material-icons"
                              style={{ fontSize: "8px" }}
                            >
                              circle
                            </span>
                            {link}
                          </Typography>
                        ))}
                      </Box>
                    </Grid>

                    <Grid item xs={12} md={4}>
                      <Typography
                        variant="h6"
                        gutterBottom
                        sx={{
                          display: "flex",
                          alignItems: "center",
                          gap: 1,
                          color: "#FF69B4",
                          fontWeight: "bold",
                          marginBottom: 3,
                        }}
                      >
                        <span className="material-icons">share</span>
                        Follow Us
                      </Typography>
                      <Box
                        sx={{
                          display: "flex",
                          gap: 2,
                          mb: 2,
                          flexWrap: "wrap",
                        }}
                      >
                        {[
                          {
                            icon: "facebook",
                            name: "Facebook",
                            link: "https://facebook.com",
                          },
                          {
                            icon: "spatial_tracking",
                            name: "X (Twitter)",
                            link: "https://twitter.com",
                          },
                          {
                            icon: "photo_camera",
                            name: "Instagram",
                            link: "https://instagram.com",
                          },
                          {
                            icon: "play_circle",
                            name: "YouTube",
                            link: "https://youtube.com",
                          },
                          {
                            icon: "work",
                            name: "LinkedIn",
                            link: "https://linkedin.com",
                          },
                        ].map((social, socialindex) => (
                          <Button
                            key={socialindex}
                            href={social.link}
                            target="_blank"
                            startIcon={
                              <span className="material-icons">
                                {social.icon}
                              </span>
                            }
                            sx={{
                              color: "white",
                              border: { xs: "", sm: "2px solid white" },
                              borderRadius: { xs: "50%", sm: "20px" },
                              px: 2,
                              py: 0,
                              "&:hover": {
                                backgroundColor: "white",
                                color: "primary.main",
                              },
                            }}
                          >
                            <Box sx={{ display: { xs: "none", sm: "block" } }}>
                              {social.name}
                            </Box>
                          </Button>
                        ))}
                      </Box>
                      <Typography variant="body2" sx={{ mt: 2 }}>
                        Stay connected with us on social media for the latest
                        updates and news.
                      </Typography>
                    </Grid>

                    <Grid item xs={12}>
                      <Box
                        sx={{
                          borderTop: "1px solid rgba(255,255,255,0.1)",
                          pt: 2,
                          mt: 2,
                          textAlign: "center",
                        }}
                      >
                        <Typography variant="body2">
                           2025 All rights reserved.
                        </Typography>
                      </Box>
                    </Grid>
                  </Grid>
                </Container>
              </Box>
            </div>
          );
        };

        function handleClick(view) {
          setBodyarea((pre) => view);
          event.preventDefault();
          console.info("You clicked a breadcrumb.");
        }
        const breadcrumbs = [
          <Link
            underline="hover"
            key="1"
            color="inherit"
            href="/"
            onClick={() => handleClick("Dashboard")}
          >
            Home
          </Link>,
          <Link
            underline="hover"
            key="2"
            color="inherit"
            // href="/material-ui/getting-started/installation/"
            onClick={() => {
              handleClick("Sales");
            }}
          >
            Management
          </Link>,
          <Link
            underline="hover"
            key="2"
            color="inherit"
            // href="/material-ui/getting-started/installation/"
            onClick={() => {
              handleClick("SalesReports");
            }}
          >
            Sales Report
          </Link>,
        ];
        const [customerSignUPDialogOpen, setCustomerSignUPDialogOpen] =
          useState(false);
        const [shareInterestDialogOpen, setShareInterestDialogOpen] =
          useState(false);
        const [interestForm, setInterestForm] = useState(false);
        // const [bodyarea, setBodyarea] = useState("SalesReports");
        // const [bodyarea, setBodyarea] = useState("Branches");
        const [bodyarea, setBodyarea] = useState("Dashboard");
        const [loginDialogOpen, setLoginDialogOpen] = useState(false);

        const [loginUser, setLoginUser] = useState("");
        const [isOtpMode, setIsOtpMode] = useState(false);
        const [otp, setOtp] = useState("");
        const [password, setPassword] = useState("");

        const [loginData, setLoginData] = useState(null);
        const [newCustomer, setNewCustomer] = useState(null);

        const [user, setUser] = useState({
          fullName: "",
          gender: "",
          father: "",
          email: "",
          phone: "",
          profession: "",
          branch: "",
          role: "",
          address: "",
          pincode: "",
        });

        const [errors, setErrors] = useState({});

        const validateField = (name, value) => {
          const newErrors = { ...errors };

          switch (name) {
            case "userId":
              if (!value) newErrors.userId = "user ID is required.";
              else delete newErrors.userId;
              break;
            // case "surname":
            //   if (!value) newErrors.surname = "Surname is required.";
            //   else delete newErrors.surname;
            //   break;
            case "fullName":
              if (!value) newErrors.fullName = "Name is required.";
              else delete newErrors.fullName;
              break;
            case "email":
              if (!value) {
                newErrors.email = "Email is required.";
              } else if (!/\S+@\S+\.\S+/.test(value)) {
                newErrors.email = "Email is invalid.";
              } else {
                delete newErrors.email;
              }
              break;
            // case "phone":
            //   if (!value) {
            //     newErrors.phone = "Phone number is required.";
            //   } else if (!/^\d{10}$/.test(value)) {
            //     newErrors.phone = "Phone number must be 10 digits.";
            //   } else {
            //     delete newErrors.phone;
            //   }
            //   break;
            // case "address":
            //   if (!value) newErrors.address = "Address is required.";
            //   else delete newErrors.address;
            //   break;
            //   case "profession":
            //     if (!value) newErrors.profession = "Profession is required.";
            //     else delete newErrors.profession;
            //     break;
            // case "father":
            //   if (!value) newErrors.father = "Gardian name is required.";
            //   else delete newErrors.father;
            //   break;
            // case "profession":
            //   if (!value)
            //     newErrors.profession = "profession's name is required.";
            //   else delete newErrors.profession;
            //   break;
            // case "role":
            //   if (!value) newErrors.role = "Batch Year is required.";
            //   else if (!/^\d{4}$/.test(value)) {
            //     newErrors.role = "Batch Year must be a 4-digit year.";
            //   } else {
            //     delete newErrors.role;
            //   }
            //   break;
            default:
              break;
          }

          setErrors(newErrors);
        };

        const handleChange = (event) => {
          const { name, value } = event.target;
          setUser({
            ...user,
            [name]: value,
          });

          validateField(name, value); // validate each field on change
        };

        const NewCustomerhandleSubmit = (event) => {
          event.preventDefault();
          console.log("user", user);
          console.log("errors", errors);
          try {
            if (
              Object.keys(errors).length === 0
              // &&
              // Object.values(user).every((val) => val !== "")
            ) {
              console.log("users", users);

              const newCustomer = {
                ...user,
                role: "customer",

                theme: "",
                active: true,
                joinDate: new Date(),
                branchCode: "GNB01",
              };
              console.log("newCustomer", newCustomer);
              customers.push(newCustomer);

              // axios
              //   .post(`${baseURL}/new-enroll`, user)

              //   .then((res) => {
              //     alert(res.data.message);
              //     if (res.data.message != "Same details enrolled") {
              //       setShowList(true);
              //       fetchListDate();
              //     }
              //   })
              //   .catch((error) => {
              //     // setShowList(true);
              //     // setShowList(false);
              //     // alert("catch", error);
              //     alert(error.message);
              //     console.log("Error occurred:", error);
              //   });

              // setShowList(true);

              localStorage.setItem(
                "gnUserObj",
                JSON.stringify({
                  ...newCustomer,
                })
              );
              setLoginData(newCustomer);

              window.location.reload();
            } else {
              alert("some fileds missing");
            }
          } catch (err) {
            console.log("err", err);
          }
          // Final validation before submission
        };

        const [open, setOpen] = useState(false); // profle popup
        const [dialogOpen, setDialogOpen] = useState(false);
        const [notificationsOpen, setNotificationsOpen] = useState(false);
        const [settingsOpen, setSettingsOpen] = useState(false);
        const [theme, setTheme] = useState(themes.orange);
        const [filteredMenuItems, setFilteredMenuItems] = useState([]);

        const notifications = [
          {
            title: "Notification",
            details: "This is the first notification",
            icon: "info",
            severity: "info",
          },
          {
            title: "Notification",
            details: "This is the second notification",
            icon: "warning",
            severity: "warning",
          },
          {
            title: "Notification",
            details: "This is the third notification",
            icon: "error",
            severity: "error",
          },
        ];

        const handleDrawerToggle = () => {
          setOpen(!open);
        };

        const handleDialogToggle = () => {
          setDialogOpen(!dialogOpen);
        };

        const handleNotificationsToggle = () => {
          setNotificationsOpen(!notificationsOpen);
        };

        const handleSettingsToggle = () => {
          setSettingsOpen(!settingsOpen);
        };

        const handleLoginDialogToggle = () => {
          setLoginDialogOpen(!loginDialogOpen);
        };
        const handleClickDashboardMenu = () => {
          setBodyarea("Dashboard");
          setOpen(false);
        };
        const handleClickSalesMenu = () => {
          setBodyarea("Sales");
          setOpen(false);
        };
        const handleClickCustomersMenu = () => {
          setBodyarea("Customers");
          setOpen(false);
        };

        const handleLoginSubmit = () => {
          console.log("Login submitted");
          console.log("loginUser", loginUser, password, otp);

          axios
            .post(`${baseURL}/gn-login`, {
              user: loginUser,
              passcode: password,
              otp: "",
              passcodetype: "password",
            })

            .then((res) => {
              // alert(res.data.message);
              if (res.data.success) {
                localStorage.setItem(
                  "gnUserObj",
                  JSON.stringify({
                    ...res.data.data,
                  })
                );
                localStorage.setItem("goldnoontoken", res.data.goldnoontoken);

                setLoginData(res.data.data);
                handleLoginDialogToggle();
                window.location.reload();
                setLoginUser("");
                setPassword("");
                setOtp("");
              } else {
                // alert("User not found");
              }
            })
            .catch((error) => {
              alert(error.message);
              console.log("Error occurred:", error);
            });

          // let loginUserObj = null;
          // loginUserObj =
          //   users.find(
          //     (user) =>
          //       user.mobile == loginUser ||
          //       user.id.toLowerCase() == loginUser.toLowerCase() ||
          //       user.email.toLowerCase() == loginUser.toLowerCase()
          //   ) ?? null;
          // console.log("loginUser1", loginUserObj);
          // if (!loginUserObj) {
          //   loginUserObj =
          //     customers.find(
          //       (user) =>
          //         user.mobile == loginUser ||
          //         user.id.toLowerCase() == loginUser.toLowerCase() ||
          //         user.email.toLowerCase() == loginUser.toLowerCase()
          //     ) ?? null;
          //   console.log("loginUser2", loginUserObj);
          // }
          // if (loginUserObj) {
          //   localStorage.setItem(
          //     "gnUserObj",
          //     JSON.stringify({
          //       ...loginUserObj,
          //     })
          //   );

          //   setLoginData(loginUserObj);
          //   handleLoginDialogToggle();
          //   window.location.reload();
          //   setLoginUser("");
          //   setPassword("");
          //   setOtp("");
          // } else {
          //   alert("User not found");
          // }
        };

        const logout = () => {
          if (window.confirm("Are you sure you want to log out?")) {
            // Add your logout logic here (e.g., clear user session, redirect, etc.)
            console.log("User logged out");
            setLoginData(null);
            window.location.reload();

            localStorage.removeItem("gnUserObj");
          }
        };

        const menuItems = [
          {
            text: "Dashboard",
            icon: "home",
            list: ["all"],
            role: "all",
            path: "/dashboard",
            clickfunc: handleClickDashboardMenu,
          },
          // { text: "My Page", icon: "article", role: "all,sales ", path: "/my-page" },
          {
            text: "admins",
            icon: "people",
            list: ["admins"],
            role: "admin",
            path: "/",
          },
          {
            text: "Sales Members",
            icon: "people",
            role: "admin",
            list: ["admin"],

            path: "/",
            clickfunc: handleClickSalesMenu,
          },
          {
            text: "Sales board",
            icon: "people",
            role: "admin",
            list: ["admin", "manager", "sales"],

            path: "/",
            clickfunc: () => {
              setBodyarea("SalesBoard");
              setOpen(false);
            },
          },

          {
            text: "Sales Reports",
            icon: "article",
            role: "sales",
            list: ["sales", "manager"],

            path: "/",
            clickfunc: () => {
              setBodyarea("SalesReports");
              setOpen(false);
            },
          },

          {
            text: "All Customers",
            icon: "people",
            role: "admin",
            list: ["admin", "sales"],

            path: "/",
            clickfunc: handleClickCustomersMenu,
          },

          // { text: "Sales Targets", icon: "article", role: "sales", path: "/" },
          {
            text: "Apply Loan",
            icon: "article",
            role: "customer",
            list: ["customer"],

            path: "/",
            clickfunc: () => {
              setBodyarea("ApplyLoan");
              setOpen(false);
            },
          },
          {
            text: "All loans",
            icon: "article",
            role: "customer",
            list: ["admin", "sales", "manager"],
            path: "/",
            clickfunc: () => {
              setBodyarea("AllLoans");
              setOpen(false);
            },
          },
          {
            text: "Branches",
            icon: "article",
            role: "admin",
            list: ["admin", "manager"],
            path: "/",
            clickfunc: () => {
              setBodyarea("Branches");
              setOpen(false);
            },
          },

          {
            text: "Reffer A Friend",
            icon: "people",
            role: "all",
            list: ["all"],

            path: "/",
            clickfunc: () => {
              alert("This feature Under Developemet");
            },
          },
          {
            text: "Company Reviews",
            icon: "message",
            list: ["all"],

            role: "all",
            badge: 4,
            path: "/reviews",
          },
          {
            text: "About Us",
            icon: "message",
            role: "all",
            list: ["all"],

            path: "/about",
            clickfunc: handleClickDashboardMenu,
          },
          {
            text: "Contact Us",
            icon: "people",
            role: "all",
            list: ["all"],

            path: "/contact",
            clickfunc: handleClickDashboardMenu,
          },
          {
            text: "Terms & Conditions",
            icon: "video_library",
            role: "all",
            list: ["all"],

            path: "/terms",
            clickfunc: handleClickDashboardMenu,
          },

          // {
          //   text: "Profile",
          //   icon: "people",
          //   role: "all",
          //   list: ["all"],

          //   path: "/profile",
          //   clickfunc: handleDialogToggle,
          // },
          {
            text: "Settings",
            icon: "settings",
            role: "all",
            list: ["all"],

            path: "/settings",

            clickfunc: handleSettingsToggle,
          },
          {
            text: "New Customer",
            icon: "logout",
            role: "customer",
            list: ["customer"],

            path: "/",
            clickfunc: () => setCustomerSignUPDialogOpen(true),
          },

          {
            text: "Become a Partner",
            icon: "logout",
            role: "all",
            path: "/",
            list: ["all"],

            clickfunc: () => {
              // alert("in Progress to fill form");
              setShareInterestDialogOpen(true);
            },
          },

          // {
          //   text: loginData?.name ? "Logout" : "Login",
          //   icon: "logout",
          //   role: "all",
          //   path: "/",
          //   clickfunc: loginData ? logout : handleLoginDialogToggle,
          // },
        ];

        useEffect(() => {
          const storedData = JSON.parse(localStorage.getItem("gnUserObj"));
          console.log("storedData", storedData);
          if (storedData) {
            setLoginData(storedData);
            setFilteredMenuItems((pre) =>
              menuItems.filter(
                (item) =>
                  // item.role.toLowerCase() === "all" ||
                  // item.role.toLowerCase() === storedData.role.toLowerCase()
                  item.list.includes("all") ||
                  item.list.includes(storedData.role.toLowerCase())
              )
            );
          } else {
            setLoginData(null);
            setFilteredMenuItems((pre) =>
              menuItems.filter((item) => item.role === "all")
            );
          }
          document.body.style.color = theme.textColor;
          document.body.className = theme.name.toLowerCase();
        }, [theme]);

        return (
          <Box sx={{ display: "flex" }}>
            {console.log("loginData", loginData)}
            <AppBar
              position="fixed"
              sx={{
                zIndex: (theme) => theme.zIndex.drawer + 1,
                backgroundColor: theme.appBarColor,
              }}
            >
              <Toolbar>
                <IconButton
                  edge="start"
                  color="inherit"
                  aria-label="menu"
                  onClick={handleDrawerToggle}
                >
                  <span className="material-icons">menu</span>
                </IconButton>
                <Typography
                  variant="h6"
                  noWrap
                  component="div"
                  onClick={() => {
                    setBodyarea("Dashboard");
                  }}
                >
                  Goldnoon
                  <span style={{ fontSize: "8px" }}>
                    {" "}
                    {loginData?.role ? `(${loginData?.role})` : ``}
                  </span>
                </Typography>
                <Box
                  sx={{
                    marginLeft: "auto",
                    display: "flex",
                    alignItems: "center",
                  }}
                >
                  {loginData ? (
                    <Box
                      sx={{
                        marginLeft: "auto",
                        display: "flex",
                        alignItems: "center",
                      }}
                    >
                      <Box
                        sx={{
                          position: "relative",
                          display: "inline-flex",
                          alignItems: "center",
                        }}
                      >
                        <IconButton
                          color="inherit"
                          onClick={handleNotificationsToggle}
                        >
                          <span className="material-icons">notifications</span>
                          <Box
                            sx={{
                              backgroundColor: "orange",
                              borderRadius: "50%",
                              padding: "1px 4px",
                              position: "absolute",
                              top: 0,
                              right: 0,
                              fontSize: "0.75rem",
                            }}
                          >
                            3
                          </Box>
                        </IconButton>
                      </Box>
                      <div onClick={handleDialogToggle}>
                        <Tooltip title="User Name" arrow>
                          <Avatar
                            alt="User Name"
                            src="../files/doctor.png"
                            sx={{ width: 40, height: 40, marginLeft: 1 }}
                          />
                        </Tooltip>
                        <Box
                          sx={{
                            position: "absolute",
                            bottom: 8,
                            right: 18,
                            width: 12,
                            height: 12,
                            borderRadius: "50%",
                            backgroundColor: "green",
                            border: "2px solid white",
                          }}
                        />
                      </div>
                    </Box>
                  ) : (
                    <Button
                      variant="contained"
                      color="secondary"
                      startIcon={<span className="material-icons">login</span>}
                      sx={{
                        ml: 1,
                        borderRadius: "20px",
                        textTransform: "none",
                        backgroundColor: "white",
                        color: theme.appBarColor,
                        "&:hover": {
                          backgroundColor: "rgba(255, 255, 255, 0.9)",
                          transform: "scale(1.02)",
                        },
                        transition: "all 0.2s ease-in-out",
                      }}
                      onClick={() => {
                        // Add your login logic here
                        console.log("Login clicked");
                        handleLoginDialogToggle();
                      }}
                    >
                      Login
                    </Button>
                  )}
                </Box>
              </Toolbar>
            </AppBar>

            <Drawer
              variant="temporary"
              open={open}
              onClose={handleDrawerToggle}
              sx={{
                width: 250,
                flexShrink: 0,
                [`& .MuiDrawer-paper`]: { width: 250, boxSizing: "border-box" },
              }}
            >
              <Toolbar />
              <Box sx={{ overflow: "auto" }}>
                <List>
                  {filteredMenuItems.map((item, index) => (
                    <ListItem
                      button
                      key={item.text}
                      onClick={() => (item.clickfunc ? item.clickfunc() : null)}
                    >
                      <ListItemIcon>
                        <span
                          className="material-icons"
                          // style={{ color: "#3f51b5" }}
                          style={{ color: theme.drawerColor }}
                        >
                          {item.icon}
                        </span>
                      </ListItemIcon>
                      <ListItemText
                        primary={item.text}
                        sx={{
                          fontSize: item.fontSize || "inherit",
                          color: theme.drawerColor,
                        }}
                      />
                      {item.badge && (
                        <Box
                          sx={{
                            backgroundColor: "yellow",
                            borderRadius: "50%",
                            padding: "2px 6px",
                            marginLeft: "auto",
                          }}
                        >
                          {item.badge}
                        </Box>
                      )}
                    </ListItem>
                  ))}
                </List>
              </Box>
            </Drawer>
            <Box
              component="main"
              sx={{ flexGrow: 1, p: 0.5, m: 0, width: "100%" }}
            >
              <Toolbar />
              {/*<Stack spacing={2}>
                         <Breadcrumbs
                           // separator={<NavigateNextIcon fontSize="small" />}
                           separator=""
                           aria-label="breadcrumb"
                         >
                           {breadcrumbs}
                         </Breadcrumbs>
                       </Stack>
                       <hr />*/}
              {bodyarea == "SalesReports" && <SalesReports />}
              {bodyarea == "SalesBoard" && <Leaderboard />}
              {bodyarea == "AllLoans" && <AllLoans />}
              {bodyarea == "ApplyLoan" && <ApplyLoan />}
              {bodyarea == "Branches" && <Branches />}
              {bodyarea == "Dashboard" && <Dashboard />}

              {bodyarea == "AllCustomers" && <Management2 />}
              {bodyarea == "Customers" && <Management2 />}
              {bodyarea == "Sales" && <Management />}
            </Box>
            <Dialog // profile dialog
              open={dialogOpen}
              onClose={handleDialogToggle}
              // sx={{ backgroundColor: theme.appBarColor }}
              fullWidth
            >
              <DialogTitle>User Details</DialogTitle>
              <DialogContent>
                <Box
                  sx={{
                    display: "flex",
                    alignItems: "center",
                    justifyContent: "center",
                    flexDirection: "column",
                    padding: "16px",
                    // backgroundColor: "#3f51b5",
                    backgroundColor: theme.appBarColor,
                    color: "#fff",
                    borderRadius: "8px",
                    boxShadow: 3,
                  }}
                >
                  <Avatar
                    alt="Gene A. Stepp"
                    src="../files/doctor.png"
                    sx={{
                      p: 1,
                      width: 56,
                      height: 56,
                      border: "2px dashed #fff",
                    }}
                  />
                  <Typography variant="h6" sx={{ mt: 2 }}>
                    {loginData?.fullName ?? ""}
                  </Typography>
                  <Typography variant="body2">
                    Role : {loginData?.role ?? ""}
                  </Typography>
                  <Typography variant="body2">
                    Id : {loginData?.userId ?? ""}
                  </Typography>
                  <Typography variant="body2">
                    mobile : {loginData?.mobile ?? ""}
                  </Typography>
                  <Typography variant="body2">
                    {loginData?.email ?? ""}
                  </Typography>
                </Box>
              </DialogContent>
              <DialogActions>
                <Box
                  sx={{
                    display: "flex",
                    justifyContent: "center",
                    width: "100%",
                    gap: 1,
                  }}
                >
                  <Button
                    variant="outlined"
                    onClick={() => {
                      handleDialogToggle();
                      logout();
                    }}
                    sx={{
                      color: theme.appBarColor,
                      borderColor: theme.appBarColor,
                      "&:hover": {
                        borderColor: theme.appBarColor,
                        backgroundColor: `${theme.appBarColor}10`,
                      },
                    }}
                  >
                    Log out
                  </Button>
                  <Button
                    variant="contained"
                    onClick={handleDialogToggle}
                    sx={{
                      backgroundColor: theme.appBarColor,
                      "&:hover": {
                        backgroundColor: theme.appBarColor,
                        opacity: 0.9,
                      },
                    }}
                  >
                    Close
                  </Button>
                </Box>
              </DialogActions>
            </Dialog>

            <Dialog // notification dialog
              open={notificationsOpen}
              onClose={handleNotificationsToggle}
              fullWidth
            >
              <DialogTitle>Recent Notifications</DialogTitle>
              <DialogContent>
                <List>
                  {notifications.map((notification, index) => (
                    <ListItem
                      key={index}
                      sx={{
                        display: "flex",
                        alignItems: "center",
                        gap: 1,
                        backgroundColor: "#f5f5f5",
                        borderRadius: "5px",
                        mb: 1,
                        p: 2,
                        "&:hover": {
                          backgroundColor: "#e0e0e0",
                        },
                      }}
                    >
                      <Avatar
                        sx={{
                          bgcolor:
                            notification.severity === "error"
                              ? "#f44336"
                              : notification.severity === "warning"
                              ? "#ff9800"
                              : "#2196f3",
                          width: 32,
                          height: 32,
                        }}
                      >
                        <span
                          className="material-icons"
                          style={{ fontSize: "16px" }}
                        >
                          {notification.icon}
                        </span>
                      </Avatar>
                      <Box sx={{ flexGrow: 1 }}>
                        <Typography
                          variant="subtitle1"
                          sx={{ fontWeight: "bold" }}
                        >
                          {notification.title}
                        </Typography>
                        <Typography variant="body2" color="text.secondary">
                          {notification.details}
                        </Typography>
                      </Box>
                      <IconButton
                        size="small"
                        onClick={() => {
                          console.log("Clicked notification Close icon");
                          /* Dismiss logic here */
                        }}
                        sx={{
                          "&:hover": {
                            backgroundColor: "rgba(0, 0, 0, 0.04)",
                          },
                        }}
                      >
                        <span className="material-icons">close</span>
                      </IconButton>
                    </ListItem>
                  ))}
                </List>
              </DialogContent>
              <DialogActions>
                <Button
                  onClick={handleNotificationsToggle}
                  sx={{
                    color: theme.appBarColor,
                    "&:hover": {
                      backgroundColor: `${theme.appBarColor}10`,
                    },
                  }}
                >
                  Close
                </Button>
              </DialogActions>
            </Dialog>

            <Dialog // settings dialog
              open={settingsOpen}
              onClose={handleSettingsToggle}
              fullWidth
            >
              <DialogTitle
                sx={{ fontSize: { xs: "1rem", sm: "1.25rem", md: "1.5rem" } }}
              >
                Choose Theme & Language
              </DialogTitle>
              <DialogContent>
                <Box
                  sx={{
                    display: "flex",
                    flexDirection: "column",
                    gap: 2,
                    pt: 1,
                  }}
                >
                  <FormControl>
                    <InputLabel id="theme-select-label">Theme</InputLabel>
                    <Select
                      label="Theme"
                      labelId="theme-select-label"
                      value={theme.name}
                      onChange={(e) => setTheme(themes[e.target.value])}
                    >
                      {Object.keys(themes).map((key) => (
                        <MenuItem key={key} value={key}>
                          {themes[key].name}
                        </MenuItem>
                      ))}
                    </Select>
                  </FormControl>
                  <FormControl>
                    <InputLabel id="language-select-label">Language</InputLabel>
                    <Select
                      labelId="language-select-label"
                      defaultValue=""
                      label="Language"
                    >
                      <MenuItem value="en">English</MenuItem>
                      <MenuItem value="es">Spanish</MenuItem>
                      <MenuItem value="fr">French</MenuItem>
                    </Select>
                  </FormControl>
                </Box>
              </DialogContent>
              <DialogActions>
                <Button
                  onClick={handleSettingsToggle}
                  sx={{
                    color: theme.appBarColor,
                    "&:hover": {
                      backgroundColor: `${theme.appBarColor}10`,
                    },
                  }}
                >
                  Close
                </Button>
              </DialogActions>
            </Dialog>

            <Dialog // login dashboard
              open={loginDialogOpen}
              onClose={handleLoginDialogToggle}
              fullWidth
            >
              <DialogTitle>
                <div
                  style={{
                    display: "flex",
                    alignItems: "center",
                    justifyContent: "space-between",
                    width: "100%",
                  }}
                >
                  <Typography>Login</Typography>
                  <Button
                    variant="contained"
                    size="small"
                    onClick={() => {
                      console.log("Open a popup for new customer sign up");
                      handleLoginDialogToggle();
                      setCustomerSignUPDialogOpen(true);
                    }}
                    sx={{
                      color: theme.appBarColor,
                      "&:hover": {
                        backgroundColor: `${theme.appBarColor}10`,
                      },
                    }}
                  >
                    New Customer
                  </Button>
                </div>
              </DialogTitle>
              <DialogContent>
                <Box
                  sx={{
                    display: "flex",
                    flexDirection: "column",
                    gap: 2,
                    // pt: 2,
                  }}
                >
                  <TextField
                    // label="User "
                    placeholder="Enter ID or email or Mobile number"
                    type="text" // once entered it will check for validation
                    fullWidth
                    variant="outlined"
                    // autoFocus

                    // margin="dense"
                    value={loginUser}
                    onChange={(e) => setLoginUser(e.target.value)}
                    // error={!loginUser && loginSubmitted}
                    // helperText={
                    //   !loginUser && loginSubmitted ? "user is required" : ""
                    // }
                  />

                  <FormControl component="fieldset">
                    <Typography variant="body2" sx={{ mb: 1 }}>
                      Authentication Method
                    </Typography>
                    <Box sx={{ display: "flex", gap: 2 }}>
                      <Box
                        onClick={() => setIsOtpMode(false)}
                        sx={{
                          display: "flex",
                          alignItems: "center",
                          gap: 1,
                          // padding: "8px 16px",
                          // border: "1px solid #ccc",
                          // borderRadius: "4px",
                          cursor: "pointer",
                          backgroundColor: !isOtpMode
                            ? "#e3f2fd"
                            : "transparent",
                          borderColor: !isOtpMode ? "#2196f3" : "#ccc",
                        }}
                      >
                        <span
                          className="material-icons"
                          style={{ color: !isOtpMode ? "#2196f3" : "inherit" }}
                        >
                          {!isOtpMode
                            ? "radio_button_checked"
                            : "radio_button_unchecked"}
                        </span>
                        <Typography>Password</Typography>
                      </Box>
                      <Box
                        onClick={() => setIsOtpMode(true)}
                        sx={{
                          display: "flex",
                          alignItems: "center",
                          gap: 1,
                          // padding: "8px 16px",
                          // border: "1px solid #ccc",
                          // borderRadius: "4px",
                          cursor: "pointer",
                          backgroundColor: isOtpMode
                            ? "#e3f2fd"
                            : "transparent",
                          borderColor: isOtpMode ? "#2196f3" : "#ccc",
                        }}
                      >
                        <span
                          className="material-icons"
                          style={{ color: isOtpMode ? "#2196f3" : "inherit" }}
                        >
                          {isOtpMode
                            ? "radio_button_checked"
                            : "radio_button_unchecked"}
                        </span>
                        <Typography>OTP</Typography>
                      </Box>
                    </Box>
                  </FormControl>

                  {!isOtpMode ? (
                    <TextField
                      label="Password"
                      type="password"
                      fullWidth
                      variant="outlined"
                      value={password}
                      onChange={(e) => setPassword(e.target.value)}
                    />
                  ) : (
                    <TextField
                      label="OTP"
                      type="number"
                      fullWidth
                      variant="outlined"
                      value={otp}
                      onChange={(e) => setOtp(e.target.value)}
                    />
                  )}

                  {/*<Button sx={{ alignSelf: "flex-start" }} color="primary">
                                   Forgot Password?
                                 </Button>*/}
                </Box>
              </DialogContent>
              <DialogActions>
                <Button
                  onClick={handleLoginDialogToggle}
                  sx={{
                    color: theme.appBarColor,
                    "&:hover": {
                      backgroundColor: `${theme.appBarColor}10`,
                    },
                  }}
                >
                  Cancel
                </Button>
                <Button
                  variant="contained"
                  onClick={handleLoginSubmit}
                  sx={{
                    backgroundColor: theme.appBarColor,
                    "&:hover": {
                      backgroundColor: theme.appBarColor,
                      opacity: 0.9,
                    },
                  }}
                >
                  Login
                </Button>
              </DialogActions>
            </Dialog>
            {/* Sign In Dialog */}
            <Dialog
              open={customerSignUPDialogOpen}
              onClose={() => setCustomerSignUPDialogOpen(false)}
              fullWidth
            >
              {/*<DialogTitle>New Customer</DialogTitle>*/}
              {/*<DialogContent>
                               <Box
                                 sx={{
                                   display: "flex",
                                   flexDirection: "column",
                                   gap: 2,
                                 }}
                               >
                                 <TextField
                                   label="Full Name"
                                   variant="outlined"
                                   fullWidth
                                   // value={newCustomerName}
                                   // onChange={(e) => setNewCustomerName(e.target.value)}
                                 />
                                 <TextField
                                   label="Email"
                                   type="email"
                                   variant="outlined"
                                   fullWidth
                                   // value={newCustomerEmail}
                                   // onChange={(e) => setNewCustomerEmail(e.target.value)}
                                 />
                                 <TextField
                                   label="Mobile Number"
                                   type="tel"
                                   variant="outlined"
                                   fullWidth
                                   // value={newCustomerMobile}
                                   // onChange={(e) => setNewCustomerMobile(e.target.value)}
                                 />
                               </Box>
                             </DialogContent>
                             <DialogActions>
                               <Button onClick={() => setCustomerSignUPDialogOpen(false)}>
                                 Cancel
                               </Button>
                               <Button
                                 variant="contained"
                                 onClick={() => {
                                   console.log("first");
                                 }} // Function to handle sign-in submission
                               >
                                 New Login
                               </Button>
                             </DialogActions>*/}

              <Box
                sx={{
                  maxWidth: "500px",
                  margin: "auto",
                  padding: "20px",
                  backgroundColor: "#fff",
                  borderRadius: "8px",
                  boxShadow: 2,
                }}
              >
                <Typography variant="body" textAlign="center" mb={2}>
                  New Customer Form
                </Typography>
                <form onSubmit={NewCustomerhandleSubmit}>
                  {/* Full Name */}
                  <TextField
                    label="Full Name"
                    name="fullName"
                    value={user.fullName}
                    onChange={handleChange}
                    fullWidth
                    margin="normal"
                    error={Boolean(errors.fullName)}
                    helperText={errors.fullName}
                  />

                  {/* Care Of Person */}
                  <TextField
                    label="Care Of Person"
                    name="father"
                    value={user.father}
                    onChange={handleChange}
                    fullWidth
                    margin="normal"
                    error={Boolean(errors.father)}
                    helperText={errors.father}
                  />

                  {/* Gender Selection */}
                  <FormControl fullWidth margin="normal">
                    <InputLabel>Gender</InputLabel>
                    <Select
                      label="Gender"
                      name="gender"
                      value={user.gender}
                      onChange={handleChange}
                    >
                      <MenuItem value="Male">Male</MenuItem>
                      <MenuItem value="Female">Female</MenuItem>
                    </Select>
                  </FormControl>

                  {/* Email */}
                  <TextField
                    label="Email"
                    name="email"
                    type="email"
                    value={user.email}
                    onChange={handleChange}
                    fullWidth
                    margin="normal"
                    error={Boolean(errors.email)}
                    helperText={errors.email}
                  />

                  {/* Phone */}
                  <TextField
                    label="Phone"
                    name="phone"
                    value={user.phone}
                    onChange={handleChange}
                    fullWidth
                    margin="normal"
                    error={Boolean(errors.phone)}
                    helperText={errors.phone}
                  />
                  {/* pincode */}
                  <TextField
                    label="Address"
                    name="address"
                    value={user.address}
                    onChange={handleChange}
                    fullWidth
                    margin="normal"
                    error={Boolean(errors?.address)}
                    helperText={errors?.address}
                  />
                  {/* pincode */}
                  <TextField
                    label="Pincode"
                    name="pincode"
                    value={user.pincode}
                    onChange={handleChange}
                    fullWidth
                    margin="normal"
                    error={Boolean(errors?.pincode)}
                    helperText={errors?.pincode}
                  />
                  {/* Password */}
                  <TextField
                    label="Password"
                    name="password"
                    value={user.password}
                    onChange={handleChange}
                    fullWidth
                    margin="normal"
                    error={Boolean(errors?.password)}
                    helperText={errors?.password}
                  />
                  {/* CPassword */}
                  <TextField
                    label="Confirm Password"
                    name="cpassword"
                    value={user.cpassword}
                    onChange={handleChange}
                    fullWidth
                    margin="normal"
                    error={Boolean(errors?.cpassword)}
                    helperText={errors?.cpassword}
                  />

                  {/* Buttons */}
                  <Box
                    sx={{
                      display: "flex",
                      flexDirection: { xs: "column", sm: "row" },
                      gap: 2,
                      mt: 3,
                    }}
                  >
                    <Button
                      onClick={() => setCustomerSignUPDialogOpen(false)}
                      variant="outlined"
                      color="secondary"
                      fullWidth
                    >
                      Back
                    </Button>
                    <Button
                      onClick={() => {
                        axios
                          .post(`${baseURL}/add-new-gn-user`, {
                            fullName: user.fullName,
                            userId: "GNC" + user.phone,
                            role: "customer",
                            mobile: user.phone,
                            email: user.email,
                            otp: "123456",
                            loginExpiration: "",
                            password: user.cpassword,
                            address: user.address,
                            roleId: 0,
                            theme: "",
                            active: true,
                            joinDate: "",
                            branchCode: "GNB01",
                            gender: user.gender,
                            careOf: user.father,
                          })

                          .then((res) => {
                            alert(res.data.message);
                            if (res.data.success) {
                              localStorage.setItem(
                                "gnUserObj",
                                JSON.stringify({
                                  ...res.data.data,
                                })
                              );

                              setLoginData(res.data.data);
                              handleLoginDialogToggle();
                              window.location.reload();
                              setLoginUser("");
                              setPassword("");
                              setOtp("");
                            } else {
                              // alert("User not found");
                            }
                          })
                          .catch((error) => {
                            alert(error.message);
                            console.log("Error occurred:", error);
                          });
                      }}
                      type="submit"
                      variant="contained"
                      color="primary"
                      fullWidth
                    >
                      Login
                    </Button>
                  </Box>
                </form>
              </Box>
            </Dialog>

            {/* Share Interest Dialog */}
            <Dialog
              open={shareInterestDialogOpen}
              onClose={() => setShareInterestDialogOpen(false)}
              fullWidth
            >
              <DialogTitle>Share Your Interest</DialogTitle>
              <DialogContent>
                <Box
                  sx={{
                    display: "flex",
                    flexDirection: "column",
                    gap: 2,
                  }}
                >
                  <TextField
                    label="Name"
                    variant="outlined"
                    fullWidth
                    value={interestForm.name}
                    onChange={(e) =>
                      setInterestForm({ ...interestForm, name: e.target.value })
                    }
                  />
                  <TextField
                    label="Email"
                    type="email"
                    variant="outlined"
                    fullWidth
                    value={interestForm.email}
                    onChange={(e) =>
                      setInterestForm({
                        ...interestForm,
                        email: e.target.value,
                      })
                    }
                  />
                  <TextField
                    label="Mobile"
                    type="tel"
                    variant="outlined"
                    fullWidth
                    value={interestForm.mobile}
                    onChange={(e) =>
                      setInterestForm({
                        ...interestForm,
                        mobile: e.target.value,
                      })
                    }
                  />
                  <TextField
                    label="Address"
                    variant="outlined"
                    fullWidth
                    value={interestForm.address}
                    onChange={(e) =>
                      setInterestForm({
                        ...interestForm,
                        address: e.target.value,
                      })
                    }
                  />
                  <TextField
                    label="Note"
                    variant="outlined"
                    fullWidth
                    multiline
                    rows={4}
                    value={interestForm.note}
                    onChange={(e) =>
                      setInterestForm({ ...interestForm, note: e.target.value })
                    }
                  />
                </Box>
              </DialogContent>
              <DialogActions>
                <Button onClick={() => setShareInterestDialogOpen(false)}>
                  Cancel
                </Button>
                <Button
                  onClick={() => {
                    // Handle form submission logic here
                    console.log("Interest Form Submitted:", interestForm);
                    setShareInterestDialogOpen(false);
                  }}
                  variant="contained"
                  color="primary"
                >
                  Submit
                </Button>
              </DialogActions>
            </Dialog>
          </Box>
        );
      };

      // Render the form to the  DOM
      ReactDOM.render(<HomePage />, document.getElementById("root"));
    </script>
  </body>
</html